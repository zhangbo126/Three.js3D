"use strict";(self["webpackChunkprodect"]=self["webpackChunkprodect"]||[]).push([[213],{8213:function(e,t,i){i.r(t),i.d(t,{default:function(){return qn}});i(7658);var o=i(3396),n=i(4870),l=i(7139),a=i(9242),s=i(65),r=i(872),d=i(1794);const p=e=>((0,o.dD)("data-v-03dc8261"),e=e(),(0,o.Cn)(),e),u={class:"edit-box"},c={class:"header"},m=p((()=>(0,o._)("span",null,"背景",-1))),h={class:"icon-name"},g=p((()=>(0,o._)("span",null," 图片",-1))),_={class:"action-txt"},f={class:"check"},v={class:"icon-name"},w=p((()=>(0,o._)("span",null," 颜色",-1))),y={class:"action"},b={class:"check"},C={class:"icon-name"},L=p((()=>(0,o._)("span",null," 全景图",-1))),k={class:"action-txt"},W={class:"check"};var M={__name:"EditBackground",setup(e,{expose:t}){const p=(0,s.oR)(),M=(0,n.qj)({visible:!0,type:3,image:i(3405),viewImg:i(72),color:"#000"}),x=(0,n.iH)(3),S=(0,n.iH)(3),A=(0,n.qj)({modelApi:(0,o.Fl)((()=>p.state.modelApi))}),V=(0,o.Fl)((()=>{const{visible:e}=M;return e?"":"disabled"})),U=r.UL,H=e=>{switch(M.type=e,e){case 1:A.modelApi.onSetSceneColor(M.color);break;case 2:A.modelApi.onSetSceneImage(M.image);break;case 3:A.modelApi.onSetSceneViewImage(M.viewImg);break;default:break}},P=({id:e,url:t})=>{M.image=t,x.value=e,A.modelApi.onSetSceneImage(t)},F=({id:e,url:t})=>{M.viewImg=t,S.value=e,A.modelApi.onSetSceneViewImage(t)},E=e=>{M.color=e,A.modelApi.onSetSceneColor(M.color)},T=()=>{A.modelApi.onSetSceneColor(M.color)},I=()=>{const{type:e,visible:t,image:i,viewImg:o}=M;if(!t)return A.modelApi.onSetSceneColor("#000");switch(e){case 1:A.modelApi.onSetSceneColor(M.color);break;case 2:A.modelApi.onSetSceneImage(i);break;case 3:A.modelApi.onSetSceneViewImage(o);break;default:break}};return t({config:M}),(e,t)=>{const i=(0,o.up)("el-switch"),s=(0,o.up)("Picture"),r=(0,o.up)("el-icon"),p=(0,o.up)("el-space"),A=(0,o.up)("el-button"),R=(0,o.up)("Check"),D=(0,o.up)("el-image"),z=(0,o.up)("el-col"),j=(0,o.up)("el-row"),O=(0,o.up)("el-scrollbar"),G=(0,o.up)("DataAnalysis"),B=(0,o.up)("el-color-picker"),N=(0,o.up)("CameraFilled");return(0,o.wg)(),(0,o.iD)("div",u,[(0,o._)("div",c,[m,(0,o.Wm)(i,{modelValue:M.visible,"onUpdate:modelValue":t[0]||(t[0]=e=>M.visible=e),onChange:I},null,8,["modelValue"])]),(0,o._)("div",{class:(0,l.C_)(["options",V.value])},[(0,o._)("div",{class:"option",onClick:t[1]||(t[1]=e=>H(2))},[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o._)("div",h,[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s)])),_:1}),g])),_:1})]),(0,o._)("div",_,[(0,o.Wm)(A,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("选择图片")])),_:1})]),(0,o.wy)((0,o._)("div",f,[(0,o.Wm)(r,{size:"20px",color:"#2a3ff6"},{default:(0,o.w5)((()=>[(0,o.Wm)(R)])),_:1})],512),[[a.F8,2==M.type]])])),_:1})]),(0,o.wy)((0,o.Wm)(O,{"max-height":"250px"},{default:(0,o.w5)((()=>[(0,o.Wm)(j,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,n.SU)(d.L8),(e=>((0,o.wg)(),(0,o.j4)(z,{style:{textAlign:"center"},span:6,key:e.id},{default:(0,o.w5)((()=>[(0,o.Wm)(D,{onClick:t=>P(e),class:(0,l.C_)(["el-img",x.value==e.id?"active":""]),src:e.url,fit:"cover"},null,8,["onClick","class","src"])])),_:2},1024)))),128))])),_:1})])),_:1},512),[[a.F8,2==M.type]])],2),(0,o._)("div",{class:(0,l.C_)(["options",V.value])},[(0,o._)("div",{class:"option",onClick:t[3]||(t[3]=e=>H(1))},[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o._)("div",v,[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(G)])),_:1}),w])),_:1})]),(0,o._)("div",y,[(0,o.Wm)(B,{predefine:(0,n.SU)(U),onChange:T,onActiveChange:E,modelValue:M.color,"onUpdate:modelValue":t[2]||(t[2]=e=>M.color=e)},null,8,["predefine","modelValue"])]),(0,o.wy)((0,o._)("div",b,[(0,o.Wm)(r,{size:"20px",color:"#2a3ff6"},{default:(0,o.w5)((()=>[(0,o.Wm)(R)])),_:1})],512),[[a.F8,1==M.type]])])),_:1})])],2),(0,o._)("div",{class:(0,l.C_)(["options",V.value])},[(0,o._)("div",{class:"option",onClick:t[4]||(t[4]=e=>H(3))},[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o._)("div",C,[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(N)])),_:1}),L])),_:1})]),(0,o._)("div",k,[(0,o.Wm)(A,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("选择图片")])),_:1})]),(0,o.wy)((0,o._)("div",W,[(0,o.Wm)(r,{size:"20px",color:"#2a3ff6"},{default:(0,o.w5)((()=>[(0,o.Wm)(R)])),_:1})],512),[[a.F8,3==M.type]])])),_:1})]),(0,o.wy)((0,o.Wm)(O,{"max-height":"350px"},{default:(0,o.w5)((()=>[(0,o.Wm)(j,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,n.SU)(d.Wf),(e=>((0,o.wg)(),(0,o.j4)(z,{span:6,style:{textAlign:"center"},key:e.id},{default:(0,o.w5)((()=>[(0,o.Wm)(D,{onClick:t=>F(e),class:(0,l.C_)(["el-view",S.value==e.id?"active":""]),src:e.url,fit:"cover"},null,8,["onClick","class","src"])])),_:2},1024)))),128))])),_:1})])),_:1},512),[[a.F8,3==M.type]])],2)])}}},x=i(89);const S=(0,x.Z)(M,[["__scopeId","data-v-03dc8261"]]);var A=S,V=i(8603),U=i(7178);const H=e=>((0,o.dD)("data-v-4f095f9a"),e=e(),(0,o.Cn)(),e),P={class:"edit-box"},F=H((()=>(0,o._)("div",{class:"header"},[(0,o._)("span",null,"材质类型")],-1))),E={class:"options"},T={class:"option"},I=H((()=>(0,o._)("span",null,"当前材质类型：",-1))),R=H((()=>(0,o._)("div",{class:"header"},[(0,o._)("span",null,"材质")],-1))),D={class:"options"},z=["onClick"],j={class:"icon-name"},O={class:"check"},G=H((()=>(0,o._)("div",{class:"header"},"材质属性",-1))),B={class:"option space-between"},N={class:"option"},q={class:"grid-txt"},Y={class:"grid-silder"},Z=H((()=>(0,o._)("div",{class:"header"},"模型自带贴图",-1))),X=["onClick"],$={key:0,class:"select"},K=H((()=>(0,o._)("div",{class:"header"},"系统贴图",-1))),Q=["onClick"],J={key:0,class:"select"};var ee={__name:"EditMaterial",setup(e,{expose:t}){const i=(0,s.oR)(),{$bus:p}=(0,o.FN)().proxy,u=(0,n.qj)({meaterialName:null,color:null,wireframe:!1,depthWrite:!0,opacity:1}),c=(0,n.iH)("MeshStandardMaterial"),m=((0,n.qj)({type:"MeshStandardMaterial",describe:"标准网格材质",color:!0,wireframe:!0,depthWrite:!0,opacity:!0}),(0,n.iH)(null)),h=(0,o.Fl)((()=>{const e=g.modelMaterialList.find((e=>e.uuid==g.selectMeshUuid))||{};return e.uuid?"":"disabled"})),g=(0,n.qj)({modelMaterialList:(0,o.Fl)((()=>i.state.modelApi.modelMaterialList)),modelApi:(0,o.Fl)((()=>i.state.modelApi)),selectMeshUuid:(0,o.Fl)((()=>i.getters.selectMeshUuid)),modelTextureMap:(0,o.Fl)((()=>i.state.modelApi.modelTextureMap))});(0,o.bv)((()=>{p.on("model-update",(()=>{Object.assign(u,{color:null,wireframe:!1,depthWrite:!0,opacity:1})}))})),(0,o.YP)((()=>i.getters.selectMeshUuid),(e=>{const t=g.modelMaterialList.find((t=>t.uuid==e))||{};if(m.value=t.mapId,t.mapId){const{color:e,wireframe:i,depthWrite:o,opacity:n}=t.material;Object.assign(u,{color:new V.Color(e).getStyle(),wireframe:i,depthWrite:o,opacity:n})}}));const _=e=>{const t=r.HG.find((t=>t.type==e));g.modelApi.onChangeModelMeshType(t)},f=({name:e,id:t,material:i,mapId:o})=>{u.meaterialName=i.name;const n=g.modelApi.onChangeModelMeaterial(e),{color:l,wireframe:a,depthWrite:s,opacity:r}=n.material;Object.assign(u,{color:new V.Color(l).getStyle(),wireframe:a,depthWrite:s,opacity:r})},v=e=>{u.color=e,g.modelApi.onSetModelMaterial(u)},w=()=>{g.modelApi.onSetModelMaterial(u)},y=e=>{e.visible=!e.visible},b=e=>{m.value=e.mapId,g.modelApi.onSetModelMap(e),Object.assign(u,{color:null,wireframe:!1,depthWrite:!0,opacity:1}),U.z8.success("当前材质贴图修改成功")},C=e=>{m.value=e.id,g.modelApi.onSetSystemModelMap(e),Object.assign(u,{color:null,wireframe:!1,depthWrite:!0,opacity:1}),U.z8.success("当前材质贴图修改成功")},L=()=>({meshList:g.modelApi.onGetEditMeshList()});return t({getMeshConfig:L}),(e,t)=>{const i=(0,o.up)("el-option"),s=(0,o.up)("el-select"),p=(0,o.up)("el-space"),L=(0,o.up)("View"),k=(0,o.up)("el-icon"),W=(0,o.up)("Hide"),M=(0,o.up)("Check"),x=(0,o.up)("el-scrollbar"),S=(0,o.up)("WarnTriangleFilled"),A=(0,o.up)("el-tooltip"),V=(0,o.up)("el-button"),U=(0,o.up)("el-color-picker"),H=(0,o.up)("el-switch"),ee=(0,o.up)("el-slider"),te=(0,o.up)("el-image"),ie=(0,o.up)("Select"),oe=(0,o.up)("el-col"),ne=(0,o.up)("el-row");return(0,o.wg)(),(0,o.iD)("div",P,[F,(0,o._)("div",E,[(0,o._)("div",T,[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[I,(0,o.Wm)(s,{modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=e=>c.value=e),onChange:_,placeholder:"请选择",size:"small"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,n.SU)(r.HG),(e=>((0,o.wg)(),(0,o.j4)(i,{key:e.type,label:`${e.type}(${e.describe})`,value:e.type},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])]),R,(0,o._)("div",D,[(0,o.Wm)(x,{"max-height":"200px"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(g.modelMaterialList,(e=>((0,o.wg)(),(0,o.iD)("div",{class:(0,l.C_)(["option",g.selectMeshUuid==e.uuid?"option-active":""]),onClick:t=>f(e),key:e.uuid},[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[e.visible?((0,o.wg)(),(0,o.j4)(k,{key:0,onClick:t=>y(e),size:"18",color:"#409eff"},{default:(0,o.w5)((()=>[(0,o.Wm)(L)])),_:2},1032,["onClick"])):((0,o.wg)(),(0,o.j4)(k,{key:1,size:"18",onClick:t=>y(e)},{default:(0,o.w5)((()=>[(0,o.Wm)(W)])),_:2},1032,["onClick"])),(0,o._)("div",j,(0,l.zw)(e.name),1),(0,o.wy)((0,o._)("div",O,[(0,o.Wm)(k,{size:"20px",color:"#2a3ff6"},{default:(0,o.w5)((()=>[(0,o.Wm)(M)])),_:1})],512),[[a.F8,g.selectMeshUuid==e.uuid]])])),_:2},1024)],10,z)))),128))])),_:1})]),G,(0,o._)("div",{class:(0,l.C_)(["options",h.value])},[(0,o._)("div",B,[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(A,{effect:"dark",content:"注意:部分模型因为原始材质特殊以及灯光等原因,修改材质颜色可能没有实际效果",placement:"top"},{default:(0,o.w5)((()=>[(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[(0,o.Wm)(S,{size:20,color:"#ffb940"})])),_:1})])),_:1}),(0,o.Wm)(V,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("材质颜色")])),_:1}),(0,o.Wm)(U,{"color-format":"hex",predefine:(0,n.SU)(r.UL),onChange:w,onActiveChange:v,modelValue:u.color,"onUpdate:modelValue":t[1]||(t[1]=e=>u.color=e)},null,8,["predefine","modelValue"])])),_:1}),(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(V,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("深度写入")])),_:1}),(0,o.Wm)(H,{onChange:w,modelValue:u.depthWrite,"onUpdate:modelValue":t[2]||(t[2]=e=>u.depthWrite=e)},null,8,["modelValue"])])),_:1}),(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(A,{effect:"dark",content:"注意:部分模型因为原始材质不支持网格,修改网格可能导致材质显示异常,或者没有实际效果",placement:"top"},{default:(0,o.w5)((()=>[(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[(0,o.Wm)(S,{size:20,color:"#ffb940"})])),_:1})])),_:1}),(0,o.Wm)(V,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("网格")])),_:1}),(0,o.Wm)(H,{onChange:w,modelValue:u.wireframe,"onUpdate:modelValue":t[3]||(t[3]=e=>u.wireframe=e)},null,8,["modelValue"])])),_:1})]),(0,o._)("div",N,[(0,o._)("div",q,[(0,o.Wm)(A,{effect:"dark",content:"注意:部分模型因为原始材质不支持透明度,修改透明度可能导致材质显示异常,或者没有实际效果",placement:"top"},{default:(0,o.w5)((()=>[(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[(0,o.Wm)(S,{size:20,color:"#ffb940"})])),_:1})])),_:1}),(0,o.Wm)(V,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("透明度 ")])),_:1})]),(0,o._)("div",Y,[(0,o.Wm)(ee,{"show-input":"",onChange:w,modelValue:u.opacity,"onUpdate:modelValue":t[4]||(t[4]=e=>u.opacity=e),min:0,max:1,step:.01},null,8,["modelValue"])])])],2),Z,(0,o._)("div",{class:(0,l.C_)(["options",h.value])},[(0,o.Wm)(x,{"max-height":"100px"},{default:(0,o.w5)((()=>[(0,o.Wm)(ne,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(g.modelTextureMap,(e=>((0,o.wg)(),(0,o.j4)(oe,{span:6,style:{textAlign:"center"},key:e.mapId},{default:(0,o.w5)((()=>[(0,o._)("div",{onClick:t=>b(e),class:(0,l.C_)(["image-box",m.value==e.mapId?"active":""])},[(0,o.Wm)(te,{src:e.url,class:"el-map",fit:"cover"},null,8,["src"]),m.value==e.mapId?((0,o.wg)(),(0,o.iD)("div",$,[(0,o.Wm)(k,{color:"#18c174",size:26},{default:(0,o.w5)((()=>[(0,o.Wm)(ie)])),_:1})])):(0,o.kq)("",!0)],10,X)])),_:2},1024)))),128))])),_:1})])),_:1})],2),K,(0,o._)("div",{class:(0,l.C_)(["options",h.value])},[(0,o.Wm)(x,{"max-height":"230px"},{default:(0,o.w5)((()=>[(0,o.Wm)(ne,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,n.SU)(d.or),(e=>((0,o.wg)(),(0,o.j4)(oe,{span:6,style:{textAlign:"center"},key:e.id},{default:(0,o.w5)((()=>[(0,o._)("div",{onClick:t=>C(e),class:(0,l.C_)(["image-box",m.value==e.id?"active":""])},[(0,o.Wm)(te,{src:e.url,class:"el-map",fit:"cover"},null,8,["src"]),m.value==e.id?((0,o.wg)(),(0,o.iD)("div",J,[(0,o.Wm)(k,{color:"#18c174",size:26},{default:(0,o.w5)((()=>[(0,o.Wm)(ie)])),_:1})])):(0,o.kq)("",!0)],10,Q)])),_:2},1024)))),128))])),_:1})])),_:1})],2)])}}};const te=(0,x.Z)(ee,[["__scopeId","data-v-4f095f9a"]]);var ie=te;const oe={class:"edit-box"},ne={class:"header"},le=(0,o._)("span",null,"模型动画",-1),ae=["onClick"],se={class:"icon-name"},re={class:"check"},de=(0,o._)("div",{class:"header"},[(0,o._)("span",null,"动画配置")],-1),pe={class:"option"},ue=(0,o._)("span",null," 循环方式 ",-1),ce={class:"option"},me={class:"option"},he=(0,o._)("span",null," 播放速度 ",-1),ge={class:"option"},_e={class:"option"},fe=(0,o._)("span",null," 动作幅度 ",-1),ve={class:"option"},we={class:"header"},ye=(0,o._)("span",null,"轴动画",-1),be={class:"options"},Ce=(0,o._)("span",null," 轴方向 ",-1),Le=(0,o._)("span",null," 播放速度 ",-1);var ke={__name:"EditAnimation",setup(e,{expose:t}){const i=(0,s.oR)(),{$bus:r}=(0,o.FN)().proxy,d=(0,n.qj)({visible:!1,animationName:null,loop:"LoopRepeat",timeScale:1,weight:1,rotationVisible:!1,rotationType:"y",rotationSpeed:1}),p=(0,o.Fl)((()=>d.visible?"":"disabled")),u=(0,o.Fl)((()=>d.rotationVisible?"":"disabled")),c=(0,n.qj)({modelApi:(0,o.Fl)((()=>i.state.modelApi)),modelAnimation:(0,o.Fl)((()=>i.state.modelApi?i.state.modelApi.modelAnimation:[]))});(0,o.bv)((()=>{c.modelAnimation.length&&(d.animationName=c.modelAnimation[0].name),r.on("model-update",(()=>{if(c.modelAnimation.length){const e=c.modelAnimation[0].name;d.animationName=e}Object.assign(d,{visible:!1,loop:"LoopRepeat",timeScale:1,weight:1,rotationVisible:!1,rotationType:"y",rotationSpeed:1})}))}));const m=()=>{const{visible:e}=d;e?g():c.modelApi.onClearAnimation()},h=({name:e})=>{d.animationName=e,c.modelApi.onStartModelAnimaion(d)},g=()=>{c.modelApi.onStartModelAnimaion(d)},_=()=>{c.modelApi.onSetRotation(d)},f=()=>{c.modelApi.onSetRotationType(d)};return t({config:d}),(e,t)=>{const i=(0,o.up)("el-switch"),n=(0,o.up)("Check"),s=(0,o.up)("el-icon"),r=(0,o.up)("el-space"),v=(0,o.up)("el-scrollbar"),w=(0,o.up)("el-empty"),y=(0,o.up)("Switch"),b=(0,o.up)("el-radio-button"),C=(0,o.up)("el-radio-group"),L=(0,o.up)("VideoPlay"),k=(0,o.up)("el-slider"),W=(0,o.up)("Sort");return(0,o.wg)(),(0,o.iD)("div",oe,[(0,o._)("div",ne,[le,(0,o.Wm)(i,{modelValue:d.visible,"onUpdate:modelValue":t[0]||(t[0]=e=>d.visible=e),onChange:m},null,8,["modelValue"])]),(0,o._)("div",{class:(0,l.C_)(["options",p.value])},[c.modelAnimation.length?((0,o.wg)(),(0,o.j4)(v,{key:0,"max-height":"250px"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(c.modelAnimation,(e=>((0,o.wg)(),(0,o.iD)("div",{class:(0,l.C_)(["option",d.animationName==e.name?"option-active":""]),onClick:t=>h(e),key:e.name},[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o._)("div",se,(0,l.zw)(e.name),1),(0,o.wy)((0,o._)("div",re,[(0,o.Wm)(s,{size:"20px",color:"#2a3ff6"},{default:(0,o.w5)((()=>[(0,o.Wm)(n)])),_:1})],512),[[a.F8,d.animationName==e.name]])])),_:2},1024)],10,ae)))),128))])),_:1})):((0,o.wg)(),(0,o.j4)(w,{key:1,description:"暂无动画","image-size":120}))],2),de,(0,o._)("div",{class:(0,l.C_)(["options",p.value])},[(0,o._)("div",pe,[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(y)])),_:1}),ue])),_:1})]),(0,o._)("div",ce,[(0,o.Wm)(C,{modelValue:d.loop,"onUpdate:modelValue":t[1]||(t[1]=e=>d.loop=e),onChange:g},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{label:"LoopOnce"},{default:(0,o.w5)((()=>[(0,o.Uk)("只执行一次")])),_:1}),(0,o.Wm)(b,{label:"LoopRepeat"},{default:(0,o.w5)((()=>[(0,o.Uk)("无限循环")])),_:1}),(0,o.Wm)(b,{label:"LoopPingPong"},{default:(0,o.w5)((()=>[(0,o.Uk)("来回循环")])),_:1})])),_:1},8,["modelValue"])]),(0,o._)("div",me,[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(L)])),_:1}),he])),_:1})]),(0,o._)("div",ge,[(0,o.Wm)(k,{"show-input":"",modelValue:d.timeScale,"onUpdate:modelValue":t[2]||(t[2]=e=>d.timeScale=e),onChange:g,step:.01,min:0,max:1},null,8,["modelValue"])]),(0,o._)("div",_e,[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(W)])),_:1}),fe])),_:1})]),(0,o._)("div",ve,[(0,o.Wm)(k,{"show-input":"",modelValue:d.weight,"onUpdate:modelValue":t[3]||(t[3]=e=>d.weight=e),onChange:g,step:.01,min:0,max:1},null,8,["modelValue"])])],2),(0,o._)("div",we,[ye,(0,o.Wm)(i,{modelValue:d.rotationVisible,"onUpdate:modelValue":t[4]||(t[4]=e=>d.rotationVisible=e),onChange:_},null,8,["modelValue"])]),(0,o._)("div",be,[(0,o._)("div",{class:(0,l.C_)(["option",u.value])},[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[Ce,(0,o.Wm)(C,{modelValue:d.rotationType,"onUpdate:modelValue":t[5]||(t[5]=e=>d.rotationType=e),onChange:f},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{label:"x"},{default:(0,o.w5)((()=>[(0,o.Uk)("X轴")])),_:1}),(0,o.Wm)(b,{label:"y"},{default:(0,o.w5)((()=>[(0,o.Uk)("Y轴")])),_:1}),(0,o.Wm)(b,{label:"z"},{default:(0,o.w5)((()=>[(0,o.Uk)("Z轴")])),_:1})])),_:1},8,["modelValue"])])),_:1})],2),(0,o._)("div",{class:(0,l.C_)(["option",u.value])},[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(L)])),_:1}),Le])),_:1})],2),(0,o._)("div",{class:(0,l.C_)(["option",u.value])},[(0,o.Wm)(k,{onChange:_,"show-input":"",modelValue:d.rotationSpeed,"onUpdate:modelValue":t[6]||(t[6]=e=>d.rotationSpeed=e),step:.01,min:1,max:10},null,8,["modelValue"])],2)])])}}};const We=ke;var Me=We;const xe={class:"edit-box"},Se={class:"header"},Ae=(0,o._)("span",null,"辅助线/轴配置",-1),Ve={class:"option space-between"},Ue=(0,o._)("span",null," 模型轴旋转 ",-1),He={class:"option"},Pe={class:"option"},Fe={class:"option"},Ee={class:"option space-between"},Te=(0,o._)("span",null," 模型位置 ",-1),Ie={class:"option"},Re={class:"grid-txt"},De={class:"grid-silder"},ze={class:"option"},je={class:"grid-txt"},Oe={class:"grid-silder"},Ge={class:"option"},Be={class:"grid-txt"},Ne={class:"grid-silder"},qe={class:"option space-between"},Ye=(0,o._)("span",null," 模型骨架 ",-1),Ze={class:"option space-between"},Xe=(0,o._)("span",null," 网格辅助线 ",-1),$e={class:"option"},Ke={class:"grid-txt"},Qe={class:"grid-silder"},Je={class:"option"},et={class:"grid-txt"},tt={class:"grid-silder"},it={class:"option"},ot={class:"grid-txt"},nt={class:"grid-silder"},lt={class:"option"},at={class:"option"},st={class:"option space-between"},rt=(0,o._)("span",null," 坐标轴辅助线 ",-1),dt={class:"grid-txt"},pt={class:"grid-silder"};var ut={__name:"EditAttribute",setup(e,{expose:t}){const i=(0,s.oR)(),{$bus:a}=(0,o.FN)().proxy,d=(0,n.qj)({visible:!0,skeletonHelper:!1,gridHelper:!1,x:0,y:-.59,z:-.1,positionX:0,positionY:-.5,positionZ:0,divisions:10,size:4,color:"rgb(193,193,193)",axesHelper:!1,axesSize:1.8}),p=r.UL,u=(0,o.Fl)((()=>d.visible?"":"disabled")),c=(0,o.Fl)((()=>{const{visible:e,gridHelper:t}=d;return t&&e?"":"disabled"})),m=(0,o.Fl)((()=>{const{visible:e,axesHelper:t}=d;return t&&e?"":"disabled"})),h=(0,n.qj)({modelApi:(0,o.Fl)((()=>i.state.modelApi))});(0,o.bv)((()=>{a.on("model-update",(()=>{Object.assign(d,{visible:!0,skeletonHelper:!1,gridHelper:!1,x:0,y:-.59,z:-.1,positionX:0,positionY:-.5,positionZ:0,divisions:10,size:4,color:"rgb(193,193,193)",axesHelper:!1,axesSize:1.8})}))}));const g=()=>{},_=(e,t)=>{const i="right"==t;h.modelApi.onSetModelRotateOnAxis(e,i)},f=()=>{h.modelApi.onResultModelRotateOnAxis()},v=()=>{h.modelApi.onSetModelPosition(d)},w=()=>{d.positionX=0,d.positionY=-.5,d.positionZ=0,h.modelApi.onResultModelPosition(d)},y=()=>{h.modelApi.onSetModelHelper(d.skeletonHelper)},b=e=>{d.color=e,h.modelApi.onSetModelGridHelper(d)},C=()=>{h.modelApi.onSetModelGridHelper(d)},L=()=>{h.modelApi.onSetModelGridHelperSize(d)},k=()=>{h.modelApi.onSetModelAxesHelper(d)},W=()=>{const{x:e,y:t,z:i}=h.modelApi.model.rotation;let o=e,n=t,l=i;return{...d,rotationX:o,rotationY:n,rotationZ:l}};return t({getAttrbuteConfig:W}),(e,t)=>{const i=(0,o.up)("el-switch"),a=(0,o.up)("Setting"),s=(0,o.up)("el-icon"),r=(0,o.up)("el-space"),h=(0,o.up)("el-button"),W=(0,o.up)("Location"),M=(0,o.up)("el-slider"),x=(0,o.up)("Eleme"),S=(0,o.up)("Grid"),A=(0,o.up)("el-input-number"),V=(0,o.up)("el-color-picker"),U=(0,o.up)("Rank");return(0,o.wg)(),(0,o.iD)("div",xe,[(0,o._)("div",Se,[Ae,(0,o.Wm)(i,{modelValue:d.visible,"onUpdate:modelValue":t[0]||(t[0]=e=>d.visible=e),onChange:g},null,8,["modelValue"])]),(0,o._)("div",{class:(0,l.C_)(["options",u.value])},[(0,o._)("div",Ve,[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(a)])),_:1}),Ue])),_:1}),(0,o.Wm)(h,{type:"primary",link:"",icon:"Refresh",onClick:f},{default:(0,o.w5)((()=>[(0,o.Uk)(" 重置 ")])),_:1})]),(0,o._)("div",He,[(0,o.Wm)(h,{type:"info",icon:"RefreshRight",onClick:t[1]||(t[1]=e=>_("x","right"))}),(0,o.Wm)(h,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("X轴")])),_:1}),(0,o.Wm)(h,{type:"info",icon:"RefreshLeft",onClick:t[2]||(t[2]=e=>_("x","left"))})]),(0,o._)("div",Pe,[(0,o.Wm)(h,{type:"info",icon:"RefreshRight",onClick:t[3]||(t[3]=e=>_("y","right"))}),(0,o.Wm)(h,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("Y轴")])),_:1}),(0,o.Wm)(h,{type:"info",icon:"RefreshLeft",onClick:t[4]||(t[4]=e=>_("y","left"))})]),(0,o._)("div",Fe,[(0,o.Wm)(h,{type:"info",icon:"RefreshRight",onClick:t[5]||(t[5]=e=>_("z","right"))}),(0,o.Wm)(h,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("Z轴")])),_:1}),(0,o.Wm)(h,{type:"info",icon:"RefreshLeft",onClick:t[6]||(t[6]=e=>_("z","left"))})]),(0,o._)("div",Ee,[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(W)])),_:1}),Te])),_:1}),(0,o.Wm)(h,{type:"primary",link:"",icon:"Refresh",onClick:w},{default:(0,o.w5)((()=>[(0,o.Uk)(" 重置 ")])),_:1})]),(0,o._)("div",Ie,[(0,o._)("div",Re,[(0,o.Wm)(h,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("X 轴")])),_:1})]),(0,o._)("div",De,[(0,o.Wm)(M,{onChange:v,"show-input":"",modelValue:d.positionX,"onUpdate:modelValue":t[7]||(t[7]=e=>d.positionX=e),min:-10,max:10,step:.1},null,8,["modelValue"])])]),(0,o._)("div",ze,[(0,o._)("div",je,[(0,o.Wm)(h,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("Y 轴")])),_:1})]),(0,o._)("div",Oe,[(0,o.Wm)(M,{onChange:v,"show-input":"",modelValue:d.positionY,"onUpdate:modelValue":t[8]||(t[8]=e=>d.positionY=e),min:-10,max:10,step:.1},null,8,["modelValue"])])]),(0,o._)("div",Ge,[(0,o._)("div",Be,[(0,o.Wm)(h,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("Z 轴")])),_:1})]),(0,o._)("div",Ne,[(0,o.Wm)(M,{onChange:v,"show-input":"",modelValue:d.positionZ,"onUpdate:modelValue":t[9]||(t[9]=e=>d.positionZ=e),min:-10,max:10,step:.1},null,8,["modelValue"])])]),(0,o._)("div",qe,[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(x)])),_:1}),Ye])),_:1}),(0,o.Wm)(i,{modelValue:d.skeletonHelper,"onUpdate:modelValue":t[10]||(t[10]=e=>d.skeletonHelper=e),onChange:y},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["options",u.value])},[(0,o._)("div",Ze,[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(S)])),_:1}),Xe])),_:1}),(0,o.Wm)(i,{modelValue:d.gridHelper,"onUpdate:modelValue":t[11]||(t[11]=e=>d.gridHelper=e),onChange:C},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["options",c.value])},[(0,o._)("div",$e,[(0,o._)("div",Ke,[(0,o.Wm)(h,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("X 轴")])),_:1})]),(0,o._)("div",Qe,[(0,o.Wm)(M,{"show-input":"",onChange:C,modelValue:d.x,"onUpdate:modelValue":t[12]||(t[12]=e=>d.x=e),min:-2,max:4,step:.01},null,8,["modelValue"])])]),(0,o._)("div",Je,[(0,o._)("div",et,[(0,o.Wm)(h,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("Y 轴")])),_:1})]),(0,o._)("div",tt,[(0,o.Wm)(M,{"show-input":"",onChange:C,modelValue:d.y,"onUpdate:modelValue":t[13]||(t[13]=e=>d.y=e),min:-2,max:4,step:.01},null,8,["modelValue"])])]),(0,o._)("div",it,[(0,o._)("div",ot,[(0,o.Wm)(h,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("Z 轴")])),_:1})]),(0,o._)("div",nt,[(0,o.Wm)(M,{"show-input":"",onChange:C,modelValue:d.z,"onUpdate:modelValue":t[14]||(t[14]=e=>d.z=e),min:-2,max:4,step:.01},null,8,["modelValue"])])]),(0,o._)("div",lt,[(0,o._)("div",null,[(0,o.Wm)(h,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("大小")])),_:1}),(0,o.Wm)(A,{controls:!0,onChange:L,modelValue:d.size,"onUpdate:modelValue":t[15]||(t[15]=e=>d.size=e),min:1,max:40},null,8,["modelValue"])]),(0,o._)("div",null,[(0,o.Wm)(h,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("分割数")])),_:1}),(0,o.Wm)(A,{controls:!0,onChange:L,modelValue:d.divisions,"onUpdate:modelValue":t[16]||(t[16]=e=>d.divisions=e),min:1,max:40},null,8,["modelValue"])])]),(0,o._)("div",at,[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(h,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("网格颜色")])),_:1}),(0,o.Wm)(V,{"color-format":"hex",predefine:(0,n.SU)(p),onChange:C,onActiveChange:b,modelValue:d.color,"onUpdate:modelValue":t[17]||(t[17]=e=>d.color=e)},null,8,["predefine","modelValue"])])),_:1})])],2),(0,o._)("div",{class:(0,l.C_)(["options",u.value])},[(0,o._)("div",st,[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(U)])),_:1}),rt])),_:1}),(0,o.Wm)(i,{modelValue:d.axesHelper,"onUpdate:modelValue":t[18]||(t[18]=e=>d.axesHelper=e),onChange:k},null,8,["modelValue"])]),(0,o._)("div",{class:(0,l.C_)(["option",m.value])},[(0,o._)("div",dt,[(0,o.Wm)(h,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("轴长度")])),_:1})]),(0,o._)("div",pt,[(0,o.Wm)(M,{onChange:k,modelValue:d.axesSize,"onUpdate:modelValue":t[19]||(t[19]=e=>d.axesSize=e),min:1,max:10,step:.2},null,8,["modelValue"])])],2)],2)])}}};const ct=ut;var mt=ct;const ht=e=>((0,o.dD)("data-v-56578968"),e=e(),(0,o.Cn)(),e),gt={class:"edit-box"},_t=ht((()=>(0,o._)("div",{class:"header"},[(0,o._)("span",null,"模型灯光")],-1))),ft={class:"options"},vt={class:"option space-between"},wt=ht((()=>(0,o._)("span",null,"模型平面",-1))),yt=ht((()=>(0,o._)("span",null,"平面颜色",-1))),bt={class:"grid-txt"},Ct={class:"grid-silder"},Lt={class:"grid-txt"},kt={class:"grid-silder"},Wt={class:"options"},Mt={class:"option space-between"},xt=ht((()=>(0,o._)("span",null,"环境光",-1))),St={class:"color"},At={class:"silder"},Vt={class:"options"},Ut={class:"option space-between"},Ht=ht((()=>(0,o._)("span",null,"平行光",-1))),Pt={class:"color"},Ft={class:"silder"},Et={class:"grid-txt"},Tt={class:"grid-silder"},It={class:"grid-txt"},Rt={class:"grid-silder"},Dt={class:"grid-txt"},zt={class:"grid-silder"},jt={class:"grid-txt"},Ot={class:"grid-silder"},Gt={class:"grid-txt"},Bt={class:"grid-silder"},Nt={class:"options"},qt={class:"option space-between"},Yt=ht((()=>(0,o._)("span",null,"点光源",-1))),Zt={class:"grid-txt"},Xt={class:"grid-silder"},$t={class:"color"},Kt={class:"silder"},Qt={class:"grid-txt"},Jt={class:"grid-silder"},ei={class:"grid-txt"},ti={class:"grid-silder"},ii={class:"grid-txt"},oi={class:"grid-silder"},ni={class:"options"},li={class:"option space-between"},ai=ht((()=>(0,o._)("span",null,"聚光灯",-1))),si={class:"color"},ri={class:"silder"},di={class:"grid-txt"},pi={class:"grid-silder"},ui={class:"grid-txt"},ci={class:"grid-silder"},mi={class:"grid-txt"},hi={class:"grid-silder"},gi={class:"grid-txt"},_i={class:"grid-silder"},fi={class:"grid-txt"},vi={class:"grid-silder"},wi={class:"grid-txt"},yi={class:"grid-silder"},bi={class:"grid-txt"},Ci={class:"grid-silder"},Li={class:"grid-txt"},ki={class:"grid-silder"},Wi={class:"grid-txt"},Mi={class:"grid-silder"};var xi={__name:"EditLight",setup(e,{expose:t}){const i=(0,s.oR)(),{$bus:a}=(0,o.FN)().proxy,d=(0,n.qj)({planeGeometry:!1,planeColor:"#939393",planeWidth:7,planeHeight:7,ambientLight:!0,ambientLightColor:"#fff",ambientLightIntensity:.8,directionalLight:!1,directionalLightHelper:!0,directionalLightColor:"#1E90FF",directionalLightIntensity:1,directionalHorizontal:-1.26,directionalVertical:-3.85,directionalSistance:2.98,directionaShadow:!0,pointLight:!1,pointLightHelper:!0,pointLightColor:"#1E90FF",pointLightIntensity:1,pointHorizontal:-4.21,pointVertical:-4.1,pointSistance:2.53,spotLight:!1,spotLightColor:"#323636",spotLightIntensity:400,spotHorizontal:-3.49,spotVertical:-4.37,spotSistance:4.09,spotAngle:.5,spotPenumbra:1,spotFocus:1,spotCastShadow:!0,spotLightHelper:!0,spotDistance:20}),p=r.UL,u=(0,o.Fl)((()=>{const{ambientLight:e}=d;return e?"":"disabled"})),c=(0,o.Fl)((()=>{const{directionalLight:e}=d;return e?"":"disabled"})),m=(0,o.Fl)((()=>{const{pointLight:e}=d;return e?"":"disabled"})),h=(0,o.Fl)((()=>{const{spotLight:e}=d;return e?"":"disabled"})),g=(0,o.Fl)((()=>{const{planeGeometry:e}=d;return e?"":"disabled"})),_=(0,n.qj)({modelApi:(0,o.Fl)((()=>i.state.modelApi))});(0,o.bv)((()=>{a.on("model-update",(()=>{Object.assign(d,{planeGeometry:!1,planeColor:"#939393",planeWidth:7,planeHeight:7,ambientLight:!0,ambientLightColor:"#fff",ambientLightIntensity:.8,directionalLight:!1,directionalLightHelper:!0,directionalLightColor:"#1E90FF",directionalLightIntensity:1,directionalHorizontal:-1.26,directionalVertical:-3.85,directionalSistance:2.98,directionaShadow:!0,pointLight:!1,pointLightHelper:!0,pointLightColor:"#1E90FF",pointLightIntensity:1,pointHorizontal:-4.21,pointVertical:-4.1,pointSistance:2.53,spotLight:!1,spotLightColor:"#323636",spotLightIntensity:400,spotHorizontal:-3.49,spotVertical:-4.37,spotSistance:4.09,spotAngle:.5,spotPenumbra:1,spotFocus:1,spotCastShadow:!0,spotLightHelper:!0,spotDistance:20})}))}));const f=e=>{d.ambientLightColor=e,_.modelApi.onSetModelAmbientLight(d)},v=()=>{_.modelApi.onSetModelAmbientLight(d)},w=e=>{d.directionalLightColor=e,_.modelApi.onSetModelDirectionalLight(d)},y=()=>{d.directionalLight&&(d.planeGeometry=!0,_.modelApi.onSetModelPlaneGeometry(d)),_.modelApi.onSetModelDirectionalLight(d)},b=e=>{d.pointLightColor=e,_.modelApi.onSetModelPointLight(d)},C=()=>{_.modelApi.onSetModelPointLight(d)},L=e=>{d.spotLightColor=e,_.modelApi.onSetModelSpotLight(d)},k=()=>{d.spotLight&&(d.planeGeometry=!0,_.modelApi.onSetModelPlaneGeometry(d)),_.modelApi.onSetModelSpotLight(d)},W=e=>{d.planeColor=e,_.modelApi.onSetModelPlaneGeometry(d)},M=()=>{_.modelApi.onSetModelPlaneGeometry(d)};return t({config:d}),(e,t)=>{const i=(0,o.up)("Odometer"),a=(0,o.up)("el-icon"),s=(0,o.up)("el-space"),r=(0,o.up)("el-switch"),_=(0,o.up)("el-color-picker"),x=(0,o.up)("el-button"),S=(0,o.up)("el-slider"),A=(0,o.up)("SetUp"),V=(0,o.up)("Place"),U=(0,o.up)("Orange"),H=(0,o.up)("el-scrollbar");return(0,o.wg)(),(0,o.iD)("div",gt,[_t,(0,o.Wm)(H,{height:"calc(100vh - 130px)"},{default:(0,o.w5)((()=>[(0,o._)("div",ft,[(0,o._)("div",vt,[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Wm)(i)])),_:1}),wt])),_:1}),(0,o.Wm)(r,{modelValue:d.planeGeometry,"onUpdate:modelValue":t[0]||(t[0]=e=>d.planeGeometry=e),onChange:M},null,8,["modelValue"])]),(0,o._)("div",{class:(0,l.C_)(["option",g.value])},[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[yt,(0,o.Wm)(_,{"color-format":"hex",modelValue:d.planeColor,"onUpdate:modelValue":t[1]||(t[1]=e=>d.planeColor=e),predefine:(0,n.SU)(p),onChange:M,onActiveChange:W},null,8,["modelValue","predefine"])])),_:1})],2),(0,o._)("div",{class:(0,l.C_)(["option",g.value])},[(0,o._)("div",bt,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("宽度")])),_:1})]),(0,o._)("div",Ct,[(0,o.Wm)(S,{"show-input":"",onChange:M,modelValue:d.planeWidth,"onUpdate:modelValue":t[2]||(t[2]=e=>d.planeWidth=e),min:0,max:100,step:.1},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["option",g.value])},[(0,o._)("div",Lt,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("高度")])),_:1})]),(0,o._)("div",kt,[(0,o.Wm)(S,{"show-input":"",onChange:M,modelValue:d.planeHeight,"onUpdate:modelValue":t[3]||(t[3]=e=>d.planeHeight=e),min:0,max:100,step:.1},null,8,["modelValue"])])],2)]),(0,o._)("div",Wt,[(0,o._)("div",Mt,[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Wm)(i)])),_:1}),xt])),_:1}),(0,o.Wm)(r,{modelValue:d.ambientLight,"onUpdate:modelValue":t[4]||(t[4]=e=>d.ambientLight=e),onChange:v},null,8,["modelValue"])]),(0,o._)("div",{class:(0,l.C_)(["option",u.value])},[(0,o._)("div",St,[(0,o.Wm)(_,{"color-format":"hex",modelValue:d.ambientLightColor,"onUpdate:modelValue":t[5]||(t[5]=e=>d.ambientLightColor=e),predefine:(0,n.SU)(p),onChange:v,onActiveChange:f},null,8,["modelValue","predefine"])]),(0,o._)("div",At,[(0,o.Wm)(S,{"show-input":"",onChange:v,modelValue:d.ambientLightIntensity,"onUpdate:modelValue":t[6]||(t[6]=e=>d.ambientLightIntensity=e),min:-5,max:5,step:.01},null,8,["modelValue"])])],2)]),(0,o._)("div",Vt,[(0,o._)("div",Ut,[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Wm)(A)])),_:1}),Ht])),_:1}),(0,o.Wm)(r,{modelValue:d.directionalLight,"onUpdate:modelValue":t[7]||(t[7]=e=>d.directionalLight=e),onChange:y},null,8,["modelValue"])]),(0,o._)("div",{class:(0,l.C_)(["option",c.value])},[(0,o._)("div",Pt,[(0,o.Wm)(_,{"color-format":"hex",modelValue:d.directionalLightColor,"onUpdate:modelValue":t[8]||(t[8]=e=>d.directionalLightColor=e),predefine:(0,n.SU)(p),onChange:y,onActiveChange:w},null,8,["modelValue","predefine"])]),(0,o._)("div",Ft,[(0,o.Wm)(S,{"show-input":"",onChange:y,modelValue:d.directionalLightIntensity,"onUpdate:modelValue":t[9]||(t[9]=e=>d.directionalLightIntensity=e),min:-5,max:5,step:.01},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["option",c.value])},[(0,o._)("div",Et,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("是否开启阴影")])),_:1})]),(0,o._)("div",Tt,[(0,o.Wm)(r,{modelValue:d.directionaShadow,"onUpdate:modelValue":t[10]||(t[10]=e=>d.directionaShadow=e),onChange:y},null,8,["modelValue"])]),(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o._)("div",It,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("辅助线")])),_:1})]),(0,o._)("div",Rt,[(0,o.Wm)(r,{modelValue:d.directionalLightHelper,"onUpdate:modelValue":t[11]||(t[11]=e=>d.directionalLightHelper=e),onChange:y},null,8,["modelValue"])])])),_:1})],2),(0,o._)("div",{class:(0,l.C_)(["option",c.value])},[(0,o._)("div",Dt,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("水平方向")])),_:1})]),(0,o._)("div",zt,[(0,o.Wm)(S,{"show-input":"",onChange:y,modelValue:d.directionalHorizontal,"onUpdate:modelValue":t[12]||(t[12]=e=>d.directionalHorizontal=e),min:-10,max:10,step:.01},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["option",c.value])},[(0,o._)("div",jt,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("垂直方向")])),_:1})]),(0,o._)("div",Ot,[(0,o.Wm)(S,{"show-input":"",onChange:y,modelValue:d.directionalVertical,"onUpdate:modelValue":t[13]||(t[13]=e=>d.directionalVertical=e),min:-10,max:10,step:.01},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["option",c.value])},[(0,o._)("div",Gt,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("光源距离")])),_:1})]),(0,o._)("div",Bt,[(0,o.Wm)(S,{"show-input":"",onChange:y,modelValue:d.directionalSistance,"onUpdate:modelValue":t[14]||(t[14]=e=>d.directionalSistance=e),min:0,max:10,step:.01},null,8,["modelValue"])])],2)]),(0,o._)("div",Nt,[(0,o._)("div",qt,[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Wm)(V)])),_:1}),Yt])),_:1}),(0,o.Wm)(r,{modelValue:d.pointLight,"onUpdate:modelValue":t[15]||(t[15]=e=>d.pointLight=e),onChange:C},null,8,["modelValue"])]),(0,o._)("div",{class:(0,l.C_)(["option",m.value])},[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o._)("div",Zt,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("辅助线")])),_:1})]),(0,o._)("div",Xt,[(0,o.Wm)(r,{modelValue:d.pointLightHelper,"onUpdate:modelValue":t[16]||(t[16]=e=>d.pointLightHelper=e),onChange:C},null,8,["modelValue"])])])),_:1})],2),(0,o._)("div",{class:(0,l.C_)(["option",m.value])},[(0,o._)("div",$t,[(0,o.Wm)(_,{"color-format":"hex",modelValue:d.pointLightColor,"onUpdate:modelValue":t[17]||(t[17]=e=>d.pointLightColor=e),predefine:(0,n.SU)(p),onChange:C,onActiveChange:b},null,8,["modelValue","predefine"])]),(0,o._)("div",Kt,[(0,o.Wm)(S,{"show-input":"",onChange:C,modelValue:d.pointLightIntensity,"onUpdate:modelValue":t[18]||(t[18]=e=>d.pointLightIntensity=e),min:-15,max:15,step:.1},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["option",m.value])},[(0,o._)("div",Qt,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("水平方向")])),_:1})]),(0,o._)("div",Jt,[(0,o.Wm)(S,{"show-input":"",onChange:C,modelValue:d.pointHorizontal,"onUpdate:modelValue":t[19]||(t[19]=e=>d.pointHorizontal=e),min:-10,max:10,step:.11},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["option",m.value])},[(0,o._)("div",ei,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("垂直方向")])),_:1})]),(0,o._)("div",ti,[(0,o.Wm)(S,{"show-input":"",onChange:C,modelValue:d.pointVertical,"onUpdate:modelValue":t[20]||(t[20]=e=>d.pointVertical=e),min:-10,max:10,step:.1},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["option",m.value])},[(0,o._)("div",ii,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("光源距离")])),_:1})]),(0,o._)("div",oi,[(0,o.Wm)(S,{"show-input":"",onChange:C,modelValue:d.pointSistance,"onUpdate:modelValue":t[21]||(t[21]=e=>d.pointSistance=e),min:0,max:10,step:.1},null,8,["modelValue"])])],2)]),(0,o._)("div",ni,[(0,o._)("div",li,[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Wm)(U)])),_:1}),ai])),_:1}),(0,o.Wm)(r,{modelValue:d.spotLight,"onUpdate:modelValue":t[22]||(t[22]=e=>d.spotLight=e),onChange:k},null,8,["modelValue"])]),(0,o._)("div",{class:(0,l.C_)(["option",h.value])},[(0,o._)("div",si,[(0,o.Wm)(_,{"color-format":"hex",modelValue:d.spotLightColor,"onUpdate:modelValue":t[23]||(t[23]=e=>d.spotLightColor=e),predefine:(0,n.SU)(p),onChange:k,onActiveChange:L},null,8,["modelValue","predefine"])]),(0,o._)("div",ri,[(0,o.Wm)(S,{"show-input":"",onChange:k,modelValue:d.spotLightIntensity,"onUpdate:modelValue":t[24]||(t[24]=e=>d.spotLightIntensity=e),min:0,max:600,step:.1},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["option",h.value])},[(0,o._)("div",di,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("是否开启阴影")])),_:1})]),(0,o._)("div",pi,[(0,o.Wm)(r,{modelValue:d.spotCastShadow,"onUpdate:modelValue":t[25]||(t[25]=e=>d.spotCastShadow=e),onChange:k},null,8,["modelValue"])]),(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o._)("div",ui,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("辅助线")])),_:1})]),(0,o._)("div",ci,[(0,o.Wm)(r,{modelValue:d.spotLightHelper,"onUpdate:modelValue":t[26]||(t[26]=e=>d.spotLightHelper=e),onChange:k},null,8,["modelValue"])])])),_:1})],2),(0,o._)("div",{class:(0,l.C_)(["option",h.value])},[(0,o._)("div",mi,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("水平方向")])),_:1})]),(0,o._)("div",hi,[(0,o.Wm)(S,{"show-input":"",onChange:k,modelValue:d.spotHorizontal,"onUpdate:modelValue":t[27]||(t[27]=e=>d.spotHorizontal=e),min:-10,max:10,step:.1},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["option",h.value])},[(0,o._)("div",gi,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("垂直方向")])),_:1})]),(0,o._)("div",_i,[(0,o.Wm)(S,{"show-input":"",onChange:k,modelValue:d.spotVertical,"onUpdate:modelValue":t[28]||(t[28]=e=>d.spotVertical=e),min:-10,max:10,step:.1},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["option",h.value])},[(0,o._)("div",fi,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("光源距离")])),_:1})]),(0,o._)("div",vi,[(0,o.Wm)(S,{"show-input":"",onChange:k,modelValue:d.spotSistance,"onUpdate:modelValue":t[29]||(t[29]=e=>d.spotSistance=e),min:0,max:10,step:.1},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["option",h.value])},[(0,o._)("div",wi,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("光线照射范围")])),_:1})]),(0,o._)("div",yi,[(0,o.Wm)(S,{"show-input":"",onChange:k,modelValue:d.spotAngle,"onUpdate:modelValue":t[30]||(t[30]=e=>d.spotAngle=e),min:0,max:2,step:.01},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["option",h.value])},[(0,o._)("div",bi,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("边缘聚光度")])),_:1})]),(0,o._)("div",Ci,[(0,o.Wm)(S,{"show-input":"",onChange:k,modelValue:d.spotPenumbra,"onUpdate:modelValue":t[31]||(t[31]=e=>d.spotPenumbra=e),min:0,max:1,step:.01},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["option",h.value])},[(0,o._)("div",Li,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("投影聚焦度")])),_:1})]),(0,o._)("div",ki,[(0,o.Wm)(S,{"show-input":"",onChange:k,modelValue:d.spotFocus,"onUpdate:modelValue":t[32]||(t[32]=e=>d.spotFocus=e),min:0,max:3,step:.01},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["option",h.value])},[(0,o._)("div",Wi,[(0,o.Wm)(x,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("光源照射距离")])),_:1})]),(0,o._)("div",Mi,[(0,o.Wm)(S,{"show-input":"",onChange:k,modelValue:d.spotDistance,"onUpdate:modelValue":t[33]||(t[33]=e=>d.spotDistance=e),min:1,max:500,step:1},null,8,["modelValue"])])],2)])])),_:1})])}}};const Si=(0,x.Z)(xi,[["__scopeId","data-v-56578968"]]);var Ai=Si;const Vi={class:"edit-box"},Ui=(0,o._)("div",{class:"header"},[(0,o._)("span",null,"后期处理")],-1),Hi={class:"options"},Pi={class:"option space-between"},Fi=(0,o._)("span",null," 辉光 ",-1),Ei={class:"option"},Ti={class:"grid-txt"},Ii={class:"grid-silder"},Ri={class:"option"},Di={class:"grid-txt"},zi={class:"grid-silder"},ji={class:"option"},Oi={class:"grid-txt"},Gi={class:"grid-silder"},Bi={class:"options"},Ni={class:"option space-between"},qi=(0,o._)("span",null," 色调曝光度 ",-1),Yi={class:"grid-silder"},Zi={class:"header"},Xi=(0,o._)("span",null,"模型操作",-1),$i={class:"options"},Ki=(0,o._)("span",null," 模型分解 ",-1),Qi={class:"grid-silder"},Ji=(0,o._)("span",null," 模型材质拖拽 ",-1),eo={class:"grid-silder"};var to={__name:"EditLaterStage",setup(e,{expose:t}){const i=(0,s.oR)(),{$bus:a}=(0,o.FN)().proxy,r=(0,n.qj)({modelApi:(0,o.Fl)((()=>i.state.modelApi))}),d=(0,o.Fl)((()=>{const{glow:e}=c;return e?"":"disabled"})),p=(0,o.Fl)((()=>{const e=r.modelApi.modelMaterialList,t=e.filter((e=>"Mesh"==e.type));return t.length<=1||t.length!=e.length||c.modelDrag?"disabled":""})),u=(0,o.Fl)((()=>{const e=r.modelApi.modelMaterialList,t=e.filter((e=>"Mesh"==e.type));return t.length<=1||t.length!=e.length?"disabled":""})),c=((0,o.Fl)((()=>{const e=r.modelApi.modelMaterialList,t=e.filter((e=>"Mesh"==e.type));return t.length<=1&&!c.hoverMeshTag?"disabled":""})),(0,n.qj)({glow:!1,threshold:.05,strength:.6,radius:1,decompose:0,modelDrag:!1,toneMappingExposure:3,hoverMeshTag:!1}));(0,o.bv)((()=>{a.on("model-update",(()=>{Object.assign(c,{glow:!1,threshold:.05,strength:.6,radius:1,decompose:0,modelDrag:!1,toneMappingExposure:3,hoverMeshTag:!1})}))}));const m=()=>{r.modelApi.onSetUnrealBloomPass(c)},h=()=>{r.modelApi.setModelMeshDecompose(c)},g=()=>{c.decompose=0,r.modelApi.setModelMeshDecompose(c),r.modelApi.setModelMeshDrag(c)},_=()=>({meshPositonList:r.modelApi.getMeshDragPosition(),...c});return t({getStageConfig:_}),(e,t)=>{const i=(0,o.up)("Sunny"),n=(0,o.up)("el-icon"),a=(0,o.up)("el-space"),s=(0,o.up)("el-switch"),r=(0,o.up)("el-button"),_=(0,o.up)("el-slider"),f=(0,o.up)("Umbrella"),v=(0,o.up)("WarnTriangleFilled"),w=(0,o.up)("el-tooltip"),y=(0,o.up)("Cpu"),b=(0,o.up)("Rank");return(0,o.wg)(),(0,o.iD)("div",Vi,[Ui,(0,o._)("div",Hi,[(0,o._)("div",Pi,[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[(0,o.Wm)(i)])),_:1}),Fi])),_:1}),(0,o.Wm)(s,{modelValue:c.glow,"onUpdate:modelValue":t[0]||(t[0]=e=>c.glow=e),onChange:m},null,8,["modelValue"])])]),(0,o._)("div",{class:(0,l.C_)(["options",d.value])},[(0,o._)("div",Ei,[(0,o._)("div",Ti,[(0,o.Wm)(r,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("强度")])),_:1})]),(0,o._)("div",Ii,[(0,o.Wm)(_,{"show-input":"",modelValue:c.strength,"onUpdate:modelValue":t[1]||(t[1]=e=>c.strength=e),onChange:m,step:.01,min:0,max:3},null,8,["modelValue"])])]),(0,o._)("div",Ri,[(0,o._)("div",Di,[(0,o.Wm)(r,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("半径")])),_:1})]),(0,o._)("div",zi,[(0,o.Wm)(_,{"show-input":"",modelValue:c.radius,"onUpdate:modelValue":t[2]||(t[2]=e=>c.radius=e),onChange:m,step:.01,min:0,max:2},null,8,["modelValue"])])]),(0,o._)("div",ji,[(0,o._)("div",Oi,[(0,o.Wm)(r,{type:"primary",link:""},{default:(0,o.w5)((()=>[(0,o.Uk)("阈值")])),_:1})]),(0,o._)("div",Gi,[(0,o.Wm)(_,{"show-input":"",modelValue:c.threshold,"onUpdate:modelValue":t[3]||(t[3]=e=>c.threshold=e),onChange:m,step:.01,min:0,max:1},null,8,["modelValue"])])])],2),(0,o._)("div",Bi,[(0,o._)("div",Ni,[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[(0,o.Wm)(f)])),_:1}),qi])),_:1}),(0,o._)("div",Yi,[(0,o.Wm)(_,{"show-input":"",modelValue:c.toneMappingExposure,"onUpdate:modelValue":t[4]||(t[4]=e=>c.toneMappingExposure=e),onChange:m,step:.01,min:.5,max:10},null,8,["modelValue"])])])]),(0,o._)("div",Zi,[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[Xi,"disabled"==p.value?((0,o.wg)(),(0,o.j4)(w,{key:0,effect:"dark",content:"当前模型不可进行以下操作",placement:"top"},{default:(0,o.w5)((()=>[(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{size:20,color:"#ffb940"})])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1})]),(0,o._)("div",$i,[(0,o._)("div",{class:(0,l.C_)(["option space-between",p.value])},[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[(0,o.Wm)(y)])),_:1}),Ki])),_:1}),(0,o._)("div",Qi,[(0,o.Wm)(_,{"show-input":"",modelValue:c.decompose,"onUpdate:modelValue":t[5]||(t[5]=e=>c.decompose=e),onChange:h,step:.01,min:0,max:20},null,8,["modelValue"])])],2),(0,o._)("div",{class:(0,l.C_)(["option",u.value])},[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[(0,o.Wm)(b,{size:20})])),_:1}),Ji])),_:1}),(0,o._)("div",eo,[(0,o.Wm)(s,{modelValue:c.modelDrag,"onUpdate:modelValue":t[6]||(t[6]=e=>c.modelDrag=e),onChange:g},null,8,["modelValue"])])],2)])])}}};const io=to;var oo=io;const no={class:"model-panel"},lo={class:"panel-tabs"},ao=["onClick"],so={class:"tab"},ro={class:"panel-edit"};var po={__name:"index",setup(e,{expose:t}){const i=[{name:"背景",key:"EditBackground",icon:"Picture"},{name:"材质",key:"EditMaterial",icon:"DataAnalysis"},{name:"后期/操作",key:"EditLaterStage",icon:"MagicStick"},{name:"灯光",key:"EditLight",icon:"Sunrise"},{name:"模型动画",key:"EditAnimation",icon:"VideoCameraFilled"},{name:"辅助线/轴配置",key:"EditAttribute",icon:"Box"}],s=(0,n.iH)("EditMaterial"),r=(0,n.iH)(null),d=(0,n.iH)(null),p=(0,n.iH)(null),u=(0,n.iH)(null),c=(0,n.iH)(null),m=(0,n.iH)(null),h=()=>({background:r.value.config,material:d.value.getMeshConfig(),animation:p.value.config,attribute:u.value.getAttrbuteConfig(),light:c.value.config,stage:m.value.getStageConfig()});return t({getPanelConfig:h}),(e,t)=>{const n=(0,o.up)("el-icon"),h=(0,o.up)("el-tooltip");return(0,o.wg)(),(0,o.iD)("div",no,[(0,o._)("ul",lo,[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)(i,(e=>(0,o._)("li",{key:e.key,class:(0,l.C_)(s.value==e.key?"active":""),onClick:t=>s.value=e.key},[(0,o.Wm)(h,{effect:"light",content:e.name,placement:"top"},{default:(0,o.w5)((()=>[(0,o._)("div",so,[(0,o.Wm)(n,{size:"20px",color:s.value==e.key?"#fff":""},{default:(0,o.w5)((()=>[((0,o.wg)(),(0,o.j4)((0,o.LL)(e.icon)))])),_:2},1032,["color"])])])),_:2},1032,["content"])],10,ao))),64))]),(0,o._)("div",ro,[(0,o.wy)((0,o._)("div",null,[(0,o.Wm)(A,{ref_key:"background",ref:r},null,512)],512),[[a.F8,"EditBackground"==s.value]]),(0,o.wy)((0,o._)("div",null,[(0,o.Wm)(ie,{ref_key:"material",ref:d},null,512)],512),[[a.F8,"EditMaterial"==s.value]]),(0,o.wy)((0,o._)("div",null,[(0,o.Wm)(oo,{ref_key:"stage",ref:m},null,512)],512),[[a.F8,"EditLaterStage"==s.value]]),(0,o.wy)((0,o._)("div",null,[(0,o.Wm)(Me,{ref_key:"animation",ref:p},null,512)],512),[[a.F8,"EditAnimation"==s.value]]),(0,o.wy)((0,o._)("div",null,[(0,o.Wm)(Ai,{ref_key:"light",ref:c},null,512)],512),[[a.F8,"EditLight"==s.value]]),(0,o.wy)((0,o._)("div",null,[(0,o.Wm)(mt,{ref_key:"attribute",ref:u},null,512)],512),[[a.F8,"EditAttribute"==s.value]])])])}}};const uo=(0,x.Z)(po,[["__scopeId","data-v-58c340f1"]]);var co=uo,mo=(i(6229),i(7330),i(2062),i(2346));const ho={class:"model-choose"},go=(0,o._)("div",{class:"header"},[(0,o._)("span",null,"模型列表")],-1),_o={class:"options"},fo={class:"option"},vo=(0,o._)("span",null,"普通模型",-1),wo={class:"options"},yo={class:"option"},bo=(0,o._)("span",null,"动画模型",-1),Co={class:"options"},Lo={class:"option"},ko=(0,o._)("span",null,"外部模型",-1),Wo={class:"file-name"},Mo=(0,o._)("span",null,"当前模型:",-1),xo={class:"upload"},So={class:"icon"},Ao=(0,o._)("div",null,[(0,o._)("span",null,"请选择(目前仅支持.glb, .obj, .gltf, .fbx格式)")],-1);var Vo={__name:"index",setup(e,{expose:t}){const a=(0,s.oR)(),{$bus:r}=(0,o.FN)().proxy,p=(0,n.qj)({modelApi:(0,o.Fl)((()=>a.state.modelApi))}),u=(0,o.Fl)((()=>d.H1.filter((e=>!e.animation)))),c=(0,o.Fl)((()=>d.H1.filter((e=>e.animation)))),m=(0,n.iH)(9),h=(0,n.iH)({name:"变形金刚（3）",fileType:"glb",id:9,animation:!1,filePath:"threeFile/glb/glb-9.glb",icon:i(8817),decomposeName:"transformers_3",key:"transformers-3"}),g=(0,n.iH)(null),_=async e=>{if(e.id==m.value)return!1;m.value=e.id,g.value=null,h.value=e,r.emit("page-loading",!0);try{const{load:t}=await p.modelApi.onSwitchModel(e);t&&(r.emit("model-update"),r.emit("page-loading",!1))}catch(t){r.emit("page-loading",!1)}},f=async e=>{g.value=e.name;const t=URL.createObjectURL(e.raw),i={filePath:t,fileType:(0,mo.JB)(e.name)};r.emit("page-loading",!0);try{const{load:e,filePath:t}=await p.modelApi.onSwitchModel(i);URL.revokeObjectURL(t),e&&(r.emit("model-update"),r.emit("page-loading",!1),m.value=null,h.value={})}catch(o){g.value=null,r.emit("page-loading",!1)}};return t({activeModel:h}),(e,t)=>{const i=(0,o.up)("Orange"),n=(0,o.up)("el-icon"),a=(0,o.up)("el-space"),s=(0,o.up)("el-image"),r=(0,o.up)("el-col"),d=(0,o.up)("el-row"),p=(0,o.up)("el-scrollbar"),h=(0,o.up)("Paperclip"),v=(0,o.up)("UploadFilled"),w=(0,o.up)("el-tooltip"),y=(0,o.up)("Plus"),b=(0,o.up)("el-upload");return(0,o.wg)(),(0,o.iD)("div",ho,[go,(0,o._)("div",_o,[(0,o._)("div",fo,[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[(0,o.Wm)(i)])),_:1}),vo])),_:1})]),(0,o.Wm)(p,{"max-height":"250px"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(u.value,(e=>((0,o.wg)(),(0,o.j4)(r,{style:{textAlign:"center"},span:12,key:e.id},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{onClick:t=>_(e),class:(0,l.C_)(["el-img",m.value==e.id?"active-model":""]),src:e.icon,fit:"cover"},null,8,["onClick","class","src"])])),_:2},1024)))),128))])),_:1})])),_:1})]),(0,o._)("div",wo,[(0,o._)("div",yo,[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[(0,o.Wm)(h)])),_:1}),bo])),_:1})]),(0,o.Wm)(p,{"max-height":"250px"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(c.value,(e=>((0,o.wg)(),(0,o.j4)(r,{style:{textAlign:"center"},span:12,key:e.id},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{onClick:t=>_(e),class:(0,l.C_)(["el-img",m.value==e.id?"active-model":""]),src:e.icon,fit:"cover"},null,8,["onClick","class","src"])])),_:2},1024)))),128))])),_:1})])),_:1})]),(0,o._)("div",Co,[(0,o._)("div",Lo,[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v)])),_:1}),ko])),_:1})]),(0,o._)("div",Wo,[Mo,(0,o.Wm)(w,{effect:"dark",content:g.value,placement:"top"},{default:(0,o.w5)((()=>[(0,o._)("b",null,(0,l.zw)(g.value),1)])),_:1},8,["content"])]),(0,o.Wm)(b,{action:"",accept:".glb,.obj,.gltf,.fbx",class:"file-box","show-file-list":!1,"auto-upload":!1,"on-change":f},{default:(0,o.w5)((()=>[(0,o._)("div",xo,[(0,o._)("div",So,[(0,o.Wm)(n,{size:44},{default:(0,o.w5)((()=>[(0,o.Wm)(y)])),_:1}),Ao])])])),_:1})])])}}};const Uo=Vo;var Ho=Uo,Po=i(2483),Fo=i(6e3),Eo=i(4605),To=i(5456),Io=i(2018),Ro=i(3536),Do=i(6852),zo=i(5584),jo=i(6007),Oo=i(4033),Go=i(3570),Bo=i(8796);i(1439),i(7585),i(5315);const No=new WeakMap;class qo extends V.Loader{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,o){const n=new V.FileLoader(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,(e=>{this.parse(e,t,o)}),i,o)}parse(e,t,i){this.decodeDracoFile(e,t,null,null,V.SRGBColorSpace).catch(i)}decodeDracoFile(e,t,i,o,n=V.LinearSRGBColorSpace){const l={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:o||this.defaultAttributeTypes,useUniqueIDs:!!i,vertexColorSpace:n};return this.decodeGeometry(e,l).then(t)}decodeGeometry(e,t){const i=JSON.stringify(t);if(No.has(e)){const t=No.get(e);if(t.key===i)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let o;const n=this.workerNextTaskID++,l=e.byteLength,a=this._getWorker(n,l).then((i=>(o=i,new Promise(((i,l)=>{o._callbacks[n]={resolve:i,reject:l},o.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))))).then((e=>this._createGeometry(e.geometry)));return a.catch((()=>!0)).then((()=>{o&&n&&this._releaseTask(o,n)})),No.set(e,{key:i,promise:a}),a}_createGeometry(e){const t=new V.BufferGeometry;e.index&&t.setIndex(new V.BufferAttribute(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const o=e.attributes[i],n=o.name,l=o.array,a=o.itemSize,s=new V.BufferAttribute(l,a);"color"===n&&(this._assignVertexColorSpace(s,o.vertexColorSpace),s.normalized=l instanceof Float32Array===!1),t.setAttribute(n,s)}return t}_assignVertexColorSpace(e,t){if(t!==V.SRGBColorSpace)return;const i=new V.Color;for(let o=0,n=e.count;o<n;o++)i.fromBufferAttribute(e,o).convertSRGBToLinear(),e.setXYZ(o,i.r,i.g,i.b)}_loadLibrary(e,t){const i=new V.FileLoader(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise(((t,o)=>{i.load(e,t,void 0,o)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!==typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((t=>{const i=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const o=Yo.toString(),n=["/* draco decoder */",i,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([n]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const i=t.data;switch(i.type){case"decode":e._callbacks[i.id].resolve(i);break;case"error":e._callbacks[i.id].reject(i);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+i.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}}function Yo(){let e,t;function i(e,t,i,l){const a=l.attributeIDs,s=l.attributeTypes;let r,d;const p=t.GetEncodedGeometryType(i);if(p===e.TRIANGULAR_MESH)r=new e.Mesh,d=t.DecodeArrayToMesh(i,i.byteLength,r);else{if(p!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");r=new e.PointCloud,d=t.DecodeArrayToPointCloud(i,i.byteLength,r)}if(!d.ok()||0===r.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+d.error_msg());const u={index:null,attributes:[]};for(const o in a){const i=self[s[o]];let d,p;if(l.useUniqueIDs)p=a[o],d=t.GetAttributeByUniqueId(r,p);else{if(p=t.GetAttributeId(r,e[a[o]]),-1===p)continue;d=t.GetAttribute(r,p)}const c=n(e,t,r,o,i,d);"color"===o&&(c.vertexColorSpace=l.vertexColorSpace),u.attributes.push(c)}return p===e.TRIANGULAR_MESH&&(u.index=o(e,t,r)),e.destroy(r),u}function o(e,t,i){const o=i.num_faces(),n=3*o,l=4*n,a=e._malloc(l);t.GetTrianglesUInt32Array(i,l,a);const s=new Uint32Array(e.HEAPF32.buffer,a,n).slice();return e._free(a),{array:s,itemSize:1}}function n(e,t,i,o,n,a){const s=a.num_components(),r=i.num_points(),d=r*s,p=d*n.BYTES_PER_ELEMENT,u=l(e,n),c=e._malloc(p);t.GetAttributeDataArrayForAllPoints(i,a,u,p,c);const m=new n(e.HEAPF32.buffer,c,d).slice();return e._free(c),{name:o,array:m,itemSize:s}}function l(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}onmessage=function(o){const n=o.data;switch(n.type){case"init":e=n.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":const o=n.buffer,l=n.taskConfig;t.then((e=>{const t=e.draco,a=new t.Decoder;try{const e=i(t,a,new Int8Array(o),l),s=e.attributes.map((e=>e.array.buffer));e.index&&s.push(e.index.array.buffer),self.postMessage({type:"decode",id:n.id,geometry:e},s)}catch(s){console.error(s),self.postMessage({type:"error",id:n.id,error:s.message})}finally{t.destroy(a)}}));break}}}const Zo=new V.Plane,Xo=new V.Raycaster,$o=new V.Vector2,Ko=new V.Vector3,Qo=new V.Vector3,Jo=new V.Vector3,en=new V.Matrix4;class tn extends V.EventDispatcher{constructor(e,t,i){super(),i.style.touchAction="none";let o=null,n=null;const l=[],a=this;function s(){i.addEventListener("pointermove",c),i.addEventListener("pointerdown",m),i.addEventListener("pointerup",h),i.addEventListener("pointerleave",h)}function r(){i.removeEventListener("pointermove",c),i.removeEventListener("pointerdown",m),i.removeEventListener("pointerup",h),i.removeEventListener("pointerleave",h),i.style.cursor=""}function d(){r()}function p(){return e}function u(){return Xo}function c(s){if(!1!==a.enabled){if(g(s),Xo.setFromCamera($o,t),o)return Xo.ray.intersectPlane(Zo,Qo)&&o.position.copy(Qo.sub(Ko).applyMatrix4(en)),void a.dispatchEvent({type:"drag",object:o});if("mouse"===s.pointerType||"pen"===s.pointerType)if(l.length=0,Xo.setFromCamera($o,t),Xo.intersectObjects(e,!0,l),l.length>0){const e=l[0].object;Zo.setFromNormalAndCoplanarPoint(t.getWorldDirection(Zo.normal),Jo.setFromMatrixPosition(e.matrixWorld)),n!==e&&null!==n&&(a.dispatchEvent({type:"hoveroff",object:n}),i.style.cursor="auto",n=null),n!==e&&(a.dispatchEvent({type:"hoveron",object:e}),i.style.cursor="pointer",n=e)}else null!==n&&(a.dispatchEvent({type:"hoveroff",object:n}),i.style.cursor="auto",n=null)}}function m(n){!1!==a.enabled&&(g(n),l.length=0,Xo.setFromCamera($o,t),Xo.intersectObjects(e,!0,l),l.length>0&&(o=!0===a.transformGroup?e[0]:l[0].object,Zo.setFromNormalAndCoplanarPoint(t.getWorldDirection(Zo.normal),Jo.setFromMatrixPosition(o.matrixWorld)),Xo.ray.intersectPlane(Zo,Qo)&&(en.copy(o.parent.matrixWorld).invert(),Ko.copy(Qo).sub(Jo.setFromMatrixPosition(o.matrixWorld))),i.style.cursor="move",a.dispatchEvent({type:"dragstart",object:o})))}function h(){!1!==a.enabled&&(o&&(a.dispatchEvent({type:"dragend",object:o}),o=null),i.style.cursor=n?"pointer":"auto")}function g(e){const t=i.getBoundingClientRect();$o.x=(e.clientX-t.left)/t.width*2-1,$o.y=-(e.clientY-t.top)/t.height*2+1}s(),this.enabled=!0,this.transformGroup=!1,this.activate=s,this.deactivate=r,this.dispose=d,this.getObjects=p,this.getRaycaster=u}}var on,nn=i(4239),ln={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2,e<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-ln.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*ln.Bounce.In(2*e):.5*ln.Bounce.Out(2*e-1)+.5}}};on="undefined"===typeof self&&"undefined"!==typeof process&&process.hrtime?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!==typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()};var an=on,sn=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map((function(t){return e._tweens[t]}))},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},e.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},e.prototype.update=function(e,t){void 0===e&&(e=an()),void 0===t&&(t=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;while(i.length>0){this._tweensAddedDuringUpdate={};for(var o=0;o<i.length;o++){var n=this._tweens[i[o]],l=!t;n&&!1===n.update(e,l)&&!t&&delete this._tweens[i[o]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),rn={Linear:function(e,t){var i=e.length-1,o=i*t,n=Math.floor(o),l=rn.Utils.Linear;return t<0?l(e[0],e[1],o):t>1?l(e[i],e[i-1],i-o):l(e[n],e[n+1>i?i:n+1],o-n)},Bezier:function(e,t){for(var i=0,o=e.length-1,n=Math.pow,l=rn.Utils.Bernstein,a=0;a<=o;a++)i+=n(1-t,o-a)*n(t,a)*e[a]*l(o,a);return i},CatmullRom:function(e,t){var i=e.length-1,o=i*t,n=Math.floor(o),l=rn.Utils.CatmullRom;return e[0]===e[i]?(t<0&&(n=Math.floor(o=i*(1+t))),l(e[(n-1+i)%i],e[n],e[(n+1)%i],e[(n+2)%i],o-n)):t<0?e[0]-(l(e[0],e[0],e[1],e[1],-o)-e[0]):t>1?e[i]-(l(e[i],e[i],e[i-1],e[i-1],o-i)-e[i]):l(e[n?n-1:0],e[n],e[i<n+1?i:n+1],e[i<n+2?i:n+2],o-n)},Utils:{Linear:function(e,t,i){return(t-e)*i+e},Bernstein:function(e,t){var i=rn.Utils.Factorial;return i(e)/i(t)/i(e-t)},Factorial:function(){var e=[1];return function(t){var i=1;if(e[t])return e[t];for(var o=t;o>1;o--)i*=o;return e[t]=i,i}}(),CatmullRom:function(e,t,i,o,n){var l=.5*(i-e),a=.5*(o-t),s=n*n,r=n*s;return(2*t-2*i+l+a)*r+(-3*t+3*i-2*l-a)*s+l*n+t}}},dn=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),pn=new sn,un=function(){function e(e,t){void 0===t&&(t=pn),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=ln.Linear.None,this._interpolationFunction=rn.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=dn.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.to=function(e,t){return this._valuesEnd=Object.create(e),void 0!==t&&(this._duration=t),this},e.prototype.duration=function(e){return this._duration=e,this},e.prototype.start=function(e){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var t in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(t),this._valuesStart[t]=this._valuesStartRepeat[t];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==e?"string"===typeof e?an()+parseFloat(e):e:an(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},e.prototype._setupProperties=function(e,t,i,o){for(var n in i){var l=e[n],a=Array.isArray(l),s=a?"array":typeof l,r=!a&&Array.isArray(i[n]);if("undefined"!==s&&"function"!==s){if(r){var d=i[n];if(0===d.length)continue;d=d.map(this._handleRelativeValue.bind(this,l)),i[n]=[l].concat(d)}if("object"!==s&&!a||!l||r)"undefined"===typeof t[n]&&(t[n]=l),a||(t[n]*=1),o[n]=r?i[n].slice().reverse():t[n]||0;else{for(var p in t[n]=a?[]:{},l)t[n][p]=l[p];o[n]=a?[]:{},this._setupProperties(l,t[n],i[n],o[n])}}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(e){return void 0===e&&(e=an()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},e.prototype.resume=function(e){return void 0===e&&(e=an()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},e.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},e.prototype.group=function(e){return this._group=e,this},e.prototype.delay=function(e){return this._delayTime=e,this},e.prototype.repeat=function(e){return this._initialRepeat=e,this._repeat=e,this},e.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},e.prototype.yoyo=function(e){return this._yoyo=e,this},e.prototype.easing=function(e){return this._easingFunction=e,this},e.prototype.interpolation=function(e){return this._interpolationFunction=e,this},e.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},e.prototype.onStart=function(e){return this._onStartCallback=e,this},e.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},e.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},e.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},e.prototype.onStop=function(e){return this._onStopCallback=e,this},e.prototype.update=function(e,t){if(void 0===e&&(e=an()),void 0===t&&(t=!0),this._isPaused)return!0;var i,o,n=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>n)return!1;t&&this.start(e)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),o=(e-this._startTime)/this._duration,o=0===this._duration||o>1?1:o;var l=this._easingFunction(o);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,l),this._onUpdateCallback&&this._onUpdateCallback(this._object,o),1===o){if(this._repeat>0){for(i in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!==typeof this._valuesEnd[i]||(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,s=this._chainedTweens.length;a<s;a++)this._chainedTweens[a].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(e,t,i,o){for(var n in i)if(void 0!==t[n]){var l=t[n]||0,a=i[n],s=Array.isArray(e[n]),r=Array.isArray(a),d=!s&&r;d?e[n]=this._interpolationFunction(a,o):"object"===typeof a&&a?this._updateProperties(e[n],l,a,o):(a=this._handleRelativeValue(l,a),"number"===typeof a&&(e[n]=l+(a-l)*o))}},e.prototype._handleRelativeValue=function(e,t){return"string"!==typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},e.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];this._valuesStartRepeat[e]="string"===typeof i?this._valuesStartRepeat[e]+parseFloat(i):this._valuesEnd[e],this._valuesEnd[e]=t},e}(),cn="18.6.4",mn=dn.nextId,hn=pn,gn=hn.getAll.bind(hn),_n=hn.removeAll.bind(hn),fn=hn.add.bind(hn),vn=hn.remove.bind(hn),wn=hn.update.bind(hn),yn={Easing:ln,Group:sn,Interpolation:rn,now:an,Sequence:dn,nextId:mn,Tween:un,VERSION:cn,getAll:gn,removeAll:_n,add:fn,remove:vn,update:wn},bn=yn;class Cn{constructor(e){this.container=document.querySelector(e),this.camera,this.scene,this.renderer,this.controls,this.model,this.loadingManager=new V.LoadingManager,this.fileLoaderMap={glb:new To.E,fbx:new Bo.y(this.loadingManager),gltf:new To.E,obj:new Go.L(this.loadingManager)},this.modelAnimation,this.animationMixer,this.animationColock=new V.Clock,this.animationFrame=null,this.rotationAnimationFrame=null,this.animateClipAction=null,this.loopMap={LoopOnce:V.LoopOnce,LoopRepeat:V.LoopRepeat,LoopPingPong:V.LoopPingPong},this.skeletonHelper,this.gridHelper,this.axesHelper,this.ambientLight,this.directionalLight,this.directionalLightHelper,this.pointLight,this.pointLightHelper,this.spotLight,this.spotLightHelper,this.planeGeometry,this.modelMaterialList,this.effectComposer,this.outlinePass,this.renderAnimation=null,this.raycaster=new V.Raycaster,this.mouse=new V.Vector2,this.modelTextureMap,this.glowComposer,this.unrealBloomPass,this.glowMaterialList,this.materials={},this.dragControls,this.glowUnrealBloomPass=!1,this.onWindowResizesListener,this.onMouseClickListener,this.onMouseDownListener,this.onMouseMoveListener,this.modelProgressCallback=e=>e}init(){return new Promise((async(e,t)=>{this.initRender(),this.initCamera(),this.initScene(),this.initControls(),this.createHelper(),this.createLight(),this.addEvenListMouseLisatener();const i=await this.setModel({filePath:"threeFile/glb/glb-9.glb",fileType:"glb",decomposeName:"transformers_3"});this.createEffectComposer(),this.sceneAnimation(),e(i)}))}initScene(){this.scene=new V.Scene;const e=(new V.TextureLoader).load(i(72));e.mapping=V.EquirectangularReflectionMapping,this.scene.background=e,this.scene.environment=e}initCamera(){const{clientHeight:e,clientWidth:t}=this.container;this.camera=new V.PerspectiveCamera(45,t/e,.25,1e3)}initRender(){this.renderer=new V.WebGLRenderer({antialias:!0,alpha:!0,preserveDrawingBuffer:!0}),this.renderer.setPixelRatio(window.devicePixelRatio);const{clientHeight:e,clientWidth:t}=this.container;this.renderer.setSize(t,e),this.renderer.toneMapping=V.ReinhardToneMapping,this.renderer.autoClear=!0,this.renderer.outputColorSpace=V.SRGBColorSpace,this.renderer.toneMappingExposure=3,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=V.PCFSoftShadowMap,this.container.appendChild(this.renderer.domElement)}sceneAnimation(){this.renderAnimation=requestAnimationFrame((()=>this.sceneAnimation())),this.scene.traverse((e=>{e instanceof V.Scene&&(this.materials.scene=e.background,e.background=null),!this.glowMaterialList.includes(e.name)&&e.isMesh&&(this.materials[e.uuid]=e.material,e.material=new V.MeshBasicMaterial({color:"black"}))})),this.glowComposer.render(),this.scene.traverse((e=>{this.materials[e.uuid]&&(e.material=this.materials[e.uuid],delete this.materials[e.uuid]),e instanceof V.Scene&&(e.background=this.materials.scene,delete this.materials.scene)})),this.controls.update(),bn.update(),this.effectComposer.render()}addEvenListMouseLisatener(){this.onWindowResizesListener=this.onWindowResizes.bind(this),window.addEventListener("resize",this.onWindowResizesListener),this.onMouseClickListener=this.onMouseClickModel.bind(this),this.container.addEventListener("click",this.onMouseClickListener)}initControls(){this.controls=new Eo.z(this.camera,this.renderer.domElement),this.controls.enablePan=!1}setModel({filePath:e,fileType:t,scale:i,map:o,position:n,decomposeName:l}){return new Promise(((a,s)=>{const r=this.fileLoaderMap[t];if(["glb","gltf"].includes(t)){const e=new qo;e.setDecoderPath("./threeFile/gltf/"),r.setDRACOLoader(e)}r.load(e,(e=>{switch(t){case"glb":this.model=e.scene,this.skeletonHelper=new V.SkeletonHelper(e.scene),this.modelAnimation=e.animations||[];break;case"fbx":this.model=e,this.skeletonHelper=new V.SkeletonHelper(e),this.modelAnimation=e.animations||[];break;case"gltf":this.model=e.scene,this.skeletonHelper=new V.SkeletonHelper(e.scene),this.modelAnimation=e.animations||[];break;case"obj":this.model=e,this.skeletonHelper=new V.SkeletonHelper(e),this.modelAnimation=e.animations||[];break;default:break}if(this.model.decomposeName=l,this.getModelMeaterialList(o),this.setModelPositionSize(),i&&this.model.scale.set(i,i,i),this.model.position.set(0,-.5,0),n){const{x:e,y:t,z:i}=n;this.model.position.set(e,t,i)}this.skeletonHelper.visible=!1,this.scene.add(this.skeletonHelper),this.glowMaterialList=this.modelMaterialList.map((e=>e.name)),this.scene.add(this.model),a(!0)}),(e=>{this.modelProgressCallback(e.loaded)}),(e=>{U.z8.error("文件错误"),console.log(e),s()}))}))}onProgress(e){"function"==typeof e&&(this.modelProgressCallback=e)}createHelper(){this.gridHelper=new V.GridHelper(4,10,"rgb(193,193,193)","rgb(193,193,193)"),this.gridHelper.position.set(0,-.59,-.1),this.gridHelper.visible=!1,this.scene.add(this.gridHelper),this.axesHelper=new V.AxesHelper(2),this.axesHelper.visible=!1,this.scene.add(this.axesHelper),this.renderer.shadowMap.enabled=!0}createLight(){this.ambientLight=new V.AmbientLight("#fff",.8),this.scene.add(this.ambientLight),this.directionalLight=new V.DirectionalLight("#1E90FF",1),this.directionalLight.position.set(-1.44,2.2,1),this.directionalLight.castShadow=!0,this.directionalLight.visible=!1,this.scene.add(this.directionalLight),this.directionalLightHelper=new V.DirectionalLightHelper(this.directionalLight,.5),this.directionalLightHelper.visible=!1,this.scene.add(this.directionalLightHelper),this.pointLight=new V.PointLight(16711680,1,100),this.pointLight.visible=!1,this.scene.add(this.pointLight),this.pointLightHelper=new V.PointLightHelper(this.pointLight,.5),this.pointLightHelper.visible=!1,this.scene.add(this.pointLightHelper),this.spotLight=new V.SpotLight("#323636",440),this.spotLight.visible=!1,this.spotLight.map=(new V.TextureLoader).load(i(8208)),this.spotLight.decay=2,this.spotLight.shadow.mapSize.width=1920,this.spotLight.shadow.mapSize.height=1080,this.spotLight.shadow.camera.near=1,this.spotLight.shadow.camera.far=10,this.scene.add(this.spotLight),this.spotLightHelper=new V.SpotLightHelper(this.spotLight),this.spotLightHelper.visible=!1,this.scene.add(this.spotLightHelper);const e=new V.PlaneGeometry(4,4);var t=new V.MeshStandardMaterial({color:"#939393"});this.planeGeometry=new V.Mesh(e,t),this.planeGeometry.name="planeGeometry",this.planeGeometry.rotation.x=-Math.PI/2,this.planeGeometry.position.set(0,-.5,0),this.planeGeometry.receiveShadow=!0,this.planeGeometry.visible=!1,this.scene.add(this.planeGeometry)}createEffectComposer(){const{clientHeight:e,clientWidth:t}=this.container;this.effectComposer=new Io.x(this.renderer);const i=new Ro.C(this.scene,this.camera);this.effectComposer.addPass(i),this.outlinePass=new Do.f(new V.Vector2(t,e),this.scene,this.camera),this.outlinePass.visibleEdgeColor=new V.Color("#FF8C00"),this.outlinePass.hiddenEdgeColor=new V.Color("#8a90f3"),this.outlinePass.edgeGlow=2,this.outlinePass.edgeThickness=1,this.outlinePass.edgeStrength=4,this.outlinePass.pulsePeriod=100,this.effectComposer.addPass(this.outlinePass);let o=new zo.T(jo.C);const n=this.renderer.getPixelRatio();o.uniforms.resolution.value.set(1/(t*n),1/(e*n)),o.renderToScreen=!0,o.needsSwap=!0,this.effectComposer.addPass(o),this.unrealBloomPass=new Oo.m(new V.Vector2(t,e),0,0,0),this.unrealBloomPass.threshold=0,this.unrealBloomPass.strength=0,this.unrealBloomPass.radius=0,this.unrealBloomPass.renderToScreen=!1,this.glowComposer=new Io.x(this.renderer),this.glowComposer.renderToScreen=!1,this.glowComposer.addPass(new Ro.C(this.scene,this.camera)),this.glowComposer.addPass(this.unrealBloomPass);let l=new zo.T(new V.ShaderMaterial({uniforms:{baseTexture:{value:null},bloomTexture:{value:this.glowComposer.renderTarget2.texture},tDiffuse:{value:null}},vertexShader:r.C7,fragmentShader:r.zH,defines:{}}),"baseTexture");l.renderToScreen=!0,l.needsSwap=!0,this.effectComposer.addPass(l)}onSwitchModel(e){return new Promise((async(t,i)=>{try{this.scene.traverse((e=>{"Mesh"===e.type&&(e.geometry.dispose(),e.material.dispose())})),cancelAnimationFrame(this.animationFrame),cancelAnimationFrame(this.rotationAnimationFrame),this.scene.remove(this.model),this.model=null,this.modelTextureMap=[],this.glowMaterialList=[],this.materials={},this.onResettingLight();const i=document.getElementById("mesh-txt");document.body.style.cursor="",i.style.display="none",this.dragControls&&this.dragControls.dispose(),this.renderer.toneMappingExposure=3,Object.assign(this.unrealBloomPass,{threshold:0,strength:0,radius:0}),this.skeletonHelper.visible=!1;const o={gridHelper:!1,x:0,y:-.59,z:-.1,positionX:0,positionY:-.5,positionZ:0,divisions:10,size:4,color:"rgb(193,193,193)",axesHelper:!1,axesSize:1.8};this.onSetModelGridHelper(o),this.onSetModelGridHelperSize(o),this.onSetModelAxesHelper(o);const n=await this.setModel(e);t({load:n,filePath:e.filePath})}catch{i()}}))}onWindowResizes(){if(!this.container)return!1;const{clientHeight:e,clientWidth:t}=this.container;this.camera.aspect=t/e,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,e),this.effectComposer.setSize(t,e),this.glowComposer.setSize(t,e)}onDownloadScenCover(){var e=document.createElement("a"),t=this.renderer.domElement;e.href=t.toDataURL("image/png"),e.download=`${(new Date).toLocaleString()}.png`,e.click()}onClearModelData(){cancelAnimationFrame(this.rotationAnimationFrame),cancelAnimationFrame(this.renderAnimation),cancelAnimationFrame(this.animationFrame),this.container.removeEventListener("click",this.onMouseClickListener),this.container.removeEventListener("mousedown",this.onMouseDownListener),this.container.removeEventListener("mousemove",this.onMouseMoveListener),window.removeEventListener("resize",this.onWindowResizesListener),this.scene.traverse((e=>{"Mesh"===e.type&&(e.geometry.dispose(),e.material.dispose())})),this.scene.clear(),this.renderer.dispose(),this.renderer.clear(),this.container=null,this.camera=null,this.scene=null,this.renderer=null,this.controls=null,this.model=null,this.fileLoaderMap=null,this.modelAnimation=null,this.animationMixer=null,this.animationColock=null,this.animationFrame=null,this.rotationAnimationFrame=null,this.animateClipAction=null,this.loopMap=null,this.skeletonHelper=null,this.gridHelper=null,this.axesHelper=null,this.ambientLight=null,this.directionalLight=null,this.directionalLightHelper=null,this.pointLight=null,this.pointLightHelper=null,this.spotLight=null,this.spotLightHelper=null,this.planeGeometry=null,this.modelMaterialList=null,this.effectComposer=null,this.outlinePass=null,this.renderAnimation=null,this.raycaster,this.mouse=null,this.modelTextureMap=null,this.glowComposer=null,this.unrealBloomPass=null,this.glowMaterialList=null,this.materials=null,this.dragControls=null,this.hoverMeshTag=null}onSetSceneColor(e){this.scene.background=new V.Color(e)}onSetSceneImage(e){this.scene.background=(new V.TextureLoader).load(e)}onSetSceneViewImage(e){const t=(new V.TextureLoader).load(e);t.mapping=V.EquirectangularReflectionMapping,this.scene.background=t,this.scene.environment=t}getModelMeaterialList(e){const t=!!e;this.modelMaterialList=[],this.modelTextureMap=[];let i=0;this.model.traverse((o=>{const{uuid:n}=o;if(o.isMesh){if(o.castShadow=!0,o.frustumCulled=!1,i++,o.material){const e=Array.isArray(o.material)?o.material:[o.material],{name:t,color:l,map:a}=o.material;o.material=new V.MeshStandardMaterial({map:a,transparent:!0,color:l,name:t}),this.modelMaterialList.push(o);const{url:s,mapId:r}=this.getModelMaps(e,n),d={meshName:o.name,material:o.material,url:s,mapId:r+"_"+i};o.mapId=r+"_"+i,this.modelTextureMap.push(d)}if(o.material&&t){const t=(new V.TextureLoader).load(e),{color:l,name:a}=o.material;o.material=new V.MeshStandardMaterial({map:t,name:a,transparent:!0,color:l}),o.mapId=n+"_"+i,this.modelTextureMap=[{meshName:o.name,material:o.material,url:e,mapId:n+"_"+i}]}}}))}setModelPositionSize(){this.model.updateMatrixWorld();const e=(new V.Box3).setFromObject(this.model),t=e.getSize(new V.Vector3),i=e.getCenter(new V.Vector3),o=Math.max(t.x,t.y,t.z),n=2.5,l=n/(o>1?o:.5);this.model.scale.set(l,l,l),this.controls.maxDistance=10*t.length(),this.camera.position.set(0,2,6),this.camera.lookAt(i),this.camera.updateProjectionMatrix()}getModelMaps(e,t){let i={};return e.forEach((e=>{if(e.map&&e.map.image){const t=document.createElement("canvas"),{width:o,height:n}=e.map.image;t.width=o,t.height=n;const l=t.getContext("2d");l.drawImage(e.map.image,0,0),i={url:t.toDataURL("image/png"),mapId:e.uuid}}})),i}onSetModelMaterial(e){const{color:t,wireframe:i,depthWrite:o,opacity:n}=e,l=nn.Z.state.selectMesh.uuid,a=this.scene.getObjectByProperty("uuid",l);a&&a.material&&(a.material.color.set(new V.Color(t)),a.material.wireframe=i,a.material.depthWrite=o,a.material.transparent=!0,a.material.opacity=n)}onSetModelMap({material:e,mapId:t,meshName:i}){const o=nn.Z.state.selectMesh.uuid,n=this.scene.getObjectByProperty("uuid",o),{name:l,color:a}=n.material;n.material=new V.MeshStandardMaterial({map:e.map,transparent:!0,color:a,name:l}),n.mapId=t,n.meshFrom=i}onSetSystemModelMap({id:e,url:t}){const i=nn.Z.state.selectMesh.uuid,o=this.scene.getObjectByProperty("uuid",i),{name:n,color:l}=o.material,a=(new V.TextureLoader).load(t);o.material=new V.MeshStandardMaterial({map:a,transparent:!0,color:l,name:n}),o.mapId=e,o.meshFrom=e}onChangeModelMeaterial(e){const t=this.model.getObjectByName(e);return this.outlinePass.selectedObjects=[t],nn.Z.commit("SELECT_MESH",t),t}onMouseDownModel(){const{clientHeight:e,clientWidth:t,offsetLeft:i,offsetTop:o}=this.container;this.mouse.x=(event.clientX-i)/t*2-1,this.mouse.y=-(event.clientY-o)/e*2+1,this.raycaster.setFromCamera(this.mouse,this.camera);const n=this.raycaster.intersectObjects(this.scene.children).filter((e=>e.object.isMesh));if(n.length>0){const e=n[0].object;this.outlinePass.selectedObjects=[e],nn.Z.commit("SELECT_MESH",e)}else this.outlinePass.selectedObjects=[],nn.Z.commit("SELECT_MESH",{})}onMouseClickModel(e){const{clientHeight:t,clientWidth:i,offsetLeft:o,offsetTop:n}=this.container;this.mouse.x=(e.clientX-o)/i*2-1,this.mouse.y=-(e.clientY-n)/t*2+1,this.raycaster.setFromCamera(this.mouse,this.camera);const l=this.raycaster.intersectObjects(this.scene.children).filter((e=>e.object.isMesh));if(l.length>0){const e=l[0].object;this.outlinePass.selectedObjects=[e],nn.Z.commit("SELECT_MESH",e)}else this.outlinePass.selectedObjects=[],nn.Z.commit("SELECT_MESH",{})}onGetEditMeshList(){const e=[];return this.model.traverse((t=>{if(t.isMesh&&t.material){const{color:i,opacity:o,depthWrite:n,wireframe:l}=t.material,a={meshName:t.name,meshFrom:t.meshFrom,color:i.getStyle(),opacity:o,depthWrite:n,wireframe:l,visible:t.visible,type:t.material.type};e.push(a)}})),e}onChangeModelMeshType(e){this.model.traverse((t=>{if(t.isMesh&&t.material){const{name:i,color:o,map:n,wireframe:l,depthWrite:a,opacity:s}=t.material;t.material=new V[e.type]({map:n,transparent:!0,color:o,name:i}),a&&(t.material.depthWrite=a),s&&(t.material.opacity=s),l&&(t.material.wireframe=l)}}))}onSetUnrealBloomPass(e){const{glow:t,threshold:i,strength:o,radius:n,toneMappingExposure:l}=e;this.glowUnrealBloomPass=t,t?(this.unrealBloomPass.threshold=i,this.unrealBloomPass.strength=o,this.unrealBloomPass.radius=n,this.renderer.toneMappingExposure=l):(this.unrealBloomPass.threshold=0,this.unrealBloomPass.strength=0,this.unrealBloomPass.radius=0,this.renderer.toneMappingExposure=l)}setModelMeshDecompose({decompose:e}){if(this.glowMaterialList.length<=1)return!1;const t=(e,t)=>{const i=new bn.Tween(e.position);i.to(t,500),i.onUpdate((function(t){e.position.set(t.x||0,t.y||0,t.z||0)})),i.start()},i=this.glowMaterialList.length,o=2*Math.PI/i;this.glowMaterialList.forEach(((i,n)=>{const l=this.model.getObjectByName(i),{decomposeName:a}=this.model;if("Mesh"==l.type)if(r.lY[a]&&r.lY[a][i]){const o={x:0,y:0,z:0},{x:n,y:s,z:d}=r.lY[a][i];"straight"==n?o.x+=e:"burden"==n&&(o.x-=e),"straight"==s?o.y+=e:"burden"==s&&(o.y-=e),"straight"==d?o.z+=e:"burden"==d&&(o.z-=e),t(l,o)}else{const i=n*o,a=e*Math.cos(i),s=e*Math.sin(i),r={x:a,y:s,z:0};t(l,r)}}))}setModelMeshDrag({modelDrag:e}){e?(this.dragControls=new tn(this.modelMaterialList,this.camera,this.renderer.domElement),this.dragControls.addEventListener("dragstart",(()=>{this.controls.enabled=!1})),this.dragControls.addEventListener("dragend",(()=>{this.controls.enabled=!0}))):this.dragControls&&this.dragControls.dispose()}setModelMeshTag({hoverMeshTag:e}){this.hoverMeshTag=e}onMouseMoveModel(e){if(this.modelAnimation.length)return!1;const{clientHeight:t,clientWidth:i,offsetLeft:o,offsetTop:n}=this.container;this.mouse.x=(e.clientX-o)/i*2-1,this.mouse.y=-(e.clientY-n)/t*2+1,this.raycaster.setFromCamera(this.mouse,this.camera);const l=this.raycaster.intersectObjects(this.scene.children).filter((e=>e.object.isMesh&&this.glowMaterialList.includes(e.object.name)));if(l.length>0){const t=document.getElementById("mesh-txt");if(this.modelAnimation.length)return document.body.style.cursor="pointer",!1;if(this.hoverMeshTag){const i=l[0].object;t.innerHTML=i.name,t.style.display="block",t.style.top=e.clientY-n+"px",t.style.left=e.clientX-o+20+"px"}document.body.style.cursor="pointer"}else{const e=document.getElementById("mesh-txt");document.body.style.cursor="",e.style.display="none"}}getMeshDragPosition(){const e=[];return this.modelMaterialList.forEach((t=>{const i=this.model.getObjectByProperty("name",t.name),o={name:t.name,...i.position};e.push(o)})),e}onSetModelAmbientLight({ambientLight:e,ambientLightColor:t,ambientLightIntensity:i}){this.ambientLight.visible=e,this.ambientLight.intensity=i,this.ambientLight.color.set(t)}onSetModelDirectionalLight(e){const{directionaShadow:t,directionalHorizontal:i,directionalVertical:o,directionalSistance:n,directionalLight:l,directionalLightColor:a,directionalLightIntensity:s,directionalLightHelper:r}=e;this.directionalLight.visible=l,this.directionalLightHelper.visible=r&&l,this.directionalLight.intensity=s,this.directionalLight.castShadow=t,this.directionalLight.color.set(a);const{x:d,y:p,z:u}=(0,mo.E3)(i,o,n);this.directionalLight.position.set(d,p,u),this.directionalLightHelper.update()}onSetModelPointLight(e){const{pointHorizontal:t,pointVertical:i,pointSistance:o,pointLight:n,pointLightColor:l,pointLightIntensity:a,pointLightHelper:s}=e;this.pointLight.visible=n,this.pointLightHelper.visible=n&&s,this.pointLight.intensity=a,this.pointLight.color.set(l);const{x:r,y:d,z:p}=(0,mo.E3)(t,i,o);this.pointLight.position.set(r,d,p),this.pointLightHelper.update()}onSetModelSpotLight(e){const{spotDistance:t,spotCastShadow:i,spotLightHelper:o,spotFocus:n,spotPenumbra:l,spotAngle:a,spotLight:s,spotLightColor:r,spotLightIntensity:d,spotHorizontal:p,spotVertical:u,spotSistance:c}=e;this.spotLight.visible=s,this.spotLightHelper.visible=s&&o,this.spotLight.intensity=d,this.spotLight.angle=a,this.spotLight.penumbra=l,this.spotLight.shadow.focus=n,this.spotLight.castShadow=i,this.spotLight.distance=t,this.spotLight.color.set(r);const{x:m,y:h,z:g}=(0,mo.E3)(p,u,c);this.spotLight.position.set(m,h,g),this.spotLightHelper.update()}onSetModelPlaneGeometry({planeGeometry:e,planeColor:t,planeWidth:i,planeHeight:o}){this.planeGeometry.visible=e,this.planeGeometry.geometry=new V.PlaneGeometry(i,o),this.planeGeometry.material.color.set(t),this.planeGeometry.geometry.verticesNeedUpdate=!0}onResettingLight(){const e={planeGeometry:!1,planeColor:"#939393",planeWidth:7,planeHeight:7,ambientLight:!0,ambientLightColor:"#fff",ambientLightIntensity:.8,directionalLight:!1,directionalLightHelper:!0,directionalLightColor:"#1E90FF",directionalLightIntensity:1,directionalHorizontal:-1.26,directionalVertical:-3.85,directionalSistance:2.98,directionaShadow:!0,pointLight:!1,pointLightHelper:!0,pointLightColor:"#1E90FF",pointLightIntensity:1,pointHorizontal:-4.21,pointVertical:-4.1,pointSistance:2.53,spotLight:!1,spotLightColor:"#323636",spotLightIntensity:400,spotHorizontal:-3.49,spotVertical:-4.37,spotSistance:4.09,spotAngle:.5,spotPenumbra:1,spotFocus:1,spotCastShadow:!0,spotLightHelper:!0,spotDistance:20};this.onSetModelAmbientLight(e),this.onSetModelDirectionalLight(e),this.onSetModelPointLight(e),this.onSetModelSpotLight(e),this.onSetModelPlaneGeometry(e)}onStartModelAnimaion(e){this.onSetModelAnimaion(e),cancelAnimationFrame(this.animationFrame),this.animationFrameFun()}onSetModelAnimaion({animationName:e,loop:t,timeScale:i,weight:o}){this.animationMixer=new V.AnimationMixer(this.model);const n=V.AnimationClip.findByName(this.modelAnimation,e);n&&(this.animateClipAction=this.animationMixer.clipAction(n),this.animateClipAction.setEffectiveTimeScale(i),this.animateClipAction.setEffectiveWeight(o),this.animateClipAction.setLoop(this.loopMap[t]),this.animateClipAction.play())}animationFrameFun(){this.animationFrame=requestAnimationFrame((()=>this.animationFrameFun())),this.animationMixer&&this.animationMixer.update(this.animationColock.getDelta())}onClearAnimation(){this.animateClipAction&&(this.animationMixer.stopAllAction(),this.animationMixer.update(0),cancelAnimationFrame(this.animationFrame))}onSetRotation(e){const{rotationVisible:t,rotationType:i,rotationSpeed:o}=e;t?(cancelAnimationFrame(this.rotationAnimationFrame),this.rotationAnimationFun(i,o)):(cancelAnimationFrame(this.rotationAnimationFrame),this.model.rotation.set(0,0,0))}onSetRotationType(e){const{rotationType:t,rotationSpeed:i}=e;this.model.rotation.set(0,0,0),cancelAnimationFrame(this.rotationAnimationFrame),this.rotationAnimationFun(t,i)}rotationAnimationFun(e,t){this.rotationAnimationFrame=requestAnimationFrame((()=>this.rotationAnimationFun(e,t))),this.model.rotation[e]+=t/50}onSetModelHelper(e){this.skeletonHelper.visible=e}onSetModelRotateOnAxis(e,t){const i=Math.PI/2,{x:o,y:n,z:l}=this.model.rotation,a={x:o,y:n,z:l};a[e]+=t?i:-i;const s=new bn.Tween({x:o,y:n,z:l});s.to(a,500),s.onUpdate((t=>{this.model.rotation[e]=t[e]})),s.start()}onResultModelRotateOnAxis(){this.model.rotation.x=0,this.model.rotation.y=0,this.model.rotation.z=0}onSetModelPosition({positionX:e,positionY:t,positionZ:i}){const o=new bn.Tween(this.model.position),n={x:e,y:t,z:i};o.to(n,500),o.onUpdate((e=>{this.model.position.set(e.x||0,e.y||0,e.z||0)})),o.start()}onResultModelPosition({positionX:e,positionY:t,positionZ:i}){this.model.position.set(e,t,i)}onResetModelCamera(){this.camera.position.set(0,2,6),this.camera.lookAt(0,0,0)}onGetModelCamera(){return this.camera.position}onSetModelGridHelper({x:e,y:t,z:i,gridHelper:o,color:n}){this.gridHelper.visible=o,this.gridHelper.material.color.set(n);const l=new bn.Tween(this.gridHelper.position),a={x:e,y:t,z:i};l.to(a,500),l.onUpdate((e=>{this.gridHelper.position.set(e.x||0,e.y||0,e.z||0)})),l.start()}onSetModelGridHelperSize({x:e,y:t,z:i,size:o,divisions:n,color:l,gridHelper:a}){this.scene.remove(this.gridHelper),this.gridHelper.geometry.dispose(),this.gridHelper.material.dispose(),this.gridHelper=new V.GridHelper(o,n,l,l),this.gridHelper.position.set(e,t,i),this.gridHelper.material.linewidth=.1,this.gridHelper.material.color.set(l),this.gridHelper.visible=a,this.scene.add(this.gridHelper)}onSetModelAxesHelper({axesHelper:e,axesSize:t}){this.scene.remove(this.axesHelper),this.axesHelper.geometry.dispose(),this.axesHelper.material.dispose(),this.axesHelper=new V.AxesHelper(t),this.axesHelper.position.set(0,-.5,0),this.axesHelper.visible=e,this.scene.add(this.axesHelper)}}var Ln=Cn;const kn=e=>((0,o.dD)("data-v-7d177981"),e=e(),(0,o.Cn)(),e),Wn={key:0,id:"loading-mark"},Mn={class:"loading-box"},xn={class:"loading"},Sn=["src"],An={class:"progress-txt"},Vn=kn((()=>(0,o._)("div",{class:"loading-txt"}," 模型文件首次加载时间较长请耐心等待..... ",-1)));var Un={__name:"PageLoading",props:{percentage:{type:Number,default:0},loading:{type:Boolean,default:!1}},setup(e){const t=e;return(e,n)=>t.loading?((0,o.wg)(),(0,o.iD)("div",Wn,[(0,o._)("div",Mn,[(0,o._)("div",xn,[(0,o._)("img",{src:i(7622)},null,8,Sn),(0,o._)("div",An,[(0,o.Uk)(" 当前模型已加载 "),(0,o._)("b",null,(0,l.zw)(t.percentage),1),(0,o.Uk)(" M ")]),Vn])])])):(0,o.kq)("",!0)}};const Hn=(0,x.Z)(Un,[["__scopeId","data-v-7d177981"]]);var Pn=Hn;const Fn=e=>((0,o.dD)("data-v-226b57e1"),e=e(),(0,o.Cn)(),e),En={class:"model-page"},Tn={class:"model-header"},In=Fn((()=>(0,o._)("div",{class:"header-lf"},[(0,o._)("span",null," 基于Three.js+Vue3+Element-Plus开发的3d模型可视化编辑系统 "),(0,o._)("span",null,"作者:answer")],-1))),Rn={class:"header-lr"},Dn={class:"model-container"},zn={id:"model",ref:"model"},jn={class:"camera-icon"},On=Fn((()=>(0,o._)("div",{id:"mesh-txt"},null,-1))),Gn={class:"edit-panel",style:{minWidth:"380px"}};var Bn={__name:"index",setup(e){const t=(0,s.oR)(),i=(0,Po.tv)(),{$bus:l,$local:a}=(0,o.FN)().proxy,p=(0,n.qj)({modelApi:(0,o.Fl)((()=>t.state.modelApi))}),u=(0,n.iH)(!1),c=(0,n.iH)(0),m=(0,n.iH)(null),h=(0,n.iH)(null),g=()=>{p.modelApi.onResetModelCamera()},_=()=>{const e=a.get(r.Aw);if(!Array.isArray(e)){let e=[];d.H1.forEach((t=>{e.push({...r.f1,fileInfo:{...t}})})),a.set(r.Aw,e)}},f=()=>{const e=m.value.getPanelConfig();if(e.camera=p.modelApi.onGetModelCamera(),e.fileInfo=h.value.activeModel,e.fileInfo.filePath){a.set(r.AQ,e);const{href:t}=i.resolve({path:"/preview"});window.open(t,"_blank")}else U.z8.warning("外部模型不支持“效果预览”")},v=()=>{Fo.T.confirm(" 确认要更新当前模型数据至“模板库”?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"success"}).then((()=>{const e=m.value.getPanelConfig();if(e.camera=p.modelApi.onGetModelCamera(),e.fileInfo=h.value.activeModel,e.fileInfo.filePath){const t=a.get(r.Aw)||[],{id:i}=e.fileInfo;Object.assign(t.filter((e=>i===e.fileInfo.id))[0],e),a.set(r.Aw,t),U.z8.success("更新成功")}else U.z8.warning("外部模型不支持“数据保存”")})).catch((()=>{}))},w=()=>{p.modelApi.onDownloadScenCover()};return(0,o.bv)((async()=>{u.value=!0;const e=new Ln("#model");t.commit("SET_MODEL_API",e),l.on("page-loading",(e=>{u.value=e})),p.modelApi.onProgress((e=>{c.value=Number((e/1024/1024).toFixed(2))}));const i=await e.init();i&&(u.value=!1,c.value=0),_()})),(0,o.Jd)((()=>{p.modelApi.onClearModelData()})),(e,t)=>{const i=(0,o.up)("el-button"),l=(0,o.up)("Aim"),a=(0,o.up)("el-icon"),s=(0,o.up)("el-tooltip");return(0,o.wg)(),(0,o.iD)("div",En,[(0,o._)("header",Tn,[In,(0,o._)("div",Rn,[(0,o.Wm)(i,{type:"primary",icon:"Film",onClick:t[0]||(t[0]=t=>e.$router.push({path:"/modelBase"}))},{default:(0,o.w5)((()=>[(0,o.Uk)(" 模型库 ")])),_:1}),(0,o.Wm)(i,{type:"primary",icon:"Document",onClick:v},{default:(0,o.w5)((()=>[(0,o.Uk)("保存数据")])),_:1}),(0,o.Wm)(i,{type:"primary",icon:"Download",onClick:w},{default:(0,o.w5)((()=>[(0,o.Uk)("下载封面")])),_:1}),(0,o.Wm)(i,{type:"primary",icon:"View",onClick:f},{default:(0,o.w5)((()=>[(0,o.Uk)("效果预览")])),_:1})])]),(0,o._)("div",Dn,[(0,o.Wm)((0,n.SU)(Ho),{ref_key:"choosePanel",ref:h},null,512),(0,o._)("div",zn,[(0,o._)("div",jn,[(0,o.Wm)(s,{effect:"dark",content:"居中",placement:"top"},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{size:18,color:"#fff",onClick:g},{default:(0,o.w5)((()=>[(0,o.Wm)(l)])),_:1})])),_:1})]),On],512),(0,o._)("div",Gn,[p.modelApi.model?((0,o.wg)(),(0,o.j4)((0,n.SU)(co),{key:0,ref_key:"editPanel",ref:m},null,512)):(0,o.kq)("",!0)])]),(0,o.Wm)((0,n.SU)(Pn),{loading:u.value,percentage:c.value},null,8,["loading","percentage"])])}}};const Nn=(0,x.Z)(Bn,[["__scopeId","data-v-226b57e1"]]);var qn=Nn}}]);
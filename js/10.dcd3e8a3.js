"use strict";(self["webpackChunkts_project"]=self["webpackChunkts_project"]||[]).push([[10],{10:function(e,t,i){i.r(t),i.d(t,{default:function(){return ra}});i(560);var n=i(6252),o=i(2262),s=i(9963),a=(i(8858),i(1318),i(3228),i(3577)),l=i(9993),r=i(3907),d=i(5294);const c={class:"model-choose"},u=(0,n._)("div",{class:"header"},[(0,n._)("span",null,"模型列表")],-1),p={class:"options"},h={class:"option"},m=(0,n._)("span",null,"普通模型",-1),g={class:"options"},f={class:"option"},_=(0,n._)("span",null,"动画模型",-1),y={class:"options"},w={class:"option"},v=(0,n._)("span",null,"几何体模型",-1),b={key:0,style:{color:"#18c174 "}},x=["onDragstart"],M={class:"geometry-name"},C={key:1,class:"geometry-box"},L={class:"icon"},k=(0,n._)("div",null,[(0,n._)("span",null,"添加几何体模型")],-1),A={class:"options"},S={class:"option"},T=(0,n._)("span",null,"外部模型",-1),W={class:"file-name"},I=(0,n._)("span",null,"当前模型:",-1),U={class:"upload"},E={class:"icon"},R=(0,n._)("div",null,[(0,n._)("span",null,"请选择(目前仅支持.glb, .obj, .gltf, .fbx格式)")],-1);var V=(0,n.aZ)({__name:"index",setup(e,{expose:t}){const V=(0,r.oR)(),{$bus:P}=(0,n.FN)().proxy,F=(0,o.qj)({modelApi:(0,n.Fl)((()=>V.state.modelApi))}),H=(0,n.Fl)((()=>l.H1.filter((e=>!e.animation)))),D=(0,n.Fl)((()=>l.H1.filter((e=>e.animation)))),z=(0,o.iH)(9),N=(0,o.iH)(!1),O=(0,o.iH)({name:"变形金刚（3）",fileType:"glb",id:9,animation:!1,filePath:"threeFile/glb/glb-9.glb",icon:i(8817),decomposeName:"transformers_3",key:"transformers-3"}),j=(0,o.iH)(null),G=async e=>{if(e.id==z.value)return!1;N.value=!1,z.value=e.id,j.value=null,O.value=e,P.emit("page-loading",!0);try{const{load:t}=await F.modelApi.onSwitchModel(e);t&&(P.emit("model-update"),P.emit("page-loading",!1))}catch(t){P.emit("page-loading",!1)}},B=async()=>{N.value=!0,j.value=null,z.value=null,O.value={},F.modelApi.clearSceneModel()},Z=(e,t)=>{F.modelApi.setDragGeometryModel(t)},Y=e=>{e.preventDefault()},q=async e=>{j.value=e.name;const t=URL.createObjectURL(e.raw),i={filePath:t,fileType:(0,d.JB)(e.name)};P.emit("page-loading",!0);try{const{load:e,filePath:t}=await F.modelApi.onSwitchModel(i);URL.revokeObjectURL(t),e&&(P.emit("model-update"),P.emit("page-loading",!1),z.value=null,N.value=!1,O.value={})}catch(n){j.value=null,P.emit("page-loading",!1)}};return t({activeModel:O}),(e,t)=>{const i=(0,n.up)("Orange"),r=(0,n.up)("el-icon"),d=(0,n.up)("el-space"),V=(0,n.up)("el-image"),P=(0,n.up)("el-col"),F=(0,n.up)("el-row"),O=(0,n.up)("el-scrollbar"),X=(0,n.up)("Paperclip"),K=(0,n.up)("SwitchFilled"),$=(0,n.up)("el-tooltip"),J=(0,n.up)("Plus"),Q=(0,n.up)("UploadFilled"),ee=(0,n.up)("el-upload");return(0,n.wg)(),(0,n.iD)("div",c,[u,(0,n._)("div",p,[(0,n._)("div",h,[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(i)])),_:1}),m])),_:1})]),(0,n.Wm)(O,{"max-height":"210px"},{default:(0,n.w5)((()=>[(0,n.Wm)(F,null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(H.value,(e=>((0,n.wg)(),(0,n.j4)(P,{style:{textAlign:"center"},span:12,key:e.id},{default:(0,n.w5)((()=>[(0,n.Wm)(V,{draggable:"false",onClick:(0,s.iM)((t=>G(e)),["prevent"]),class:(0,a.C_)(["el-img",z.value==e.id?"active-model":""]),src:e.icon,fit:"cover"},null,8,["onClick","class","src"])])),_:2},1024)))),128))])),_:1})])),_:1})]),(0,n._)("div",g,[(0,n._)("div",f,[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(X)])),_:1}),_])),_:1})]),(0,n.Wm)(O,{"max-height":"210px"},{default:(0,n.w5)((()=>[(0,n.Wm)(F,null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(D.value,(e=>((0,n.wg)(),(0,n.j4)(P,{style:{textAlign:"center"},span:12,key:e.id},{default:(0,n.w5)((()=>[(0,n.Wm)(V,{draggable:"false",onClick:t=>G(e),class:(0,a.C_)(["el-img",z.value==e.id?"active-model":""]),src:e.icon,fit:"cover"},null,8,["onClick","class","src"])])),_:2},1024)))),128))])),_:1})])),_:1})]),(0,n._)("div",y,[(0,n._)("div",w,[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(K)])),_:1}),v,N.value?((0,n.wg)(),(0,n.iD)("span",b,"(可拖拽添加多个)")):(0,n.kq)("",!0)])),_:1})]),(0,n.Wm)(O,{"max-height":"120px"},{default:(0,n.w5)((()=>[N.value?((0,n.wg)(),(0,n.j4)(F,{key:0},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,o.SU)(l.vF),(e=>((0,n.wg)(),(0,n.j4)(P,{style:{textAlign:"center"},span:8,key:e.type},{default:(0,n.w5)((()=>[(0,n._)("div",{class:(0,a.C_)(["geometry",z.value==e.id?"active-model":""]),draggable:"true",onDragstart:t=>Z(t,e),onDrag:t[0]||(t[0]=e=>Y(e))},[(0,n._)("div",M,[(0,n.Wm)($,{effect:"dark",content:`${e.name}:${e.type}`,placement:"top"},{default:(0,n.w5)((()=>[(0,n._)("b",null,(0,a.zw)(e.name),1)])),_:2},1032,["content"])])],42,x)])),_:2},1024)))),128))])),_:1})):((0,n.wg)(),(0,n.iD)("div",C,[(0,n._)("div",{class:"geometry-add",onClick:B},[(0,n._)("div",L,[(0,n.Wm)(r,{size:44},{default:(0,n.w5)((()=>[(0,n.Wm)(J)])),_:1}),k])])]))])),_:1})]),(0,n._)("div",A,[(0,n._)("div",S,[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(Q)])),_:1}),T])),_:1})]),(0,n._)("div",W,[I,(0,n.Wm)($,{effect:"dark",content:j.value,placement:"top"},{default:(0,n.w5)((()=>[(0,n._)("b",null,(0,a.zw)(j.value),1)])),_:1},8,["content"])]),(0,n.Wm)(ee,{action:"",accept:".glb,.obj,.gltf,.fbx",class:"file-box","show-file-list":!1,"auto-upload":!1,"on-change":q},{default:(0,n.w5)((()=>[(0,n._)("div",U,[(0,n._)("div",E,[(0,n.Wm)(r,{size:44},{default:(0,n.w5)((()=>[(0,n.Wm)(J)])),_:1}),R])])])),_:1})])])}}});const P=V;var F=P,H=i(3623);const D=e=>((0,n.dD)("data-v-b8e051cc"),e=e(),(0,n.Cn)(),e),z={class:"edit-box"},N={class:"header"},O=D((()=>(0,n._)("span",null,"背景",-1))),j={class:"icon-name"},G=D((()=>(0,n._)("span",null," 图片",-1))),B={class:"action-txt"},Z={class:"check"},Y={class:"icon-name"},q=D((()=>(0,n._)("span",null," 颜色",-1))),X={class:"action"},K={class:"check"},$={class:"icon-name"},J=D((()=>(0,n._)("span",null," 全景图",-1))),Q={class:"action-txt"},ee={class:"check"};var te=(0,n.aZ)({__name:"EditBackground",setup(e,{expose:t}){const d=(0,r.oR)(),c=(0,o.qj)({visible:!0,type:3,image:i(3405),viewImg:i(72),color:"#000"}),u=(0,o.iH)(3),p=(0,o.iH)(3),h=(0,o.qj)({modelApi:(0,n.Fl)((()=>d.state.modelApi))}),m=(0,n.Fl)((()=>{const{visible:e}=c;return e?"":"disabled"})),g=H.UL,f=e=>{switch(c.type=e,e){case 1:h.modelApi.onSetSceneColor(c.color);break;case 2:h.modelApi.onSetSceneImage(c.image);break;case 3:h.modelApi.onSetSceneViewImage(c.viewImg);break;default:break}},_=e=>{const{id:t,url:i}=e;c.image=i,u.value=t,h.modelApi.onSetSceneImage(i)},y=e=>{const{id:t,url:i}=e;c.viewImg=i,p.value=t,h.modelApi.onSetSceneViewImage(i)},w=e=>{c.color=e,h.modelApi.onSetSceneColor(c.color)},v=()=>{h.modelApi.onSetSceneColor(c.color)},b=()=>{const{type:e,visible:t,image:i,viewImg:n}=c;if(!t)return h.modelApi.onSetSceneColor("#000");switch(e){case 1:h.modelApi.onSetSceneColor(c.color);break;case 2:h.modelApi.onSetSceneImage(i);break;case 3:h.modelApi.onSetSceneViewImage(n);break;default:break}};return t({config:c}),(e,t)=>{const i=(0,n.up)("el-switch"),r=(0,n.up)("Picture"),d=(0,n.up)("el-icon"),h=(0,n.up)("el-space"),x=(0,n.up)("el-button"),M=(0,n.up)("Check"),C=(0,n.up)("el-image"),L=(0,n.up)("el-col"),k=(0,n.up)("el-row"),A=(0,n.up)("el-scrollbar"),S=(0,n.up)("DataAnalysis"),T=(0,n.up)("el-color-picker"),W=(0,n.up)("CameraFilled");return(0,n.wg)(),(0,n.iD)("div",z,[(0,n._)("div",N,[O,(0,n.Wm)(i,{modelValue:c.visible,"onUpdate:modelValue":t[0]||(t[0]=e=>c.visible=e),onChange:b},null,8,["modelValue"])]),(0,n._)("div",{class:(0,a.C_)(["options",m.value])},[(0,n._)("div",{class:"option",onClick:t[1]||(t[1]=e=>f(2))},[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n._)("div",j,[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(r)])),_:1}),G])),_:1})]),(0,n._)("div",B,[(0,n.Wm)(x,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("选择图片")])),_:1})]),(0,n.wy)((0,n._)("div",Z,[(0,n.Wm)(d,{size:"20px",color:"#2a3ff6"},{default:(0,n.w5)((()=>[(0,n.Wm)(M)])),_:1})],512),[[s.F8,2==c.type]])])),_:1})]),(0,n.wy)((0,n.Wm)(A,{"max-height":"250px"},{default:(0,n.w5)((()=>[(0,n.Wm)(k,null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,o.SU)(l.L8),(e=>((0,n.wg)(),(0,n.j4)(L,{style:{textAlign:"center"},span:6,key:e.id},{default:(0,n.w5)((()=>[(0,n.Wm)(C,{onClick:t=>_(e),class:(0,a.C_)(["el-img",u.value==e.id?"active":""]),src:e.url,fit:"cover"},null,8,["onClick","class","src"])])),_:2},1024)))),128))])),_:1})])),_:1},512),[[s.F8,2==c.type]])],2),(0,n._)("div",{class:(0,a.C_)(["options",m.value])},[(0,n._)("div",{class:"option",onClick:t[3]||(t[3]=e=>f(1))},[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n._)("div",Y,[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(S)])),_:1}),q])),_:1})]),(0,n._)("div",X,[(0,n.Wm)(T,{predefine:(0,o.SU)(g),onChange:v,onActiveChange:w,modelValue:c.color,"onUpdate:modelValue":t[2]||(t[2]=e=>c.color=e)},null,8,["predefine","modelValue"])]),(0,n.wy)((0,n._)("div",K,[(0,n.Wm)(d,{size:"20px",color:"#2a3ff6"},{default:(0,n.w5)((()=>[(0,n.Wm)(M)])),_:1})],512),[[s.F8,1==c.type]])])),_:1})])],2),(0,n._)("div",{class:(0,a.C_)(["options",m.value])},[(0,n._)("div",{class:"option",onClick:t[4]||(t[4]=e=>f(3))},[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n._)("div",$,[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(W)])),_:1}),J])),_:1})]),(0,n._)("div",Q,[(0,n.Wm)(x,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("选择图片")])),_:1})]),(0,n.wy)((0,n._)("div",ee,[(0,n.Wm)(d,{size:"20px",color:"#2a3ff6"},{default:(0,n.w5)((()=>[(0,n.Wm)(M)])),_:1})],512),[[s.F8,3==c.type]])])),_:1})]),(0,n.wy)((0,n.Wm)(A,{"max-height":"350px"},{default:(0,n.w5)((()=>[(0,n.Wm)(k,null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,o.SU)(l.Wf),(e=>((0,n.wg)(),(0,n.j4)(L,{span:6,style:{textAlign:"center"},key:e.id},{default:(0,n.w5)((()=>[(0,n.Wm)(C,{onClick:t=>y(e),class:(0,a.C_)(["el-view",p.value==e.id?"active":""]),src:e.url,fit:"cover"},null,8,["onClick","class","src"])])),_:2},1024)))),128))])),_:1})])),_:1},512),[[s.F8,3==c.type]])],2)])}}}),ie=i(3744);const ne=(0,ie.Z)(te,[["__scopeId","data-v-b8e051cc"]]);var oe=ne,se=i(9477),ae=i(1348);const le=e=>((0,n.dD)("data-v-5ce4aada"),e=e(),(0,n.Cn)(),e),re={class:"edit-box"},de=le((()=>(0,n._)("div",{class:"header"},[(0,n._)("span",null,"材质类型")],-1))),ce={class:"options"},ue={class:"option"},pe=le((()=>(0,n._)("span",null,"当前材质类型：",-1))),he=le((()=>(0,n._)("div",{class:"header"},[(0,n._)("span",null,"材质")],-1))),me={class:"options"},ge=["onClick"],fe={class:"icon-name"},_e={class:"check"},ye=le((()=>(0,n._)("div",{class:"header"},"材质属性",-1))),we={class:"option space-between"},ve={class:"option"},be={class:"grid-txt"},xe={class:"grid-silder"},Me=le((()=>(0,n._)("div",{class:"header"},"模型自带贴图",-1))),Ce=["onClick"],Le={key:0,class:"select"},ke=le((()=>(0,n._)("div",{class:"not-load"},"当前模型材质数量过大,暂不支持贴图加载",-1))),Ae=le((()=>(0,n._)("div",{class:"header"},"系统贴图",-1))),Se=["onClick"],Te={key:0,class:"select"};var We=(0,n.aZ)({__name:"EditMaterial",setup(e,{expose:t}){const i=(0,r.oR)(),{$bus:d}=(0,n.FN)().proxy,c=(0,o.qj)({meaterialName:null,color:"#fff",wireframe:!1,depthWrite:!0,opacity:1}),u=(0,o.iH)(null),p=((0,o.qj)({type:"MeshBasicMaterial",describe:"标准网格材质",color:!0,wireframe:!0,depthWrite:!0,opacity:!0}),(0,o.iH)(null)),h=(0,n.Fl)((()=>{const e=m.modelMaterialList.find((e=>e.uuid==m.selectMeshUuid))||{};return e.uuid?"":"disabled"})),m=(0,o.qj)({modelMaterialList:(0,n.Fl)((()=>i.state.modelApi.modelMaterialList)),modelApi:(0,n.Fl)((()=>i.state.modelApi)),selectMeshUuid:(0,n.Fl)((()=>i.getters.selectMeshUuid)),modelTextureMap:(0,n.Fl)((()=>i.state.modelApi.modelTextureMap))});(0,n.bv)((()=>{d.on("model-update",(()=>{Object.assign(c,{color:null,wireframe:!1,depthWrite:!0,opacity:1})}))})),(0,n.YP)((()=>i.getters.selectMeshUuid),(e=>{const t=m.modelMaterialList.find((t=>t.uuid==e))||{};if(p.value=t.mapId,t.mapId){const{color:e,wireframe:i,depthWrite:n,opacity:o}=t.material;Object.assign(c,{color:new se.Color(e).getStyle(),wireframe:i,depthWrite:n,opacity:o})}}));const g=e=>{const t=H.HG.find((t=>t.type==e));m.modelApi.onChangeModelMeshType(t)},f=e=>{const{name:t,material:i}=e;c.meaterialName=i.name;const n=m.modelApi.onChangeModelMeaterial(t),{color:o,wireframe:s,depthWrite:a,opacity:l}=n.material;Object.assign(c,{color:new se.Color(o).getStyle(),wireframe:s,depthWrite:a,opacity:l})},_=e=>{c.color=e,m.modelApi.onSetModelMaterial(c)},y=()=>{m.modelApi.onSetModelMaterial(c)},w=e=>{e.visible=!e.visible},v=e=>{p.value=e.mapId,m.modelApi.onSetModelMap(e),Object.assign(c,{color:null,wireframe:!1,depthWrite:!0,opacity:1}),ae.z8.success("当前材质贴图修改成功")},b=e=>{p.value=e.id,m.modelApi.onSetSystemModelMap(e),Object.assign(c,{color:null,wireframe:!1,depthWrite:!0,opacity:1}),ae.z8.success("当前材质贴图修改成功")},x=()=>({materialType:u.value,meshList:m.modelApi.onGetEditMeshList()});return t({getMeshConfig:x}),(e,t)=>{const i=(0,n.up)("el-option"),r=(0,n.up)("el-select"),d=(0,n.up)("el-space"),x=(0,n.up)("View"),M=(0,n.up)("el-icon"),C=(0,n.up)("Hide"),L=(0,n.up)("Check"),k=(0,n.up)("el-scrollbar"),A=(0,n.up)("el-button"),S=(0,n.up)("el-color-picker"),T=(0,n.up)("WarnTriangleFilled"),W=(0,n.up)("el-tooltip"),I=(0,n.up)("el-switch"),U=(0,n.up)("el-slider"),E=(0,n.up)("el-image"),R=(0,n.up)("Select"),V=(0,n.up)("el-col"),P=(0,n.up)("el-row");return(0,n.wg)(),(0,n.iD)("div",re,[de,(0,n._)("div",ce,[(0,n._)("div",ue,[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[pe,(0,n.Wm)(r,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),onChange:g,placeholder:"请选择",size:"small"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,o.SU)(H.HG),(e=>((0,n.wg)(),(0,n.j4)(i,{key:e.type,label:`${e.type}(${e.describe})`,value:e.type},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])]),he,(0,n._)("div",me,[(0,n.Wm)(k,{"max-height":"200px"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(m.modelMaterialList,(e=>((0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(["option",m.selectMeshUuid==e.uuid?"option-active":""]),onClick:t=>f(e),key:e.uuid},[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[e.visible?((0,n.wg)(),(0,n.j4)(M,{key:0,onClick:t=>w(e),size:"18",color:"#409eff"},{default:(0,n.w5)((()=>[(0,n.Wm)(x)])),_:2},1032,["onClick"])):((0,n.wg)(),(0,n.j4)(M,{key:1,size:"18",onClick:t=>w(e)},{default:(0,n.w5)((()=>[(0,n.Wm)(C)])),_:2},1032,["onClick"])),(0,n._)("div",fe,(0,a.zw)(e.name),1),(0,n.wy)((0,n._)("div",_e,[(0,n.Wm)(M,{size:"20px",color:"#2a3ff6"},{default:(0,n.w5)((()=>[(0,n.Wm)(L)])),_:1})],512),[[s.F8,m.selectMeshUuid==e.uuid]])])),_:2},1024)],10,ge)))),128))])),_:1})]),ye,(0,n._)("div",{class:(0,a.C_)(["options",h.value])},[(0,n._)("div",we,[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("材质颜色")])),_:1}),(0,n.Wm)(S,{"color-format":"hex",predefine:(0,o.SU)(H.UL),onChange:y,onActiveChange:_,modelValue:c.color,"onUpdate:modelValue":t[1]||(t[1]=e=>c.color=e)},null,8,["predefine","modelValue"])])),_:1}),(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(W,{effect:"dark",content:"注意：深度写入属性不支持模型“导出” ",placement:"top"},{default:(0,n.w5)((()=>[(0,n.Wm)(M,null,{default:(0,n.w5)((()=>[(0,n.Wm)(T,{size:20,color:"#ffb940"})])),_:1})])),_:1}),(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("深度写入")])),_:1}),(0,n.Wm)(I,{onChange:y,modelValue:c.depthWrite,"onUpdate:modelValue":t[2]||(t[2]=e=>c.depthWrite=e)},null,8,["modelValue"])])),_:1}),(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(W,{effect:"dark",content:"注意：网格属性不支持模型“导出” ",placement:"top"},{default:(0,n.w5)((()=>[(0,n.Wm)(M,null,{default:(0,n.w5)((()=>[(0,n.Wm)(T,{size:20,color:"#ffb940"})])),_:1})])),_:1}),(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("网格")])),_:1}),(0,n.Wm)(I,{onChange:y,modelValue:c.wireframe,"onUpdate:modelValue":t[3]||(t[3]=e=>c.wireframe=e)},null,8,["modelValue"])])),_:1})]),(0,n._)("div",ve,[(0,n._)("div",be,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("透明度 ")])),_:1})]),(0,n._)("div",xe,[(0,n.Wm)(U,{"show-input":"",onInput:y,modelValue:c.opacity,"onUpdate:modelValue":t[4]||(t[4]=e=>c.opacity=e),min:0,max:1,step:.01},null,8,["modelValue"])])])],2),Me,(0,n._)("div",{class:(0,a.C_)(["options",h.value])},[(0,n.Wm)(k,{"max-height":"100px"},{default:(0,n.w5)((()=>[m.modelTextureMap?((0,n.wg)(),(0,n.j4)(P,{key:0},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(m.modelTextureMap,(e=>((0,n.wg)(),(0,n.j4)(V,{span:6,style:{textAlign:"center"},key:e.mapId},{default:(0,n.w5)((()=>[(0,n._)("div",{onClick:t=>v(e),class:(0,a.C_)(["image-box",p.value==e.mapId?"active":""])},[(0,n.Wm)(E,{src:e.url,class:"el-map",fit:"cover"},null,8,["src"]),p.value==e.mapId?((0,n.wg)(),(0,n.iD)("div",Le,[(0,n.Wm)(M,{color:"#18c174",size:26},{default:(0,n.w5)((()=>[(0,n.Wm)(R)])),_:1})])):(0,n.kq)("",!0)],10,Ce)])),_:2},1024)))),128))])),_:1})):((0,n.wg)(),(0,n.j4)(P,{key:1,justify:"center"},{default:(0,n.w5)((()=>[(0,n.Wm)(V,null,{default:(0,n.w5)((()=>[ke])),_:1})])),_:1}))])),_:1})],2),Ae,(0,n._)("div",{class:(0,a.C_)(["options",h.value])},[(0,n.Wm)(k,{"max-height":"230px"},{default:(0,n.w5)((()=>[(0,n.Wm)(P,null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,o.SU)(l.or),(e=>((0,n.wg)(),(0,n.j4)(V,{span:6,style:{textAlign:"center"},key:e.id},{default:(0,n.w5)((()=>[(0,n._)("div",{onClick:t=>b(e),class:(0,a.C_)(["image-box",p.value==e.id?"active":""])},[(0,n.Wm)(E,{src:e.url,class:"el-map",fit:"cover"},null,8,["src"]),p.value==e.id?((0,n.wg)(),(0,n.iD)("div",Te,[(0,n.Wm)(M,{color:"#18c174",size:26},{default:(0,n.w5)((()=>[(0,n.Wm)(R)])),_:1})])):(0,n.kq)("",!0)],10,Se)])),_:2},1024)))),128))])),_:1})])),_:1})],2)])}}});const Ie=(0,ie.Z)(We,[["__scopeId","data-v-5ce4aada"]]);var Ue=Ie;const Ee={class:"edit-box"},Re={class:"header"},Ve=(0,n._)("span",null,"模型动画",-1),Pe=["onClick"],Fe={class:"icon-name"},He={class:"check"},De=(0,n._)("div",{class:"header"},[(0,n._)("span",null,"动画配置")],-1),ze={class:"option"},Ne=(0,n._)("span",null," 循环方式 ",-1),Oe={class:"option"},je={class:"option"},Ge=(0,n._)("span",null," 播放速度 ",-1),Be={class:"option"},Ze={class:"option"},Ye=(0,n._)("span",null," 动作幅度 ",-1),qe={class:"option"},Xe={class:"header"},Ke=(0,n._)("span",null,"轴动画",-1),$e={class:"options"},Je=(0,n._)("span",null," 轴方向 ",-1),Qe=(0,n._)("span",null," 播放速度 ",-1);var et=(0,n.aZ)({__name:"EditAnimation",setup(e,{expose:t}){const i=(0,r.oR)(),{$bus:l}=(0,n.FN)().proxy,d=(0,o.qj)({visible:!1,animationName:null,loop:"LoopRepeat",timeScale:1,weight:1,rotationVisible:!1,rotationType:"y",rotationSpeed:1}),c=(0,n.Fl)((()=>d.visible?"":"disabled")),u=(0,n.Fl)((()=>d.rotationVisible?"":"disabled")),p=(0,o.qj)({modelApi:(0,n.Fl)((()=>i.state.modelApi)),modelAnimation:(0,n.Fl)((()=>i.state.modelApi?i.state.modelApi.modelAnimation:[]))});(0,n.bv)((()=>{p.modelAnimation.length&&(d.animationName=p.modelAnimation[0].name),l.on("model-update",(()=>{if(p.modelAnimation.length){const e=p.modelAnimation[0].name;d.animationName=e}Object.assign(d,{visible:!1,loop:"LoopRepeat",timeScale:1,weight:1,rotationVisible:!1,rotationType:"y",rotationSpeed:1})}))}));const h=()=>{const{visible:e}=d;e?g():p.modelApi.onClearAnimation()},m=e=>{const{name:t}=e;d.animationName=t,p.modelApi.onStartModelAnimaion(d)},g=()=>{p.modelApi.onStartModelAnimaion(d)},f=()=>{p.modelApi.onSetRotation(d)},_=()=>{p.modelApi.onSetRotationType(d)};return t({config:d}),(e,t)=>{const i=(0,n.up)("el-switch"),o=(0,n.up)("Check"),l=(0,n.up)("el-icon"),r=(0,n.up)("el-space"),y=(0,n.up)("el-scrollbar"),w=(0,n.up)("el-empty"),v=(0,n.up)("Switch"),b=(0,n.up)("el-radio-button"),x=(0,n.up)("el-radio-group"),M=(0,n.up)("VideoPlay"),C=(0,n.up)("el-slider"),L=(0,n.up)("Sort");return(0,n.wg)(),(0,n.iD)("div",Ee,[(0,n._)("div",Re,[Ve,(0,n.Wm)(i,{modelValue:d.visible,"onUpdate:modelValue":t[0]||(t[0]=e=>d.visible=e),onChange:h},null,8,["modelValue"])]),(0,n._)("div",{class:(0,a.C_)(["options",c.value])},[p.modelAnimation.length?((0,n.wg)(),(0,n.j4)(y,{key:0,"max-height":"250px"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(p.modelAnimation,(e=>((0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(["option",d.animationName==e.name?"option-active":""]),onClick:t=>m(e),key:e.name},[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n._)("div",Fe,(0,a.zw)(e.name),1),(0,n.wy)((0,n._)("div",He,[(0,n.Wm)(l,{size:"20px",color:"#2a3ff6"},{default:(0,n.w5)((()=>[(0,n.Wm)(o)])),_:1})],512),[[s.F8,d.animationName==e.name]])])),_:2},1024)],10,Pe)))),128))])),_:1})):((0,n.wg)(),(0,n.j4)(w,{key:1,description:"暂无动画","image-size":120}))],2),De,(0,n._)("div",{class:(0,a.C_)(["options",c.value])},[(0,n._)("div",ze,[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(l,null,{default:(0,n.w5)((()=>[(0,n.Wm)(v)])),_:1}),Ne])),_:1})]),(0,n._)("div",Oe,[(0,n.Wm)(x,{modelValue:d.loop,"onUpdate:modelValue":t[1]||(t[1]=e=>d.loop=e),onChange:g},{default:(0,n.w5)((()=>[(0,n.Wm)(b,{label:"LoopOnce"},{default:(0,n.w5)((()=>[(0,n.Uk)("只执行一次")])),_:1}),(0,n.Wm)(b,{label:"LoopRepeat"},{default:(0,n.w5)((()=>[(0,n.Uk)("无限循环")])),_:1}),(0,n.Wm)(b,{label:"LoopPingPong"},{default:(0,n.w5)((()=>[(0,n.Uk)("来回循环")])),_:1})])),_:1},8,["modelValue"])]),(0,n._)("div",je,[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(l,null,{default:(0,n.w5)((()=>[(0,n.Wm)(M)])),_:1}),Ge])),_:1})]),(0,n._)("div",Be,[(0,n.Wm)(C,{"show-input":"",modelValue:d.timeScale,"onUpdate:modelValue":t[2]||(t[2]=e=>d.timeScale=e),onChange:g,step:.01,min:0,max:1},null,8,["modelValue"])]),(0,n._)("div",Ze,[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(l,null,{default:(0,n.w5)((()=>[(0,n.Wm)(L)])),_:1}),Ye])),_:1})]),(0,n._)("div",qe,[(0,n.Wm)(C,{"show-input":"",modelValue:d.weight,"onUpdate:modelValue":t[3]||(t[3]=e=>d.weight=e),onChange:g,step:.01,min:0,max:1},null,8,["modelValue"])])],2),(0,n._)("div",Xe,[Ke,(0,n.Wm)(i,{modelValue:d.rotationVisible,"onUpdate:modelValue":t[4]||(t[4]=e=>d.rotationVisible=e),onChange:f},null,8,["modelValue"])]),(0,n._)("div",$e,[(0,n._)("div",{class:(0,a.C_)(["option",u.value])},[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[Je,(0,n.Wm)(x,{modelValue:d.rotationType,"onUpdate:modelValue":t[5]||(t[5]=e=>d.rotationType=e),onChange:_},{default:(0,n.w5)((()=>[(0,n.Wm)(b,{label:"x"},{default:(0,n.w5)((()=>[(0,n.Uk)("X轴")])),_:1}),(0,n.Wm)(b,{label:"y"},{default:(0,n.w5)((()=>[(0,n.Uk)("Y轴")])),_:1}),(0,n.Wm)(b,{label:"z"},{default:(0,n.w5)((()=>[(0,n.Uk)("Z轴")])),_:1})])),_:1},8,["modelValue"])])),_:1})],2),(0,n._)("div",{class:(0,a.C_)(["option",u.value])},[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(l,null,{default:(0,n.w5)((()=>[(0,n.Wm)(M)])),_:1}),Qe])),_:1})],2),(0,n._)("div",{class:(0,a.C_)(["option",u.value])},[(0,n.Wm)(C,{onInput:f,"show-input":"",modelValue:d.rotationSpeed,"onUpdate:modelValue":t[6]||(t[6]=e=>d.rotationSpeed=e),step:.01,min:1,max:10},null,8,["modelValue"])],2)])])}}});const tt=et;var it=tt;const nt={class:"edit-box"},ot={class:"header"},st=(0,n._)("span",null,"辅助线/轴配置",-1),at={class:"option space-between"},lt=(0,n._)("span",null," 模型轴旋转 ",-1),rt={class:"option"},dt={class:"option"},ct={class:"option"},ut={class:"option space-between"},pt=(0,n._)("span",null," 模型位置 ",-1),ht={class:"option"},mt={class:"grid-txt"},gt={class:"grid-silder"},ft={class:"option"},_t={class:"grid-txt"},yt={class:"grid-silder"},wt={class:"option"},vt={class:"grid-txt"},bt={class:"grid-silder"},xt={class:"option space-between"},Mt=(0,n._)("span",null," 模型骨架 ",-1),Ct={class:"option space-between"},Lt=(0,n._)("span",null," 网格辅助线 ",-1),kt={class:"option"},At={class:"grid-txt"},St={class:"grid-silder"},Tt={class:"option"},Wt={class:"grid-txt"},It={class:"grid-silder"},Ut={class:"option"},Et={class:"grid-txt"},Rt={class:"grid-silder"},Vt={class:"option"},Pt={class:"option"},Ft={class:"option space-between"},Ht=(0,n._)("span",null," 坐标轴辅助线 ",-1),Dt={class:"grid-txt"},zt={class:"grid-silder"};var Nt=(0,n.aZ)({__name:"EditAttribute",setup(e,{expose:t}){const i=(0,r.oR)(),{$bus:s}=(0,n.FN)().proxy,l=(0,o.qj)({visible:!0,skeletonHelper:!1,gridHelper:!1,x:0,y:-.59,z:-.1,positionX:0,positionY:-.5,positionZ:0,divisions:10,size:4,color:"rgb(193,193,193)",axesHelper:!1,axesSize:1.8}),d=H.UL,c=(0,n.Fl)((()=>l.visible?"":"disabled")),u=(0,n.Fl)((()=>{const{visible:e,gridHelper:t}=l;return t&&e?"":"disabled"})),p=(0,n.Fl)((()=>{const{visible:e,axesHelper:t}=l;return t&&e?"":"disabled"})),h=(0,o.qj)({modelApi:(0,n.Fl)((()=>i.state.modelApi))});(0,n.bv)((()=>{s.on("model-update",(()=>{Object.assign(l,{visible:!0,skeletonHelper:!1,gridHelper:!1,x:0,y:-.59,z:-.1,positionX:0,positionY:-.5,positionZ:0,divisions:10,size:4,color:"rgb(193,193,193)",axesHelper:!1,axesSize:1.8})}))}));const m=()=>{},g=(e,t)=>{const i="right"==t;h.modelApi.onSetModelRotateOnAxis(e,i)},f=()=>{h.modelApi.onResultModelRotateOnAxis()},_=()=>{h.modelApi.onSetModelPosition(l)},y=()=>{l.positionX=0,l.positionY=-.5,l.positionZ=0,h.modelApi.onResultModelPosition(l)},w=()=>{h.modelApi.onSetModelHelper(l.skeletonHelper)},v=e=>{l.color=e,h.modelApi.onSetModelGridHelper(l)},b=()=>{h.modelApi.onSetModelGridHelper(l)},x=()=>{h.modelApi.onSetModelGridHelperSize(l)},M=()=>{h.modelApi.onSetModelAxesHelper(l)},C=()=>{const{x:e,y:t,z:i}=h.modelApi.model.rotation;let n=e,o=t,s=i;return{...l,rotationX:n,rotationY:o,rotationZ:s}};return t({getAttrbuteConfig:C}),(e,t)=>{const i=(0,n.up)("el-switch"),s=(0,n.up)("Setting"),r=(0,n.up)("el-icon"),h=(0,n.up)("el-space"),C=(0,n.up)("el-button"),L=(0,n.up)("Location"),k=(0,n.up)("el-slider"),A=(0,n.up)("Eleme"),S=(0,n.up)("Grid"),T=(0,n.up)("el-input-number"),W=(0,n.up)("el-color-picker"),I=(0,n.up)("Rank");return(0,n.wg)(),(0,n.iD)("div",nt,[(0,n._)("div",ot,[st,(0,n.Wm)(i,{modelValue:l.visible,"onUpdate:modelValue":t[0]||(t[0]=e=>l.visible=e),onChange:m},null,8,["modelValue"])]),(0,n._)("div",{class:(0,a.C_)(["options",c.value])},[(0,n._)("div",at,[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(s)])),_:1}),lt])),_:1}),(0,n.Wm)(C,{type:"primary",link:"",icon:"Refresh",onClick:f},{default:(0,n.w5)((()=>[(0,n.Uk)(" 重置 ")])),_:1})]),(0,n._)("div",rt,[(0,n.Wm)(C,{type:"info",icon:"RefreshRight",onClick:t[1]||(t[1]=e=>g("x","right"))}),(0,n.Wm)(C,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("X轴")])),_:1}),(0,n.Wm)(C,{type:"info",icon:"RefreshLeft",onClick:t[2]||(t[2]=e=>g("x","left"))})]),(0,n._)("div",dt,[(0,n.Wm)(C,{type:"info",icon:"RefreshRight",onClick:t[3]||(t[3]=e=>g("y","right"))}),(0,n.Wm)(C,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("Y轴")])),_:1}),(0,n.Wm)(C,{type:"info",icon:"RefreshLeft",onClick:t[4]||(t[4]=e=>g("y","left"))})]),(0,n._)("div",ct,[(0,n.Wm)(C,{type:"info",icon:"RefreshRight",onClick:t[5]||(t[5]=e=>g("z","right"))}),(0,n.Wm)(C,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("Z轴")])),_:1}),(0,n.Wm)(C,{type:"info",icon:"RefreshLeft",onClick:t[6]||(t[6]=e=>g("z","left"))})]),(0,n._)("div",ut,[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(L)])),_:1}),pt])),_:1}),(0,n.Wm)(C,{type:"primary",link:"",icon:"Refresh",onClick:y},{default:(0,n.w5)((()=>[(0,n.Uk)(" 重置 ")])),_:1})]),(0,n._)("div",ht,[(0,n._)("div",mt,[(0,n.Wm)(C,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("X 轴")])),_:1})]),(0,n._)("div",gt,[(0,n.Wm)(k,{onInput:_,"show-input":"",modelValue:l.positionX,"onUpdate:modelValue":t[7]||(t[7]=e=>l.positionX=e),min:-10,max:10,step:.1},null,8,["modelValue"])])]),(0,n._)("div",ft,[(0,n._)("div",_t,[(0,n.Wm)(C,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("Y 轴")])),_:1})]),(0,n._)("div",yt,[(0,n.Wm)(k,{onInput:_,"show-input":"",modelValue:l.positionY,"onUpdate:modelValue":t[8]||(t[8]=e=>l.positionY=e),min:-10,max:10,step:.1},null,8,["modelValue"])])]),(0,n._)("div",wt,[(0,n._)("div",vt,[(0,n.Wm)(C,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("Z 轴")])),_:1})]),(0,n._)("div",bt,[(0,n.Wm)(k,{onInput:_,"show-input":"",modelValue:l.positionZ,"onUpdate:modelValue":t[9]||(t[9]=e=>l.positionZ=e),min:-10,max:10,step:.1},null,8,["modelValue"])])]),(0,n._)("div",xt,[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(A)])),_:1}),Mt])),_:1}),(0,n.Wm)(i,{modelValue:l.skeletonHelper,"onUpdate:modelValue":t[10]||(t[10]=e=>l.skeletonHelper=e),onChange:w},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["options",c.value])},[(0,n._)("div",Ct,[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(S)])),_:1}),Lt])),_:1}),(0,n.Wm)(i,{modelValue:l.gridHelper,"onUpdate:modelValue":t[11]||(t[11]=e=>l.gridHelper=e),onChange:b},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["options",u.value])},[(0,n._)("div",kt,[(0,n._)("div",At,[(0,n.Wm)(C,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("X 轴")])),_:1})]),(0,n._)("div",St,[(0,n.Wm)(k,{"show-input":"",onInput:b,modelValue:l.x,"onUpdate:modelValue":t[12]||(t[12]=e=>l.x=e),min:-2,max:4,step:.01},null,8,["modelValue"])])]),(0,n._)("div",Tt,[(0,n._)("div",Wt,[(0,n.Wm)(C,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("Y 轴")])),_:1})]),(0,n._)("div",It,[(0,n.Wm)(k,{"show-input":"",onInput:b,modelValue:l.y,"onUpdate:modelValue":t[13]||(t[13]=e=>l.y=e),min:-2,max:4,step:.01},null,8,["modelValue"])])]),(0,n._)("div",Ut,[(0,n._)("div",Et,[(0,n.Wm)(C,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("Z 轴")])),_:1})]),(0,n._)("div",Rt,[(0,n.Wm)(k,{"show-input":"",onInput:b,modelValue:l.z,"onUpdate:modelValue":t[14]||(t[14]=e=>l.z=e),min:-2,max:4,step:.01},null,8,["modelValue"])])]),(0,n._)("div",Vt,[(0,n._)("div",null,[(0,n.Wm)(C,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("大小")])),_:1}),(0,n.Wm)(T,{controls:!0,onChange:x,modelValue:l.size,"onUpdate:modelValue":t[15]||(t[15]=e=>l.size=e),min:1,max:40},null,8,["modelValue"])]),(0,n._)("div",null,[(0,n.Wm)(C,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("分割数")])),_:1}),(0,n.Wm)(T,{controls:!0,onChange:x,modelValue:l.divisions,"onUpdate:modelValue":t[16]||(t[16]=e=>l.divisions=e),min:1,max:40},null,8,["modelValue"])])]),(0,n._)("div",Pt,[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(C,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("网格颜色")])),_:1}),(0,n.Wm)(W,{"color-format":"hex",predefine:(0,o.SU)(d),onChange:b,onActiveChange:v,modelValue:l.color,"onUpdate:modelValue":t[17]||(t[17]=e=>l.color=e)},null,8,["predefine","modelValue"])])),_:1})])],2),(0,n._)("div",{class:(0,a.C_)(["options",c.value])},[(0,n._)("div",Ft,[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(I)])),_:1}),Ht])),_:1}),(0,n.Wm)(i,{modelValue:l.axesHelper,"onUpdate:modelValue":t[18]||(t[18]=e=>l.axesHelper=e),onChange:M},null,8,["modelValue"])]),(0,n._)("div",{class:(0,a.C_)(["option",p.value])},[(0,n._)("div",Dt,[(0,n.Wm)(C,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("轴长度")])),_:1})]),(0,n._)("div",zt,[(0,n.Wm)(k,{onInput:M,modelValue:l.axesSize,"onUpdate:modelValue":t[19]||(t[19]=e=>l.axesSize=e),min:1,max:10,step:.2},null,8,["modelValue"])])],2)],2)])}}});const Ot=Nt;var jt=Ot;const Gt=e=>((0,n.dD)("data-v-77542eb5"),e=e(),(0,n.Cn)(),e),Bt={class:"edit-box"},Zt=Gt((()=>(0,n._)("div",{class:"header"},[(0,n._)("span",null,"模型灯光")],-1))),Yt={class:"options"},qt={class:"option space-between"},Xt=Gt((()=>(0,n._)("span",null,"光源平面",-1))),Kt=Gt((()=>(0,n._)("span",null,"平面颜色",-1))),$t={class:"grid-txt"},Jt={class:"grid-silder"},Qt={class:"grid-txt"},ei={class:"grid-silder"},ti={class:"options"},ii={class:"option space-between"},ni=Gt((()=>(0,n._)("span",null,"环境光",-1))),oi={class:"color"},si={class:"silder"},ai={class:"options"},li={class:"option space-between"},ri=Gt((()=>(0,n._)("span",null,"平行光",-1))),di={class:"color"},ci={class:"silder"},ui={class:"grid-txt"},pi={class:"grid-silder"},hi={class:"grid-txt"},mi={class:"grid-silder"},gi={class:"grid-txt"},fi={class:"grid-silder"},_i={class:"grid-txt"},yi={class:"grid-silder"},wi={class:"grid-txt"},vi={class:"grid-silder"},bi={class:"options"},xi={class:"option space-between"},Mi=Gt((()=>(0,n._)("span",null,"点光源",-1))),Ci={class:"grid-txt"},Li={class:"grid-silder"},ki={class:"color"},Ai={class:"silder"},Si={class:"grid-txt"},Ti={class:"grid-silder"},Wi={class:"grid-txt"},Ii={class:"grid-silder"},Ui={class:"grid-txt"},Ei={class:"grid-silder"},Ri={class:"options"},Vi={class:"option space-between"},Pi=Gt((()=>(0,n._)("span",null,"聚光灯",-1))),Fi={class:"color"},Hi={class:"silder"},Di={class:"grid-txt"},zi={class:"grid-silder"},Ni={class:"grid-txt"},Oi={class:"grid-silder"},ji={class:"grid-txt"},Gi={class:"grid-silder"},Bi={class:"grid-txt"},Zi={class:"grid-silder"},Yi={class:"grid-txt"},qi={class:"grid-silder"},Xi={class:"grid-txt"},Ki={class:"grid-silder"},$i={class:"grid-txt"},Ji={class:"grid-silder"},Qi={class:"grid-txt"},en={class:"grid-silder"},tn={class:"grid-txt"},nn={class:"grid-silder"};var on=(0,n.aZ)({__name:"EditLight",setup(e,{expose:t}){const i=(0,r.oR)(),{$bus:s}=(0,n.FN)().proxy,l=(0,o.qj)({planeGeometry:!1,planeColor:"#000000",planeWidth:7,planeHeight:7,ambientLight:!0,ambientLightColor:"#fff",ambientLightIntensity:.8,directionalLight:!1,directionalLightHelper:!0,directionalLightColor:"#fff",directionalLightIntensity:5,directionalHorizontal:-1.26,directionalVertical:-3.85,directionalSistance:2.98,directionaShadow:!0,pointLight:!1,pointLightHelper:!0,pointLightColor:"#1E90FF",pointLightIntensity:10,pointHorizontal:-4.21,pointVertical:-4.1,pointSistance:2.53,spotLight:!1,spotLightColor:"#00BABD",spotLightIntensity:900,spotHorizontal:-3.49,spotVertical:-4.37,spotSistance:4.09,spotAngle:.5,spotPenumbra:1,spotFocus:1,spotCastShadow:!0,spotLightHelper:!0,spotDistance:20}),d=H.UL,c=(0,n.Fl)((()=>{const{ambientLight:e}=l;return e?"":"disabled"})),u=(0,n.Fl)((()=>{const{directionalLight:e}=l;return e?"":"disabled"})),p=(0,n.Fl)((()=>{const{pointLight:e}=l;return e?"":"disabled"})),h=(0,n.Fl)((()=>{const{spotLight:e}=l;return e?"":"disabled"})),m=(0,n.Fl)((()=>{const{planeGeometry:e}=l;return e?"":"disabled"})),g=(0,o.qj)({modelApi:(0,n.Fl)((()=>i.state.modelApi))});(0,n.bv)((()=>{s.on("model-update",(()=>{Object.assign(l,{planeGeometry:!1,planeColor:"#000000",planeWidth:7,planeHeight:7,ambientLight:!0,ambientLightColor:"#fff",ambientLightIntensity:.8,directionalLight:!1,directionalLightHelper:!0,directionalLightColor:"#fff",directionalLightIntensity:5,directionalHorizontal:-1.26,directionalVertical:-3.85,directionalSistance:2.98,directionaShadow:!0,pointLight:!1,pointLightHelper:!0,pointLightColor:"#1E90FF",pointLightIntensity:10,pointHorizontal:-4.21,pointVertical:-4.1,pointSistance:2.53,spotLight:!1,spotLightColor:"#00BABD",spotLightIntensity:900,spotHorizontal:-3.49,spotVertical:-4.37,spotSistance:4.09,spotAngle:.5,spotPenumbra:1,spotFocus:1,spotCastShadow:!0,spotLightHelper:!0,spotDistance:20})}))}));const f=e=>{l.ambientLightColor=e,g.modelApi.onSetModelAmbientLight(l)},_=()=>{g.modelApi.onSetModelAmbientLight(l)},y=e=>{l.directionalLightColor=e,g.modelApi.onSetModelDirectionalLight(l)},w=()=>{l.directionalLight&&(l.planeGeometry=!0,g.modelApi.onSetModelPlaneGeometry(l)),g.modelApi.onSetModelDirectionalLight(l)},v=e=>{l.pointLightColor=e,g.modelApi.onSetModelPointLight(l)},b=()=>{g.modelApi.onSetModelPointLight(l)},x=e=>{l.spotLightColor=e,g.modelApi.onSetModelSpotLight(l)},M=()=>{l.spotLight&&(l.planeGeometry=!0,g.modelApi.onSetModelPlaneGeometry(l)),g.modelApi.onSetModelSpotLight(l)},C=e=>{l.planeColor=e,g.modelApi.onSetModelPlaneGeometry(l)},L=()=>{g.modelApi.onSetModelPlaneGeometry(l)};return t({config:l}),(e,t)=>{const i=(0,n.up)("Odometer"),s=(0,n.up)("el-icon"),r=(0,n.up)("el-space"),g=(0,n.up)("el-switch"),k=(0,n.up)("el-color-picker"),A=(0,n.up)("el-button"),S=(0,n.up)("el-slider"),T=(0,n.up)("SetUp"),W=(0,n.up)("Place"),I=(0,n.up)("Orange"),U=(0,n.up)("el-scrollbar");return(0,n.wg)(),(0,n.iD)("div",Bt,[Zt,(0,n.Wm)(U,{height:"calc(100vh - 130px)"},{default:(0,n.w5)((()=>[(0,n._)("div",Yt,[(0,n._)("div",qt,[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(s,null,{default:(0,n.w5)((()=>[(0,n.Wm)(i)])),_:1}),Xt])),_:1}),(0,n.Wm)(g,{modelValue:l.planeGeometry,"onUpdate:modelValue":t[0]||(t[0]=e=>l.planeGeometry=e),onChange:L},null,8,["modelValue"])]),(0,n._)("div",{class:(0,a.C_)(["option",m.value])},[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[Kt,(0,n.Wm)(k,{"color-format":"hex",modelValue:l.planeColor,"onUpdate:modelValue":t[1]||(t[1]=e=>l.planeColor=e),predefine:(0,o.SU)(d),onChange:L,onActiveChange:C},null,8,["modelValue","predefine"])])),_:1})],2),(0,n._)("div",{class:(0,a.C_)(["option",m.value])},[(0,n._)("div",$t,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("宽度")])),_:1})]),(0,n._)("div",Jt,[(0,n.Wm)(S,{"show-input":"",onInput:L,modelValue:l.planeWidth,"onUpdate:modelValue":t[2]||(t[2]=e=>l.planeWidth=e),min:0,max:100,step:.1},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["option",m.value])},[(0,n._)("div",Qt,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("高度")])),_:1})]),(0,n._)("div",ei,[(0,n.Wm)(S,{"show-input":"",onInput:L,modelValue:l.planeHeight,"onUpdate:modelValue":t[3]||(t[3]=e=>l.planeHeight=e),min:0,max:100,step:.1},null,8,["modelValue"])])],2)]),(0,n._)("div",ti,[(0,n._)("div",ii,[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(s,null,{default:(0,n.w5)((()=>[(0,n.Wm)(i)])),_:1}),ni])),_:1}),(0,n.Wm)(g,{modelValue:l.ambientLight,"onUpdate:modelValue":t[4]||(t[4]=e=>l.ambientLight=e),onChange:_},null,8,["modelValue"])]),(0,n._)("div",{class:(0,a.C_)(["option",c.value])},[(0,n._)("div",oi,[(0,n.Wm)(k,{"color-format":"hex",modelValue:l.ambientLightColor,"onUpdate:modelValue":t[5]||(t[5]=e=>l.ambientLightColor=e),predefine:(0,o.SU)(d),onChange:_,onActiveChange:f},null,8,["modelValue","predefine"])]),(0,n._)("div",si,[(0,n.Wm)(S,{"show-input":"",onInput:_,modelValue:l.ambientLightIntensity,"onUpdate:modelValue":t[6]||(t[6]=e=>l.ambientLightIntensity=e),min:-5,max:5,step:.01},null,8,["modelValue"])])],2)]),(0,n._)("div",ai,[(0,n._)("div",li,[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(s,null,{default:(0,n.w5)((()=>[(0,n.Wm)(T)])),_:1}),ri])),_:1}),(0,n.Wm)(g,{modelValue:l.directionalLight,"onUpdate:modelValue":t[7]||(t[7]=e=>l.directionalLight=e),onChange:w},null,8,["modelValue"])]),(0,n._)("div",{class:(0,a.C_)(["option",u.value])},[(0,n._)("div",di,[(0,n.Wm)(k,{"color-format":"hex",modelValue:l.directionalLightColor,"onUpdate:modelValue":t[8]||(t[8]=e=>l.directionalLightColor=e),predefine:(0,o.SU)(d),onChange:w,onActiveChange:y},null,8,["modelValue","predefine"])]),(0,n._)("div",ci,[(0,n.Wm)(S,{"show-input":"",onInput:w,modelValue:l.directionalLightIntensity,"onUpdate:modelValue":t[9]||(t[9]=e=>l.directionalLightIntensity=e),min:-5,max:15,step:.01},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["option",u.value])},[(0,n._)("div",ui,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("是否开启阴影")])),_:1})]),(0,n._)("div",pi,[(0,n.Wm)(g,{modelValue:l.directionaShadow,"onUpdate:modelValue":t[10]||(t[10]=e=>l.directionaShadow=e),onChange:w},null,8,["modelValue"])]),(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n._)("div",hi,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("辅助线")])),_:1})]),(0,n._)("div",mi,[(0,n.Wm)(g,{modelValue:l.directionalLightHelper,"onUpdate:modelValue":t[11]||(t[11]=e=>l.directionalLightHelper=e),onChange:w},null,8,["modelValue"])])])),_:1})],2),(0,n._)("div",{class:(0,a.C_)(["option",u.value])},[(0,n._)("div",gi,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("水平方向")])),_:1})]),(0,n._)("div",fi,[(0,n.Wm)(S,{"show-input":"",onInput:w,modelValue:l.directionalHorizontal,"onUpdate:modelValue":t[12]||(t[12]=e=>l.directionalHorizontal=e),min:-10,max:10,step:.01},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["option",u.value])},[(0,n._)("div",_i,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("垂直方向")])),_:1})]),(0,n._)("div",yi,[(0,n.Wm)(S,{"show-input":"",onInput:w,modelValue:l.directionalVertical,"onUpdate:modelValue":t[13]||(t[13]=e=>l.directionalVertical=e),min:-10,max:10,step:.01},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["option",u.value])},[(0,n._)("div",wi,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("光源距离")])),_:1})]),(0,n._)("div",vi,[(0,n.Wm)(S,{"show-input":"",onInput:w,modelValue:l.directionalSistance,"onUpdate:modelValue":t[14]||(t[14]=e=>l.directionalSistance=e),min:0,max:10,step:.01},null,8,["modelValue"])])],2)]),(0,n._)("div",bi,[(0,n._)("div",xi,[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(s,null,{default:(0,n.w5)((()=>[(0,n.Wm)(W)])),_:1}),Mi])),_:1}),(0,n.Wm)(g,{modelValue:l.pointLight,"onUpdate:modelValue":t[15]||(t[15]=e=>l.pointLight=e),onChange:b},null,8,["modelValue"])]),(0,n._)("div",{class:(0,a.C_)(["option",p.value])},[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n._)("div",Ci,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("辅助线")])),_:1})]),(0,n._)("div",Li,[(0,n.Wm)(g,{modelValue:l.pointLightHelper,"onUpdate:modelValue":t[16]||(t[16]=e=>l.pointLightHelper=e),onChange:b},null,8,["modelValue"])])])),_:1})],2),(0,n._)("div",{class:(0,a.C_)(["option",p.value])},[(0,n._)("div",ki,[(0,n.Wm)(k,{"color-format":"hex",modelValue:l.pointLightColor,"onUpdate:modelValue":t[17]||(t[17]=e=>l.pointLightColor=e),predefine:(0,o.SU)(d),onChange:b,onActiveChange:v},null,8,["modelValue","predefine"])]),(0,n._)("div",Ai,[(0,n.Wm)(S,{"show-input":"",onInput:b,modelValue:l.pointLightIntensity,"onUpdate:modelValue":t[18]||(t[18]=e=>l.pointLightIntensity=e),min:-20,max:60,step:.1},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["option",p.value])},[(0,n._)("div",Si,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("水平方向")])),_:1})]),(0,n._)("div",Ti,[(0,n.Wm)(S,{"show-input":"",onInput:b,modelValue:l.pointHorizontal,"onUpdate:modelValue":t[19]||(t[19]=e=>l.pointHorizontal=e),min:-10,max:10,step:.11},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["option",p.value])},[(0,n._)("div",Wi,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("垂直方向")])),_:1})]),(0,n._)("div",Ii,[(0,n.Wm)(S,{"show-input":"",onInput:b,modelValue:l.pointVertical,"onUpdate:modelValue":t[20]||(t[20]=e=>l.pointVertical=e),min:-10,max:10,step:.1},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["option",p.value])},[(0,n._)("div",Ui,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("光源距离")])),_:1})]),(0,n._)("div",Ei,[(0,n.Wm)(S,{"show-input":"",onInput:b,modelValue:l.pointSistance,"onUpdate:modelValue":t[21]||(t[21]=e=>l.pointSistance=e),min:0,max:10,step:.1},null,8,["modelValue"])])],2)]),(0,n._)("div",Ri,[(0,n._)("div",Vi,[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(s,null,{default:(0,n.w5)((()=>[(0,n.Wm)(I)])),_:1}),Pi])),_:1}),(0,n.Wm)(g,{modelValue:l.spotLight,"onUpdate:modelValue":t[22]||(t[22]=e=>l.spotLight=e),onChange:M},null,8,["modelValue"])]),(0,n._)("div",{class:(0,a.C_)(["option",h.value])},[(0,n._)("div",Fi,[(0,n.Wm)(k,{"color-format":"hex",modelValue:l.spotLightColor,"onUpdate:modelValue":t[23]||(t[23]=e=>l.spotLightColor=e),predefine:(0,o.SU)(d),onChange:M,onActiveChange:x},null,8,["modelValue","predefine"])]),(0,n._)("div",Hi,[(0,n.Wm)(S,{"show-input":"",onInput:M,modelValue:l.spotLightIntensity,"onUpdate:modelValue":t[24]||(t[24]=e=>l.spotLightIntensity=e),min:0,max:2e3,step:.1},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["option",h.value])},[(0,n._)("div",Di,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("是否开启阴影")])),_:1})]),(0,n._)("div",zi,[(0,n.Wm)(g,{modelValue:l.spotCastShadow,"onUpdate:modelValue":t[25]||(t[25]=e=>l.spotCastShadow=e),onChange:M},null,8,["modelValue"])]),(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n._)("div",Ni,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("辅助线")])),_:1})]),(0,n._)("div",Oi,[(0,n.Wm)(g,{modelValue:l.spotLightHelper,"onUpdate:modelValue":t[26]||(t[26]=e=>l.spotLightHelper=e),onChange:M},null,8,["modelValue"])])])),_:1})],2),(0,n._)("div",{class:(0,a.C_)(["option",h.value])},[(0,n._)("div",ji,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("水平方向")])),_:1})]),(0,n._)("div",Gi,[(0,n.Wm)(S,{"show-input":"",onInput:M,modelValue:l.spotHorizontal,"onUpdate:modelValue":t[27]||(t[27]=e=>l.spotHorizontal=e),min:-10,max:10,step:.1},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["option",h.value])},[(0,n._)("div",Bi,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("垂直方向")])),_:1})]),(0,n._)("div",Zi,[(0,n.Wm)(S,{"show-input":"",onInput:M,modelValue:l.spotVertical,"onUpdate:modelValue":t[28]||(t[28]=e=>l.spotVertical=e),min:-10,max:10,step:.1},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["option",h.value])},[(0,n._)("div",Yi,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("光源距离")])),_:1})]),(0,n._)("div",qi,[(0,n.Wm)(S,{"show-input":"",onInput:M,modelValue:l.spotSistance,"onUpdate:modelValue":t[29]||(t[29]=e=>l.spotSistance=e),min:0,max:10,step:.1},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["option",h.value])},[(0,n._)("div",Xi,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("光线照射范围")])),_:1})]),(0,n._)("div",Ki,[(0,n.Wm)(S,{"show-input":"",onInput:M,modelValue:l.spotAngle,"onUpdate:modelValue":t[30]||(t[30]=e=>l.spotAngle=e),min:0,max:2,step:.01},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["option",h.value])},[(0,n._)("div",$i,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("边缘聚光度")])),_:1})]),(0,n._)("div",Ji,[(0,n.Wm)(S,{"show-input":"",onInput:M,modelValue:l.spotPenumbra,"onUpdate:modelValue":t[31]||(t[31]=e=>l.spotPenumbra=e),min:0,max:1,step:.01},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["option",h.value])},[(0,n._)("div",Qi,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("投影聚焦度")])),_:1})]),(0,n._)("div",en,[(0,n.Wm)(S,{"show-input":"",onInput:M,modelValue:l.spotFocus,"onUpdate:modelValue":t[32]||(t[32]=e=>l.spotFocus=e),min:0,max:3,step:.01},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["option",h.value])},[(0,n._)("div",tn,[(0,n.Wm)(A,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("光源照射距离")])),_:1})]),(0,n._)("div",nn,[(0,n.Wm)(S,{"show-input":"",onInput:M,modelValue:l.spotDistance,"onUpdate:modelValue":t[33]||(t[33]=e=>l.spotDistance=e),min:1,max:500,step:1},null,8,["modelValue"])])],2)])])),_:1})])}}});const sn=(0,ie.Z)(on,[["__scopeId","data-v-77542eb5"]]);var an=sn;const ln={class:"edit-box"},rn=(0,n._)("div",{class:"header"},[(0,n._)("span",null,"后期处理")],-1),dn={class:"options"},cn={class:"option space-between"},un=(0,n._)("span",null," 辉光 ",-1),pn={class:"option"},hn={class:"grid-txt"},mn={class:"grid-silder"},gn={class:"option"},fn={class:"grid-txt"},_n={class:"grid-silder"},yn={class:"option"},wn={class:"grid-txt"},vn={class:"grid-silder"},bn={class:"option"},xn={class:"grid-txt"},Mn={class:"grid-silder"},Cn={class:"options"},Ln={class:"option space-between"},kn=(0,n._)("span",null," 色调曝光度 ",-1),An={class:"grid-silder"},Sn={class:"header"},Tn=(0,n._)("span",null,"模型操作",-1),Wn={class:"options"},In=(0,n._)("span",null," 模型分解 ",-1),Un={class:"grid-silder"},En=(0,n._)("span",null," 模型材质拖拽 ",-1),Rn={class:"grid-silder"};var Vn=(0,n.aZ)({__name:"EditLaterStage",setup(e,{expose:t}){const i=(0,r.oR)(),{$bus:s}=(0,n.FN)().proxy,l=(0,o.qj)({modelApi:(0,n.Fl)((()=>i.state.modelApi))}),d=(0,n.Fl)((()=>{const{glow:e}=p;return e?"":"disabled"})),c=(0,n.Fl)((()=>{const e=l.modelApi.modelMaterialList,t=e.filter((e=>"Mesh"==e.type));return t.length<=1||t.length!=e.length||p.modelDrag?"disabled":""})),u=(0,n.Fl)((()=>{const e=l.modelApi.modelMaterialList,t=e.filter((e=>"Mesh"==e.type));return t.length<=1||t.length!=e.length?"disabled":""})),p=(0,o.qj)({glow:!1,threshold:.05,strength:.6,radius:1,decompose:0,modelDrag:!1,toneMappingExposure:2,color:""});(0,n.bv)((()=>{s.on("model-update",(()=>{Object.assign(p,{glow:!1,threshold:.05,strength:.6,radius:1,decompose:0,modelDrag:!1,toneMappingExposure:2})}))}));const h=()=>{l.modelApi.onSetFlowColor(p.color)},m=e=>{p.color=e,l.modelApi.onSetFlowColor(p.color)},g=()=>{l.modelApi.onSetUnrealBloomPass(p)},f=()=>{l.modelApi.setModelMeshDecompose(p)},_=()=>{p.decompose=0,l.modelApi.setModelMeshDecompose(p),l.modelApi.setModelMeshDrag(p)},y=()=>({meshPositonList:l.modelApi.getMeshDragPosition(),...p});return t({getStageConfig:y}),(e,t)=>{const i=(0,n.up)("Sunny"),s=(0,n.up)("el-icon"),l=(0,n.up)("el-space"),r=(0,n.up)("el-switch"),y=(0,n.up)("el-button"),w=(0,n.up)("el-color-picker"),v=(0,n.up)("el-slider"),b=(0,n.up)("Umbrella"),x=(0,n.up)("WarnTriangleFilled"),M=(0,n.up)("el-tooltip"),C=(0,n.up)("Cpu"),L=(0,n.up)("Rank");return(0,n.wg)(),(0,n.iD)("div",ln,[rn,(0,n._)("div",dn,[(0,n._)("div",cn,[(0,n.Wm)(l,null,{default:(0,n.w5)((()=>[(0,n.Wm)(s,null,{default:(0,n.w5)((()=>[(0,n.Wm)(i)])),_:1}),un])),_:1}),(0,n.Wm)(r,{modelValue:p.glow,"onUpdate:modelValue":t[0]||(t[0]=e=>p.glow=e),onChange:g},null,8,["modelValue"])])]),(0,n._)("div",{class:(0,a.C_)(["options",d.value])},[(0,n._)("div",pn,[(0,n._)("div",hn,[(0,n.Wm)(y,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("颜色")])),_:1})]),(0,n._)("div",mn,[(0,n.Wm)(w,{"color-format":"hex",predefine:(0,o.SU)(H.UL),onChange:h,onActiveChange:m,modelValue:p.color,"onUpdate:modelValue":t[1]||(t[1]=e=>p.color=e)},null,8,["predefine","modelValue"])])]),(0,n._)("div",gn,[(0,n._)("div",fn,[(0,n.Wm)(y,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("强度")])),_:1})]),(0,n._)("div",_n,[(0,n.Wm)(v,{"show-input":"",modelValue:p.strength,"onUpdate:modelValue":t[2]||(t[2]=e=>p.strength=e),onInput:g,step:.01,min:0,max:8},null,8,["modelValue"])])]),(0,n._)("div",yn,[(0,n._)("div",wn,[(0,n.Wm)(y,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("半径")])),_:1})]),(0,n._)("div",vn,[(0,n.Wm)(v,{"show-input":"",modelValue:p.radius,"onUpdate:modelValue":t[3]||(t[3]=e=>p.radius=e),onInput:g,step:.01,min:0,max:5},null,8,["modelValue"])])]),(0,n._)("div",bn,[(0,n._)("div",xn,[(0,n.Wm)(y,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)("阈值")])),_:1})]),(0,n._)("div",Mn,[(0,n.Wm)(v,{"show-input":"",modelValue:p.threshold,"onUpdate:modelValue":t[4]||(t[4]=e=>p.threshold=e),onInput:g,step:.01,min:0,max:1},null,8,["modelValue"])])])],2),(0,n._)("div",Cn,[(0,n._)("div",Ln,[(0,n.Wm)(l,null,{default:(0,n.w5)((()=>[(0,n.Wm)(s,null,{default:(0,n.w5)((()=>[(0,n.Wm)(b)])),_:1}),kn])),_:1}),(0,n._)("div",An,[(0,n.Wm)(v,{"show-input":"",modelValue:p.toneMappingExposure,"onUpdate:modelValue":t[5]||(t[5]=e=>p.toneMappingExposure=e),onInput:g,step:.01,min:.5,max:10},null,8,["modelValue"])])])]),(0,n._)("div",Sn,[(0,n.Wm)(l,null,{default:(0,n.w5)((()=>[Tn,"disabled"==c.value?((0,n.wg)(),(0,n.j4)(M,{key:0,effect:"dark",content:"当前模型不可进行以下操作",placement:"top"},{default:(0,n.w5)((()=>[(0,n.Wm)(s,null,{default:(0,n.w5)((()=>[(0,n.Wm)(x,{size:20,color:"#ffb940"})])),_:1})])),_:1})):(0,n.kq)("",!0)])),_:1})]),(0,n._)("div",Wn,[(0,n._)("div",{class:(0,a.C_)(["option space-between",c.value])},[(0,n.Wm)(l,null,{default:(0,n.w5)((()=>[(0,n.Wm)(s,null,{default:(0,n.w5)((()=>[(0,n.Wm)(C)])),_:1}),In])),_:1}),(0,n._)("div",Un,[(0,n.Wm)(v,{"show-input":"",modelValue:p.decompose,"onUpdate:modelValue":t[6]||(t[6]=e=>p.decompose=e),onInput:f,step:.01,min:0,max:20},null,8,["modelValue"])])],2),(0,n._)("div",{class:(0,a.C_)(["option",u.value])},[(0,n.Wm)(l,null,{default:(0,n.w5)((()=>[(0,n.Wm)(s,null,{default:(0,n.w5)((()=>[(0,n.Wm)(L,{size:20})])),_:1}),En])),_:1}),(0,n._)("div",Rn,[(0,n.Wm)(r,{modelValue:p.modelDrag,"onUpdate:modelValue":t[7]||(t[7]=e=>p.modelDrag=e),onChange:_},null,8,["modelValue"])])],2)])])}}});const Pn=Vn;var Fn=Pn;const Hn=e=>((0,n.dD)("data-v-1e8e190f"),e=e(),(0,n.Cn)(),e),Dn={class:"edit-box"},zn=Hn((()=>(0,n._)("div",{class:"header"},[(0,n._)("span",null,"几何体模型材质列表")],-1))),Nn={class:"options"},On=["onClick"],jn={class:"icon-name"},Gn={class:"check"},Bn={class:"icon-delete"},Zn=Hn((()=>(0,n._)("div",{class:"header"},[(0,n._)("span",null,"几何体模型编辑")],-1))),Yn={class:"options"},qn={class:"grid-txt"},Xn={class:"grid-silder"},Kn={key:1};var $n=(0,n.aZ)({__name:"EditGeometry",setup(e){const t=(0,r.oR)(),i=(0,o.qj)({meaterialName:null,type:null}),l=(0,o.iH)(null),d=(0,o.iH)([]),c=(0,n.Fl)((()=>{const e=u.modelMaterialList.filter((e=>e.userData.geometry));return 0!=e})),u=(0,o.qj)({modelMaterialList:(0,n.Fl)((()=>t.state.modelApi.modelMaterialList)),modelApi:(0,n.Fl)((()=>t.state.modelApi)),selectMeshUuid:(0,n.Fl)((()=>t.getters.selectMeshUuid))});(0,n.YP)((()=>t.getters.selectMeshUuid),(e=>{const{geometry:t}=u.modelMaterialList.find((t=>t.uuid==e))||{};if(t){const{type:e}=t;l.value={...t.parameters},i.type=e,d.value=Object.keys(l.value)}else d.value=[]}));const p=e=>{const{name:t,material:n}=e;i.meaterialName=n.name,u.modelApi.onChangeModelMeaterial(t)},h=()=>{u.modelApi.onSetGeometryMesh(l.value,i.type)},m=e=>{u.modelApi.onDeleteGeometryMesh(e),ae.z8.success("删除成功")},g=e=>{let t={min:1,max:80,step:.01};return["width","height","radius","length","thetaLength","radiusTop","innerRadius","radiusBottom","q","outerRadius","arc","tube","p"].includes(e)&&(t={min:.1,max:10,step:.01}),["detail","capSegments","radialSegments","thetaStart","depthSegments","widthSegments","heightSegments"].includes(e)&&(t={min:0,max:10,step:1}),t};return(e,t)=>{const i=(0,n.up)("Check"),o=(0,n.up)("el-icon"),r=(0,n.up)("Delete"),f=(0,n.up)("el-space"),_=(0,n.up)("el-scrollbar"),y=(0,n.up)("el-button"),w=(0,n.up)("el-slider"),v=(0,n.up)("el-switch"),b=(0,n.up)("el-empty");return(0,n.wg)(),(0,n.iD)("div",Dn,[c.value?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[zn,(0,n._)("div",Nn,[(0,n.Wm)(_,{"max-height":"300px"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(u.modelMaterialList,(e=>((0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(["option",u.selectMeshUuid==e.uuid?"option-active":""]),onClick:t=>p(e),key:e.uuid},[(0,n._)("div",jn,(0,a.zw)(e.name),1),(0,n.Wm)(f,null,{default:(0,n.w5)((()=>[(0,n.wy)((0,n._)("div",Gn,[(0,n.Wm)(o,{size:"20px",color:"#2a3ff6"},{default:(0,n.w5)((()=>[(0,n.Wm)(i)])),_:1})],512),[[s.F8,u.selectMeshUuid==e.uuid]]),(0,n._)("div",Bn,[(0,n.Wm)(o,{size:"18px",color:"#2a3ff6"},{default:(0,n.w5)((()=>[(0,n.Wm)(r,{onClick:(0,s.iM)((t=>m(e.uuid)),["stop"])},null,8,["onClick"])])),_:2},1024)])])),_:2},1024)],10,On)))),128))])),_:1})]),Zn,(0,n._)("div",Yn,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(d.value,(e=>((0,n.wg)(),(0,n.iD)("div",{class:"option",key:e},[(0,n._)("div",qn,[(0,n.Wm)(y,{type:"primary",link:""},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(e),1)])),_:2},1024)]),(0,n._)("div",Xn,["number"==typeof l.value[e]?((0,n.wg)(),(0,n.j4)(w,{key:0,"show-input":"",modelValue:l.value[e],"onUpdate:modelValue":t=>l.value[e]=t,min:g(e).min,max:g(e).max,step:g(e).step,onInput:h},null,8,["modelValue","onUpdate:modelValue","min","max","step"])):"string"==typeof l.value[e]?((0,n.wg)(),(0,n.iD)("div",Kn,(0,a.zw)(l.value[e]),1)):"boolean"==typeof l.value[e]?((0,n.wg)(),(0,n.j4)(v,{key:2,onChange:h,modelValue:l.value[e],"onUpdate:modelValue":t=>l.value[e]=t},null,8,["modelValue","onUpdate:modelValue"])):(0,n.kq)("",!0)])])))),128))])],64)):((0,n.wg)(),(0,n.j4)(b,{key:1,description:"当前模型不支持使用该功能","image-size":120}))])}}});const Jn=(0,ie.Z)($n,[["__scopeId","data-v-1e8e190f"]]);var Qn=Jn;const eo={class:"model-panel"},to={class:"panel-tabs"},io=["onClick"],no={class:"tab"},oo={class:"panel-edit"};var so=(0,n.aZ)({__name:"index",setup(e,{expose:t}){const i=[{name:"背景",key:"EditBackground",icon:"Picture"},{name:"材质",key:"EditMaterial",icon:"DataAnalysis"},{name:"后期/操作",key:"EditLaterStage",icon:"MagicStick"},{name:"灯光",key:"EditLight",icon:"Sunrise"},{name:"模型动画",key:"EditAnimation",icon:"VideoCameraFilled"},{name:"辅助线/轴配置",key:"EditAttribute",icon:"Box"},{name:"几何体模型配置",key:"EditGeometry",icon:"Cellphone"}],l=(0,o.iH)("EditMaterial"),r=(0,o.iH)(null),d=(0,o.iH)(null),c=(0,o.iH)(null),u=(0,o.iH)(null),p=(0,o.iH)(null),h=(0,o.iH)(null),m=(0,o.iH)(null),g=()=>({background:r.value.config,material:d.value.getMeshConfig(),animation:c.value.config,attribute:u.value.getAttrbuteConfig(),light:p.value.config,stage:h.value.getStageConfig()});return t({getPanelConfig:g}),(e,t)=>{const o=(0,n.up)("el-icon"),g=(0,n.up)("el-tooltip");return(0,n.wg)(),(0,n.iD)("div",eo,[(0,n._)("ul",to,[((0,n.wg)(),(0,n.iD)(n.HY,null,(0,n.Ko)(i,(e=>(0,n._)("li",{key:e.key,class:(0,a.C_)(l.value==e.key?"active":""),onClick:t=>l.value=e.key},[(0,n.Wm)(g,{effect:"light",content:e.name,placement:"top"},{default:(0,n.w5)((()=>[(0,n._)("div",no,[(0,n.Wm)(o,{size:"20px",color:l.value==e.key?"#fff":""},{default:(0,n.w5)((()=>[((0,n.wg)(),(0,n.j4)((0,n.LL)(e.icon)))])),_:2},1032,["color"])])])),_:2},1032,["content"])],10,io))),64))]),(0,n._)("div",oo,[(0,n.wy)((0,n._)("div",null,[(0,n.Wm)(oe,{ref_key:"background",ref:r},null,512)],512),[[s.F8,"EditBackground"==l.value]]),(0,n.wy)((0,n._)("div",null,[(0,n.Wm)(Ue,{ref_key:"material",ref:d},null,512)],512),[[s.F8,"EditMaterial"==l.value]]),(0,n.wy)((0,n._)("div",null,[(0,n.Wm)(Fn,{ref_key:"stage",ref:h},null,512)],512),[[s.F8,"EditLaterStage"==l.value]]),(0,n.wy)((0,n._)("div",null,[(0,n.Wm)(it,{ref_key:"animation",ref:c},null,512)],512),[[s.F8,"EditAnimation"==l.value]]),(0,n.wy)((0,n._)("div",null,[(0,n.Wm)(an,{ref_key:"light",ref:p},null,512)],512),[[s.F8,"EditLight"==l.value]]),(0,n.wy)((0,n._)("div",null,[(0,n.Wm)(jt,{ref_key:"attribute",ref:u},null,512)],512),[[s.F8,"EditAttribute"==l.value]]),(0,n.wy)((0,n._)("div",null,[(0,n.Wm)(Qn,{ref_key:"geometry",ref:m},null,512)],512),[[s.F8,"EditGeometry"==l.value]])])])}}});const ao=(0,ie.Z)(so,[["__scopeId","data-v-6d88af7d"]]);var lo=ao,ro=i(2201),co=i(844),uo=i(7327),po=i(8558),ho=i(7836),mo=i(8606),go=i(4458),fo=i(8939),_o=i(1129),yo=i(7531),wo=i(185),vo=i(6591),bo=i(7011),xo=i(1411);const Mo=new WeakMap;class Co extends se.Loader{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,n){const o=new se.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(e=>{this.parse(e,t,n)}),i,n)}parse(e,t,i){this.decodeDracoFile(e,t,null,null,se.SRGBColorSpace).catch(i)}decodeDracoFile(e,t,i,n,o=se.LinearSRGBColorSpace){const s={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!i,vertexColorSpace:o};return this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){const i=JSON.stringify(t);if(Mo.has(e)){const t=Mo.get(e);if(t.key===i)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n;const o=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(o,s).then((i=>(n=i,new Promise(((i,s)=>{n._callbacks[o]={resolve:i,reject:s},n.postMessage({type:"decode",id:o,taskConfig:t,buffer:e},[e])}))))).then((e=>this._createGeometry(e.geometry)));return a.catch((()=>!0)).then((()=>{n&&o&&this._releaseTask(n,o)})),Mo.set(e,{key:i,promise:a}),a}_createGeometry(e){const t=new se.BufferGeometry;e.index&&t.setIndex(new se.BufferAttribute(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const n=e.attributes[i],o=n.name,s=n.array,a=n.itemSize,l=new se.BufferAttribute(s,a);"color"===o&&(this._assignVertexColorSpace(l,n.vertexColorSpace),l.normalized=s instanceof Float32Array===!1),t.setAttribute(o,l)}return t}_assignVertexColorSpace(e,t){if(t!==se.SRGBColorSpace)return;const i=new se.Color;for(let n=0,o=e.count;n<o;n++)i.fromBufferAttribute(e,n).convertSRGBToLinear(),e.setXYZ(n,i.r,i.g,i.b)}_loadLibrary(e,t){const i=new se.FileLoader(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise(((t,n)=>{i.load(e,t,void 0,n)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!==typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((t=>{const i=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const n=Lo.toString(),o=["/* draco decoder */",i,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([o]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const i=t.data;switch(i.type){case"decode":e._callbacks[i.id].resolve(i);break;case"error":e._callbacks[i.id].reject(i);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+i.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}}function Lo(){let e,t;function i(e,t,i,s){const a=s.attributeIDs,l=s.attributeTypes;let r,d;const c=t.GetEncodedGeometryType(i);if(c===e.TRIANGULAR_MESH)r=new e.Mesh,d=t.DecodeArrayToMesh(i,i.byteLength,r);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");r=new e.PointCloud,d=t.DecodeArrayToPointCloud(i,i.byteLength,r)}if(!d.ok()||0===r.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+d.error_msg());const u={index:null,attributes:[]};for(const n in a){const i=self[l[n]];let d,c;if(s.useUniqueIDs)c=a[n],d=t.GetAttributeByUniqueId(r,c);else{if(c=t.GetAttributeId(r,e[a[n]]),-1===c)continue;d=t.GetAttribute(r,c)}const p=o(e,t,r,n,i,d);"color"===n&&(p.vertexColorSpace=s.vertexColorSpace),u.attributes.push(p)}return c===e.TRIANGULAR_MESH&&(u.index=n(e,t,r)),e.destroy(r),u}function n(e,t,i){const n=i.num_faces(),o=3*n,s=4*o,a=e._malloc(s);t.GetTrianglesUInt32Array(i,s,a);const l=new Uint32Array(e.HEAPF32.buffer,a,o).slice();return e._free(a),{array:l,itemSize:1}}function o(e,t,i,n,o,a){const l=a.num_components(),r=i.num_points(),d=r*l,c=d*o.BYTES_PER_ELEMENT,u=s(e,o),p=e._malloc(c);t.GetAttributeDataArrayForAllPoints(i,a,u,c,p);const h=new o(e.HEAPF32.buffer,p,d).slice();return e._free(p),{name:n,array:h,itemSize:l}}function s(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}onmessage=function(n){const o=n.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":const n=o.buffer,s=o.taskConfig;t.then((e=>{const t=e.draco,a=new t.Decoder;try{const e=i(t,a,new Int8Array(n),s),l=e.attributes.map((e=>e.array.buffer));e.index&&l.push(e.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:e},l)}catch(l){console.error(l),self.postMessage({type:"error",id:o.id,error:l.message})}finally{t.destroy(a)}}));break}}}let ko,Ao,So,To;function Wo(e,t=1/0,i=null){Ao||(Ao=new se.PlaneGeometry(2,2,1,1)),So||(So=new se.ShaderMaterial({uniforms:{blitTexture:new se.Uniform(e)},vertexShader:"\n            varying vec2 vUv;\n            void main(){\n                vUv = uv;\n                gl_Position = vec4(position.xy * 1.0,0.,.999999);\n            }",fragmentShader:"\n            uniform sampler2D blitTexture; \n            varying vec2 vUv;\n\n            void main(){ \n                gl_FragColor = vec4(vUv.xy, 0, 1);\n                \n                #ifdef IS_SRGB\n                gl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );\n                #else\n                gl_FragColor = texture2D( blitTexture, vUv);\n                #endif\n            }"})),So.uniforms.blitTexture.value=e,So.defines.IS_SRGB=e.colorSpace==se.SRGBColorSpace,So.needsUpdate=!0,To||(To=new se.Mesh(Ao,So),To.frustrumCulled=!1);const n=new se.PerspectiveCamera,o=new se.Scene;o.add(To),i||(i=ko=new se.WebGLRenderer({antialias:!1})),i.setSize(Math.min(e.image.width,t),Math.min(e.image.height,t)),i.clear(),i.render(o,n);const s=new se.Texture(i.domElement);return s.minFilter=e.minFilter,s.magFilter=e.magFilter,s.wrapS=e.wrapS,s.wrapT=e.wrapT,s.name=e.name,ko&&(ko.dispose(),ko=null),s}const Io={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class Uo{constructor(){this.pluginCallbacks=[],this.register((function(e){return new Qo(e)})),this.register((function(e){return new es(e)})),this.register((function(e){return new ns(e)})),this.register((function(e){return new os(e)})),this.register((function(e){return new ss(e)})),this.register((function(e){return new as(e)})),this.register((function(e){return new ts(e)})),this.register((function(e){return new is(e)})),this.register((function(e){return new ls(e)})),this.register((function(e){return new rs(e)})),this.register((function(e){return new ds(e)})),this.register((function(e){return new cs(e)}))}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,n){const o=new Jo,s=[];for(let a=0,l=this.pluginCallbacks.length;a<l;a++)s.push(this.pluginCallbacks[a](o));o.setPlugins(s),o.write(e,t,n).catch(i)}parseAsync(e,t){const i=this;return new Promise((function(n,o){i.parse(e,n,o,t)}))}}const Eo={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},Ro="KHR_mesh_quantization",Vo={};Vo[se.NearestFilter]=Eo.NEAREST,Vo[se.NearestMipmapNearestFilter]=Eo.NEAREST_MIPMAP_NEAREST,Vo[se.NearestMipmapLinearFilter]=Eo.NEAREST_MIPMAP_LINEAR,Vo[se.LinearFilter]=Eo.LINEAR,Vo[se.LinearMipmapNearestFilter]=Eo.LINEAR_MIPMAP_NEAREST,Vo[se.LinearMipmapLinearFilter]=Eo.LINEAR_MIPMAP_LINEAR,Vo[se.ClampToEdgeWrapping]=Eo.CLAMP_TO_EDGE,Vo[se.RepeatWrapping]=Eo.REPEAT,Vo[se.MirroredRepeatWrapping]=Eo.MIRRORED_REPEAT;const Po={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},Fo=new se.Color,Ho=12,Do=1179937895,zo=2,No=8,Oo=1313821514,jo=5130562;function Go(e,t){return e.length===t.length&&e.every((function(e,i){return e===t[i]}))}function Bo(e){return(new TextEncoder).encode(e).buffer}function Zo(e){return Go(e.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function Yo(e,t,i){const n={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let o=t;o<t+i;o++)for(let t=0;t<e.itemSize;t++){let i;e.itemSize>4?i=e.array[o*e.itemSize+t]:(0===t?i=e.getX(o):1===t?i=e.getY(o):2===t?i=e.getZ(o):3===t&&(i=e.getW(o)),!0===e.normalized&&(i=se.MathUtils.normalize(i,e.array))),n.min[t]=Math.min(n.min[t],i),n.max[t]=Math.max(n.max[t],i)}return n}function qo(e){return 4*Math.ceil(e/4)}function Xo(e,t=0){const i=qo(e.byteLength);if(i!==e.byteLength){const n=new Uint8Array(i);if(n.set(new Uint8Array(e)),0!==t)for(let o=e.byteLength;o<i;o++)n[o]=t;return n.buffer}return e}function Ko(){return"undefined"===typeof document&&"undefined"!==typeof OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas")}function $o(e,t){if(void 0!==e.toBlob)return new Promise((i=>e.toBlob(i,t)));let i;return"image/jpeg"===t?i=.92:"image/webp"===t&&(i=.8),e.convertToBlob({type:t,quality:i})}class Jo{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}async write(e,t,i={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},i),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e),await Promise.all(this.pending);const n=this,o=n.buffers,s=n.json;i=n.options;const a=n.extensionsUsed,l=n.extensionsRequired,r=new Blob(o,{type:"application/octet-stream"}),d=Object.keys(a),c=Object.keys(l);if(d.length>0&&(s.extensionsUsed=d),c.length>0&&(s.extensionsRequired=c),s.buffers&&s.buffers.length>0&&(s.buffers[0].byteLength=r.size),!0===i.binary){const e=new FileReader;e.readAsArrayBuffer(r),e.onloadend=function(){const i=Xo(e.result),n=new DataView(new ArrayBuffer(No));n.setUint32(0,i.byteLength,!0),n.setUint32(4,jo,!0);const o=Xo(Bo(JSON.stringify(s)),32),a=new DataView(new ArrayBuffer(No));a.setUint32(0,o.byteLength,!0),a.setUint32(4,Oo,!0);const l=new ArrayBuffer(Ho),r=new DataView(l);r.setUint32(0,Do,!0),r.setUint32(4,zo,!0);const d=Ho+a.byteLength+o.byteLength+n.byteLength+i.byteLength;r.setUint32(8,d,!0);const c=new Blob([l,a,o,n,i],{type:"application/octet-stream"}),u=new FileReader;u.readAsArrayBuffer(c),u.onloadend=function(){t(u.result)}}}else if(s.buffers&&s.buffers.length>0){const e=new FileReader;e.readAsDataURL(r),e.onloadend=function(){const i=e.result;s.buffers[0].uri=i,t(s)}}else t(s)}serializeUserData(e,t){if(0===Object.keys(e.userData).length)return;const i=this.options,n=this.extensionsUsed;try{const o=JSON.parse(JSON.stringify(e.userData));if(i.includeCustomExtensions&&o.gltfExtensions){void 0===t.extensions&&(t.extensions={});for(const e in o.gltfExtensions)t.extensions[e]=o.gltfExtensions[e],n[e]=!0;delete o.gltfExtensions}Object.keys(o).length>0&&(t.extras=o)}catch(o){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+o.message)}}getUID(e,t=!1){if(!1===this.uids.has(e)){const t=new Map;t.set(!0,this.uid++),t.set(!1,this.uid++),this.uids.set(e,t)}const i=this.uids.get(e);return i.get(t)}isNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return!1;const i=new se.Vector3;for(let n=0,o=e.count;n<o;n++)if(Math.abs(i.fromBufferAttribute(e,n).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const i=e.clone(),n=new se.Vector3;for(let o=0,s=i.count;o<s;o++)n.fromBufferAttribute(i,o),0===n.x&&0===n.y&&0===n.z?n.setX(1):n.normalize(),i.setXYZ(o,n.x,n.y,n.z);return t.attributesNormalized.set(e,i),i}applyTextureTransform(e,t){let i=!1;const n={};0===t.offset.x&&0===t.offset.y||(n.offset=t.offset.toArray(),i=!0),0!==t.rotation&&(n.rotation=t.rotation,i=!0),1===t.repeat.x&&1===t.repeat.y||(n.scale=t.repeat.toArray(),i=!0),i&&(e.extensions=e.extensions||{},e.extensions["KHR_texture_transform"]=n,this.extensionsUsed["KHR_texture_transform"]=!0)}buildMetalRoughTexture(e,t){if(e===t)return e;function i(e){return e.colorSpace===se.SRGBColorSpace?function(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}:function(e){return e}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),e instanceof se.CompressedTexture&&(e=Wo(e)),t instanceof se.CompressedTexture&&(t=Wo(t));const n=e?e.image:null,o=t?t.image:null,s=Math.max(n?n.width:0,o?o.width:0),a=Math.max(n?n.height:0,o?o.height:0),l=Ko();l.width=s,l.height=a;const r=l.getContext("2d");r.fillStyle="#00ffff",r.fillRect(0,0,s,a);const d=r.getImageData(0,0,s,a);if(n){r.drawImage(n,0,0,s,a);const t=i(e),o=r.getImageData(0,0,s,a).data;for(let e=2;e<o.length;e+=4)d.data[e]=256*t(o[e]/256)}if(o){r.drawImage(o,0,0,s,a);const e=i(t),n=r.getImageData(0,0,s,a).data;for(let t=1;t<n.length;t+=4)d.data[t]=256*e(n[t]/256)}r.putImageData(d,0,0);const c=e||t,u=c.clone();return u.source=new se.Source(l),u.colorSpace=se.NoColorSpace,u.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),u}processBuffer(e){const t=this.json,i=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),i.push(e),0}processBufferView(e,t,i,n,o){const s=this.json;let a;switch(s.bufferViews||(s.bufferViews=[]),t){case Eo.BYTE:case Eo.UNSIGNED_BYTE:a=1;break;case Eo.SHORT:case Eo.UNSIGNED_SHORT:a=2;break;default:a=4}const l=qo(n*e.itemSize*a),r=new DataView(new ArrayBuffer(l));let d=0;for(let p=i;p<i+n;p++)for(let i=0;i<e.itemSize;i++){let n;e.itemSize>4?n=e.array[p*e.itemSize+i]:(0===i?n=e.getX(p):1===i?n=e.getY(p):2===i?n=e.getZ(p):3===i&&(n=e.getW(p)),!0===e.normalized&&(n=se.MathUtils.normalize(n,e.array))),t===Eo.FLOAT?r.setFloat32(d,n,!0):t===Eo.INT?r.setInt32(d,n,!0):t===Eo.UNSIGNED_INT?r.setUint32(d,n,!0):t===Eo.SHORT?r.setInt16(d,n,!0):t===Eo.UNSIGNED_SHORT?r.setUint16(d,n,!0):t===Eo.BYTE?r.setInt8(d,n):t===Eo.UNSIGNED_BYTE&&r.setUint8(d,n),d+=a}const c={buffer:this.processBuffer(r.buffer),byteOffset:this.byteOffset,byteLength:l};void 0!==o&&(c.target=o),o===Eo.ARRAY_BUFFER&&(c.byteStride=e.itemSize*a),this.byteOffset+=l,s.bufferViews.push(c);const u={id:s.bufferViews.length-1,byteLength:0};return u}processBufferViewImage(e){const t=this,i=t.json;return i.bufferViews||(i.bufferViews=[]),new Promise((function(n){const o=new FileReader;o.readAsArrayBuffer(e),o.onloadend=function(){const e=Xo(o.result),s={buffer:t.processBuffer(e),byteOffset:t.byteOffset,byteLength:e.byteLength};t.byteOffset+=e.byteLength,n(i.bufferViews.push(s)-1)}}))}processAccessor(e,t,i,n){const o=this.json,s={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let a;if(e.array.constructor===Float32Array)a=Eo.FLOAT;else if(e.array.constructor===Int32Array)a=Eo.INT;else if(e.array.constructor===Uint32Array)a=Eo.UNSIGNED_INT;else if(e.array.constructor===Int16Array)a=Eo.SHORT;else if(e.array.constructor===Uint16Array)a=Eo.UNSIGNED_SHORT;else if(e.array.constructor===Int8Array)a=Eo.BYTE;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);a=Eo.UNSIGNED_BYTE}if(void 0===i&&(i=0),void 0!==n&&n!==1/0||(n=e.count),0===n)return null;const l=Yo(e,i,n);let r;void 0!==t&&(r=e===t.index?Eo.ELEMENT_ARRAY_BUFFER:Eo.ARRAY_BUFFER);const d=this.processBufferView(e,a,i,n,r),c={bufferView:d.id,byteOffset:d.byteOffset,componentType:a,count:n,max:l.max,min:l.min,type:s[e.itemSize]};return!0===e.normalized&&(c.normalized=!0),o.accessors||(o.accessors=[]),o.accessors.push(c)-1}processImage(e,t,i,n="image/png"){if(null!==e){const o=this,s=o.cache,a=o.json,l=o.options,r=o.pending;s.images.has(e)||s.images.set(e,{});const d=s.images.get(e),c=n+":flipY/"+i.toString();if(void 0!==d[c])return d[c];a.images||(a.images=[]);const u={mimeType:n},p=Ko();p.width=Math.min(e.width,l.maxTextureSize),p.height=Math.min(e.height,l.maxTextureSize);const h=p.getContext("2d");if(!0===i&&(h.translate(0,p.height),h.scale(1,-1)),void 0!==e.data){t!==se.RGBAFormat&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>l.maxTextureSize||e.height>l.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const i=new Uint8ClampedArray(e.height*e.width*4);for(let t=0;t<i.length;t+=4)i[t+0]=e.data[t+0],i[t+1]=e.data[t+1],i[t+2]=e.data[t+2],i[t+3]=e.data[t+3];h.putImageData(new ImageData(i,e.width,e.height),0,0)}else h.drawImage(e,0,0,p.width,p.height);!0===l.binary?r.push($o(p,n).then((e=>o.processBufferViewImage(e))).then((e=>{u.bufferView=e}))):void 0!==p.toDataURL?u.uri=p.toDataURL(n):r.push($o(p,n).then((e=>(new FileReader).readAsDataURL(e))).then((e=>{u.uri=e})));const m=a.images.push(u)-1;return d[c]=m,m}throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;t.samplers||(t.samplers=[]);const i={magFilter:Vo[e.magFilter],minFilter:Vo[e.minFilter],wrapS:Vo[e.wrapS],wrapT:Vo[e.wrapT]};return t.samplers.push(i)-1}processTexture(e){const t=this,i=t.options,n=this.cache,o=this.json;if(n.textures.has(e))return n.textures.get(e);o.textures||(o.textures=[]),e instanceof se.CompressedTexture&&(e=Wo(e,i.maxTextureSize));let s=e.userData.mimeType;"image/webp"===s&&(s="image/png");const a={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,s)};e.name&&(a.name=e.name),this._invokeAll((function(t){t.writeTexture&&t.writeTexture(e,a)}));const l=o.textures.push(a)-1;return n.textures.set(e,l),l}processMaterial(e){const t=this.cache,i=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;i.materials||(i.materials=[]);const n={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const o=e.color.toArray().concat([e.opacity]);if(Go(o,[1,1,1,1])||(n.pbrMetallicRoughness.baseColorFactor=o),e.isMeshStandardMaterial?(n.pbrMetallicRoughness.metallicFactor=e.metalness,n.pbrMetallicRoughness.roughnessFactor=e.roughness):(n.pbrMetallicRoughness.metallicFactor=.5,n.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const t=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),i={index:this.processTexture(t),channel:t.channel};this.applyTextureTransform(i,t),n.pbrMetallicRoughness.metallicRoughnessTexture=i}if(e.map){const t={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(t,e.map),n.pbrMetallicRoughness.baseColorTexture=t}if(e.emissive){const t=e.emissive,i=Math.max(t.r,t.g,t.b);if(i>0&&(n.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const t={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(t,e.emissiveMap),n.emissiveTexture=t}}if(e.normalMap){const t={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&1!==e.normalScale.x&&(t.scale=e.normalScale.x),this.applyTextureTransform(t,e.normalMap),n.normalTexture=t}if(e.aoMap){const t={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};1!==e.aoMapIntensity&&(t.strength=e.aoMapIntensity),this.applyTextureTransform(t,e.aoMap),n.occlusionTexture=t}e.transparent?n.alphaMode="BLEND":e.alphaTest>0&&(n.alphaMode="MASK",n.alphaCutoff=e.alphaTest),e.side===se.DoubleSide&&(n.doubleSided=!0),""!==e.name&&(n.name=e.name),this.serializeUserData(e,n),this._invokeAll((function(t){t.writeMaterial&&t.writeMaterial(e,n)}));const s=i.materials.push(n)-1;return t.materials.set(e,s),s}processMesh(e){const t=this.cache,i=this.json,n=[e.geometry.uuid];if(Array.isArray(e.material))for(let y=0,w=e.material.length;y<w;y++)n.push(e.material[y].uuid);else n.push(e.material.uuid);const o=n.join(":");if(t.meshes.has(o))return t.meshes.get(o);const s=e.geometry;let a;a=e.isLineSegments?Eo.LINES:e.isLineLoop?Eo.LINE_LOOP:e.isLine?Eo.LINE_STRIP:e.isPoints?Eo.POINTS:e.material.wireframe?Eo.LINES:Eo.TRIANGLES;const l={},r={},d=[],c=[],u={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},p=s.getAttribute("normal");void 0===p||this.isNormalizedNormalAttribute(p)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),s.setAttribute("normal",this.createNormalizedNormalAttribute(p)));let h=null;for(let y in s.attributes){if("morph"===y.slice(0,5))continue;const e=s.attributes[y];y=u[y]||y.toUpperCase();const i=/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/;if(i.test(y)||(y="_"+y),t.attributes.has(this.getUID(e))){r[y]=t.attributes.get(this.getUID(e));continue}h=null;const n=e.array;"JOINTS_0"!==y||n instanceof Uint16Array||n instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),h=new se.BufferAttribute(new Uint16Array(n),e.itemSize,e.normalized));const o=this.processAccessor(h||e,s);null!==o&&(y.startsWith("_")||this.detectMeshQuantization(y,e),r[y]=o,t.attributes.set(this.getUID(e),o))}if(void 0!==p&&s.setAttribute("normal",p),0===Object.keys(r).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){const i=[],n=[],o={};if(void 0!==e.morphTargetDictionary)for(const t in e.morphTargetDictionary)o[e.morphTargetDictionary[t]]=t;for(let a=0;a<e.morphTargetInfluences.length;++a){const l={};let r=!1;for(const e in s.morphAttributes){if("position"!==e&&"normal"!==e){r||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),r=!0);continue}const i=s.morphAttributes[e][a],n=e.toUpperCase(),o=s.attributes[e];if(t.attributes.has(this.getUID(i,!0))){l[n]=t.attributes.get(this.getUID(i,!0));continue}const d=i.clone();if(!s.morphTargetsRelative)for(let e=0,t=i.count;e<t;e++)for(let n=0;n<i.itemSize;n++)0===n&&d.setX(e,i.getX(e)-o.getX(e)),1===n&&d.setY(e,i.getY(e)-o.getY(e)),2===n&&d.setZ(e,i.getZ(e)-o.getZ(e)),3===n&&d.setW(e,i.getW(e)-o.getW(e));l[n]=this.processAccessor(d,s),t.attributes.set(this.getUID(o,!0),l[n])}c.push(l),i.push(e.morphTargetInfluences[a]),void 0!==e.morphTargetDictionary&&n.push(o[a])}l.weights=i,n.length>0&&(l.extras={},l.extras.targetNames=n)}const m=Array.isArray(e.material);if(m&&0===s.groups.length)return null;const g=m?e.material:[e.material],f=m?s.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let y=0,w=f.length;y<w;y++){const e={mode:a,attributes:r};if(this.serializeUserData(s,e),c.length>0&&(e.targets=c),null!==s.index){let i=this.getUID(s.index);void 0===f[y].start&&void 0===f[y].count||(i+=":"+f[y].start+":"+f[y].count),t.attributes.has(i)?e.indices=t.attributes.get(i):(e.indices=this.processAccessor(s.index,s,f[y].start,f[y].count),t.attributes.set(i,e.indices)),null===e.indices&&delete e.indices}const i=this.processMaterial(g[f[y].materialIndex]);null!==i&&(e.material=i),d.push(e)}l.primitives=d,i.meshes||(i.meshes=[]),this._invokeAll((function(t){t.writeMesh&&t.writeMesh(e,l)}));const _=i.meshes.push(l)-1;return t.meshes.set(o,_),_}detectMeshQuantization(e,t){if(this.extensionsUsed[Ro])return;let i;switch(t.array.constructor){case Int8Array:i="byte";break;case Uint8Array:i="unsigned byte";break;case Int16Array:i="short";break;case Uint16Array:i="unsigned short";break;default:return}t.normalized&&(i+=" normalized");const n=e.split("_",1)[0];Io[n]&&Io[n].includes(i)&&(this.extensionsUsed[Ro]=!0,this.extensionsRequired[Ro]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const i=e.isOrthographicCamera,n={type:i?"orthographic":"perspective"};return i?n.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:n.perspective={aspectRatio:e.aspect,yfov:se.MathUtils.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(n.name=e.type),t.cameras.push(n)-1}processAnimation(e,t){const i=this.json,n=this.nodeMap;i.animations||(i.animations=[]),e=Uo.Utils.mergeMorphTargetTracks(e.clone(),t);const o=e.tracks,s=[],a=[];for(let l=0;l<o.length;++l){const e=o[l],i=se.PropertyBinding.parseTrackName(e.name);let r=se.PropertyBinding.findNode(t,i.nodeName);const d=Po[i.propertyName];if("bones"===i.objectName&&(r=!0===r.isSkinnedMesh?r.skeleton.getBoneByName(i.objectIndex):void 0),!r||!d)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',e.name),null;const c=1;let u,p=e.values.length/e.times.length;d===Po.morphTargetInfluences&&(p/=r.morphTargetInfluences.length),!0===e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(u="CUBICSPLINE",p/=3):u=e.getInterpolation()===se.InterpolateDiscrete?"STEP":"LINEAR",a.push({input:this.processAccessor(new se.BufferAttribute(e.times,c)),output:this.processAccessor(new se.BufferAttribute(e.values,p)),interpolation:u}),s.push({sampler:a.length-1,target:{node:n.get(r),path:d}})}return i.animations.push({name:e.name||"clip_"+i.animations.length,samplers:a,channels:s}),i.animations.length-1}processSkin(e){const t=this.json,i=this.nodeMap,n=t.nodes[i.get(e)],o=e.skeleton;if(void 0===o)return null;const s=e.skeleton.bones[0];if(void 0===s)return null;const a=[],l=new Float32Array(16*o.bones.length),r=new se.Matrix4;for(let c=0;c<o.bones.length;++c)a.push(i.get(o.bones[c])),r.copy(o.boneInverses[c]),r.multiply(e.bindMatrix).toArray(l,16*c);void 0===t.skins&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new se.BufferAttribute(l,16)),joints:a,skeleton:i.get(s)});const d=n.skin=t.skins.length-1;return d}processNode(e){const t=this.json,i=this.options,n=this.nodeMap;t.nodes||(t.nodes=[]);const o={};if(i.trs){const t=e.quaternion.toArray(),i=e.position.toArray(),n=e.scale.toArray();Go(t,[0,0,0,1])||(o.rotation=t),Go(i,[0,0,0])||(o.translation=i),Go(n,[1,1,1])||(o.scale=n)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===Zo(e.matrix)&&(o.matrix=e.matrix.elements);if(""!==e.name&&(o.name=String(e.name)),this.serializeUserData(e,o),e.isMesh||e.isLine||e.isPoints){const t=this.processMesh(e);null!==t&&(o.mesh=t)}else e.isCamera&&(o.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const t=[];for(let n=0,o=e.children.length;n<o;n++){const o=e.children[n];if(o.visible||!1===i.onlyVisible){const e=this.processNode(o);null!==e&&t.push(e)}}t.length>0&&(o.children=t)}this._invokeAll((function(t){t.writeNode&&t.writeNode(e,o)}));const s=t.nodes.push(o)-1;return n.set(e,s),s}processScene(e){const t=this.json,i=this.options;t.scenes||(t.scenes=[],t.scene=0);const n={};""!==e.name&&(n.name=e.name),t.scenes.push(n);const o=[];for(let s=0,a=e.children.length;s<a;s++){const t=e.children[s];if(t.visible||!1===i.onlyVisible){const e=this.processNode(t);null!==e&&o.push(e)}}o.length>0&&(n.nodes=o),this.serializeUserData(e,n)}processObjects(e){const t=new se.Scene;t.name="AuxScene";for(let i=0;i<e.length;i++)t.children.push(e[i]);this.processScene(t)}processInput(e){const t=this.options;e=e instanceof Array?e:[e],this._invokeAll((function(t){t.beforeParse&&t.beforeParse(e)}));const i=[];for(let n=0;n<e.length;n++)e[n]instanceof se.Scene?this.processScene(e[n]):i.push(e[n]);i.length>0&&this.processObjects(i);for(let n=0;n<this.skins.length;++n)this.processSkin(this.skins[n]);for(let n=0;n<t.animations.length;++n)this.processAnimation(t.animations[n],e[0]);this._invokeAll((function(t){t.afterParse&&t.afterParse(e)}))}_invokeAll(e){for(let t=0,i=this.plugins.length;t<i;t++)e(this.plugins[t])}}class Qo{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight)return void console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);const i=this.writer,n=i.json,o=i.extensionsUsed,s={};e.name&&(s.name=e.name),s.color=e.color.toArray(),s.intensity=e.intensity,e.isDirectionalLight?s.type="directional":e.isPointLight?(s.type="point",e.distance>0&&(s.range=e.distance)):e.isSpotLight&&(s.type="spot",e.distance>0&&(s.range=e.distance),s.spot={},s.spot.innerConeAngle=(1-e.penumbra)*e.angle,s.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),o[this.name]||(n.extensions=n.extensions||{},n.extensions[this.name]={lights:[]},o[this.name]=!0);const a=n.extensions[this.name].lights;a.push(s),t.extensions=t.extensions||{},t.extensions[this.name]={light:a.length-1}}}class es{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}writeMaterial(e,t){if(!e.isMeshBasicMaterial)return;const i=this.writer,n=i.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},n[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}class ts{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.clearcoat)return;const i=this.writer,n=i.extensionsUsed,o={};if(o.clearcoatFactor=e.clearcoat,e.clearcoatMap){const t={index:i.processTexture(e.clearcoatMap),texCoord:e.clearcoatMap.channel};i.applyTextureTransform(t,e.clearcoatMap),o.clearcoatTexture=t}if(o.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const t={index:i.processTexture(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};i.applyTextureTransform(t,e.clearcoatRoughnessMap),o.clearcoatRoughnessTexture=t}if(e.clearcoatNormalMap){const t={index:i.processTexture(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};i.applyTextureTransform(t,e.clearcoatNormalMap),o.clearcoatNormalTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class is{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.iridescence)return;const i=this.writer,n=i.extensionsUsed,o={};if(o.iridescenceFactor=e.iridescence,e.iridescenceMap){const t={index:i.processTexture(e.iridescenceMap),texCoord:e.iridescenceMap.channel};i.applyTextureTransform(t,e.iridescenceMap),o.iridescenceTexture=t}if(o.iridescenceIor=e.iridescenceIOR,o.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],o.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const t={index:i.processTexture(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};i.applyTextureTransform(t,e.iridescenceThicknessMap),o.iridescenceThicknessTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class ns{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const i=this.writer,n=i.extensionsUsed,o={};if(o.transmissionFactor=e.transmission,e.transmissionMap){const t={index:i.processTexture(e.transmissionMap),texCoord:e.transmissionMap.channel};i.applyTextureTransform(t,e.transmissionMap),o.transmissionTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class os{constructor(e){this.writer=e,this.name="KHR_materials_volume"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const i=this.writer,n=i.extensionsUsed,o={};if(o.thicknessFactor=e.thickness,e.thicknessMap){const t={index:i.processTexture(e.thicknessMap),texCoord:e.thicknessMap.channel};i.applyTextureTransform(t,e.thicknessMap),o.thicknessTexture=t}o.attenuationDistance=e.attenuationDistance,o.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class ss{constructor(e){this.writer=e,this.name="KHR_materials_ior"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1.5===e.ior)return;const i=this.writer,n=i.extensionsUsed,o={};o.ior=e.ior,t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class as{constructor(e){this.writer=e,this.name="KHR_materials_specular"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1===e.specularIntensity&&e.specularColor.equals(Fo)&&!e.specularIntensityMap&&!e.specularColorTexture)return;const i=this.writer,n=i.extensionsUsed,o={};if(e.specularIntensityMap){const t={index:i.processTexture(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};i.applyTextureTransform(t,e.specularIntensityMap),o.specularTexture=t}if(e.specularColorMap){const t={index:i.processTexture(e.specularColorMap),texCoord:e.specularColorMap.channel};i.applyTextureTransform(t,e.specularColorMap),o.specularColorTexture=t}o.specularFactor=e.specularIntensity,o.specularColorFactor=e.specularColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class ls{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.sheen)return;const i=this.writer,n=i.extensionsUsed,o={};if(e.sheenRoughnessMap){const t={index:i.processTexture(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};i.applyTextureTransform(t,e.sheenRoughnessMap),o.sheenRoughnessTexture=t}if(e.sheenColorMap){const t={index:i.processTexture(e.sheenColorMap),texCoord:e.sheenColorMap.channel};i.applyTextureTransform(t,e.sheenColorMap),o.sheenColorTexture=t}o.sheenRoughnessFactor=e.sheenRoughness,o.sheenColorFactor=e.sheenColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class rs{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.anisotropy)return;const i=this.writer,n=i.extensionsUsed,o={};if(e.anisotropyMap){const t={index:i.processTexture(e.anisotropyMap)};i.applyTextureTransform(t,e.anisotropyMap),o.anisotropyTexture=t}o.anisotropyStrength=e.anisotropy,o.anisotropyRotation=e.anisotropyRotation,t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class ds{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}writeMaterial(e,t){if(!e.isMeshStandardMaterial||1===e.emissiveIntensity)return;const i=this.writer,n=i.extensionsUsed,o={};o.emissiveStrength=e.emissiveIntensity,t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class cs{constructor(e){this.writer=e,this.name="EXT_mesh_gpu_instancing"}writeNode(e,t){if(!e.isInstancedMesh)return;const i=this.writer,n=e,o=new Float32Array(3*n.count),s=new Float32Array(4*n.count),a=new Float32Array(3*n.count),l=new se.Matrix4,r=new se.Vector3,d=new se.Quaternion,c=new se.Vector3;for(let p=0;p<n.count;p++)n.getMatrixAt(p,l),l.decompose(r,d,c),r.toArray(o,3*p),d.toArray(s,4*p),c.toArray(a,3*p);const u={TRANSLATION:i.processAccessor(new se.BufferAttribute(o,3)),ROTATION:i.processAccessor(new se.BufferAttribute(s,4)),SCALE:i.processAccessor(new se.BufferAttribute(a,3))};n.instanceColor&&(u._COLOR_0=i.processAccessor(n.instanceColor)),t.extensions=t.extensions||{},t.extensions[this.name]={attributes:u},i.extensionsUsed[this.name]=!0,i.extensionsRequired[this.name]=!0}}Uo.Utils={insertKeyframe:function(e,t){const i=.001,n=e.getValueSize(),o=new e.TimeBufferType(e.times.length+1),s=new e.ValueBufferType(e.values.length+n),a=e.createInterpolant(new e.ValueBufferType(n));let l;if(0===e.times.length){o[0]=t;for(let e=0;e<n;e++)s[e]=0;l=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<i)return 0;o[0]=t,o.set(e.times,1),s.set(a.evaluate(t),0),s.set(e.values,n),l=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<i)return e.times.length-1;o[o.length-1]=t,o.set(e.times,0),s.set(e.values,0),s.set(a.evaluate(t),e.values.length),l=o.length-1}else for(let r=0;r<e.times.length;r++){if(Math.abs(e.times[r]-t)<i)return r;if(e.times[r]<t&&e.times[r+1]>t){o.set(e.times.slice(0,r+1),0),o[r+1]=t,o.set(e.times.slice(r+1),r+2),s.set(e.values.slice(0,(r+1)*n),0),s.set(a.evaluate(t),(r+1)*n),s.set(e.values.slice((r+1)*n),(r+2)*n),l=r+1;break}}return e.times=o,e.values=s,l},mergeMorphTargetTracks:function(e,t){const i=[],n={},o=e.tracks;for(let s=0;s<o.length;++s){let e=o[s];const a=se.PropertyBinding.parseTrackName(e.name),l=se.PropertyBinding.findNode(t,a.nodeName);if("morphTargetInfluences"!==a.propertyName||void 0===a.propertyIndex){i.push(e);continue}if(e.createInterpolant!==e.InterpolantFactoryMethodDiscrete&&e.createInterpolant!==e.InterpolantFactoryMethodLinear){if(e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),e=e.clone(),e.setInterpolation(se.InterpolateLinear)}const r=l.morphTargetInfluences.length,d=l.morphTargetDictionary[a.propertyIndex];if(void 0===d)throw new Error("THREE.GLTFExporter: Morph target name not found: "+a.propertyIndex);let c;if(void 0===n[l.uuid]){c=e.clone();const t=new c.ValueBufferType(r*c.times.length);for(let e=0;e<c.times.length;e++)t[e*r+d]=c.values[e];c.name=(a.nodeName||"")+".morphTargetInfluences",c.values=t,n[l.uuid]=c,i.push(c);continue}const u=e.createInterpolant(new e.ValueBufferType(1));c=n[l.uuid];for(let t=0;t<c.times.length;t++)c.values[t*r+d]=u.evaluate(c.times[t]);for(let t=0;t<e.times.length;t++){const i=this.insertKeyframe(c,e.times[t]);c.values[i*r+d]=e.values[t]}}return e.tracks=i,e}};const us=new se.Plane,ps=new se.Raycaster,hs=new se.Vector2,ms=new se.Vector3,gs=new se.Vector3,fs=new se.Vector3,_s=new se.Matrix4;class ys extends se.EventDispatcher{constructor(e,t,i){super(),i.style.touchAction="none";let n=null,o=null;const s=[],a=this;function l(){i.addEventListener("pointermove",p),i.addEventListener("pointerdown",h),i.addEventListener("pointerup",m),i.addEventListener("pointerleave",m)}function r(){i.removeEventListener("pointermove",p),i.removeEventListener("pointerdown",h),i.removeEventListener("pointerup",m),i.removeEventListener("pointerleave",m),i.style.cursor=""}function d(){r()}function c(){return e}function u(){return ps}function p(l){if(!1!==a.enabled){if(g(l),ps.setFromCamera(hs,t),n)return ps.ray.intersectPlane(us,gs)&&n.position.copy(gs.sub(ms).applyMatrix4(_s)),void a.dispatchEvent({type:"drag",object:n});if("mouse"===l.pointerType||"pen"===l.pointerType)if(s.length=0,ps.setFromCamera(hs,t),ps.intersectObjects(e,a.recursive,s),s.length>0){const e=s[0].object;us.setFromNormalAndCoplanarPoint(t.getWorldDirection(us.normal),fs.setFromMatrixPosition(e.matrixWorld)),o!==e&&null!==o&&(a.dispatchEvent({type:"hoveroff",object:o}),i.style.cursor="auto",o=null),o!==e&&(a.dispatchEvent({type:"hoveron",object:e}),i.style.cursor="pointer",o=e)}else null!==o&&(a.dispatchEvent({type:"hoveroff",object:o}),i.style.cursor="auto",o=null)}}function h(o){!1!==a.enabled&&(g(o),s.length=0,ps.setFromCamera(hs,t),ps.intersectObjects(e,a.recursive,s),s.length>0&&(n=!0===a.transformGroup?e[0]:s[0].object,us.setFromNormalAndCoplanarPoint(t.getWorldDirection(us.normal),fs.setFromMatrixPosition(n.matrixWorld)),ps.ray.intersectPlane(us,gs)&&(_s.copy(n.parent.matrixWorld).invert(),ms.copy(gs).sub(fs.setFromMatrixPosition(n.matrixWorld))),i.style.cursor="move",a.dispatchEvent({type:"dragstart",object:n})))}function m(){!1!==a.enabled&&(n&&(a.dispatchEvent({type:"dragend",object:n}),n=null),i.style.cursor=o?"pointer":"auto")}function g(e){const t=i.getBoundingClientRect();hs.x=(e.clientX-t.left)/t.width*2-1,hs.y=-(e.clientY-t.top)/t.height*2+1}l(),this.enabled=!0,this.recursive=!0,this.transformGroup=!1,this.activate=l,this.deactivate=r,this.dispose=d,this.getObjects=c,this.getRaycaster=u}}var ws,vs={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2,e<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-vs.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*vs.Bounce.In(2*e):.5*vs.Bounce.Out(2*e-1)+.5}}};ws="undefined"===typeof self&&"undefined"!==typeof process&&process.hrtime?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!==typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()};var bs=ws,xs=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map((function(t){return e._tweens[t]}))},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},e.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},e.prototype.update=function(e,t){void 0===e&&(e=bs()),void 0===t&&(t=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;while(i.length>0){this._tweensAddedDuringUpdate={};for(var n=0;n<i.length;n++){var o=this._tweens[i[n]],s=!t;o&&!1===o.update(e,s)&&!t&&delete this._tweens[i[n]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),Ms={Linear:function(e,t){var i=e.length-1,n=i*t,o=Math.floor(n),s=Ms.Utils.Linear;return t<0?s(e[0],e[1],n):t>1?s(e[i],e[i-1],i-n):s(e[o],e[o+1>i?i:o+1],n-o)},Bezier:function(e,t){for(var i=0,n=e.length-1,o=Math.pow,s=Ms.Utils.Bernstein,a=0;a<=n;a++)i+=o(1-t,n-a)*o(t,a)*e[a]*s(n,a);return i},CatmullRom:function(e,t){var i=e.length-1,n=i*t,o=Math.floor(n),s=Ms.Utils.CatmullRom;return e[0]===e[i]?(t<0&&(o=Math.floor(n=i*(1+t))),s(e[(o-1+i)%i],e[o],e[(o+1)%i],e[(o+2)%i],n-o)):t<0?e[0]-(s(e[0],e[0],e[1],e[1],-n)-e[0]):t>1?e[i]-(s(e[i],e[i],e[i-1],e[i-1],n-i)-e[i]):s(e[o?o-1:0],e[o],e[i<o+1?i:o+1],e[i<o+2?i:o+2],n-o)},Utils:{Linear:function(e,t,i){return(t-e)*i+e},Bernstein:function(e,t){var i=Ms.Utils.Factorial;return i(e)/i(t)/i(e-t)},Factorial:function(){var e=[1];return function(t){var i=1;if(e[t])return e[t];for(var n=t;n>1;n--)i*=n;return e[t]=i,i}}(),CatmullRom:function(e,t,i,n,o){var s=.5*(i-e),a=.5*(n-t),l=o*o,r=o*l;return(2*t-2*i+s+a)*r+(-3*t+3*i-2*s-a)*l+s*o+t}}},Cs=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),Ls=new xs,ks=function(){function e(e,t){void 0===t&&(t=Ls),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=vs.Linear.None,this._interpolationFunction=Ms.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=Cs.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.to=function(e,t){return this._valuesEnd=Object.create(e),void 0!==t&&(this._duration=t),this},e.prototype.duration=function(e){return this._duration=e,this},e.prototype.start=function(e){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var t in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(t),this._valuesStart[t]=this._valuesStartRepeat[t];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==e?"string"===typeof e?bs()+parseFloat(e):e:bs(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},e.prototype._setupProperties=function(e,t,i,n){for(var o in i){var s=e[o],a=Array.isArray(s),l=a?"array":typeof s,r=!a&&Array.isArray(i[o]);if("undefined"!==l&&"function"!==l){if(r){var d=i[o];if(0===d.length)continue;d=d.map(this._handleRelativeValue.bind(this,s)),i[o]=[s].concat(d)}if("object"!==l&&!a||!s||r)"undefined"===typeof t[o]&&(t[o]=s),a||(t[o]*=1),n[o]=r?i[o].slice().reverse():t[o]||0;else{for(var c in t[o]=a?[]:{},s)t[o][c]=s[c];n[o]=a?[]:{},this._setupProperties(s,t[o],i[o],n[o])}}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(e){return void 0===e&&(e=bs()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},e.prototype.resume=function(e){return void 0===e&&(e=bs()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},e.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},e.prototype.group=function(e){return this._group=e,this},e.prototype.delay=function(e){return this._delayTime=e,this},e.prototype.repeat=function(e){return this._initialRepeat=e,this._repeat=e,this},e.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},e.prototype.yoyo=function(e){return this._yoyo=e,this},e.prototype.easing=function(e){return this._easingFunction=e,this},e.prototype.interpolation=function(e){return this._interpolationFunction=e,this},e.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},e.prototype.onStart=function(e){return this._onStartCallback=e,this},e.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},e.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},e.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},e.prototype.onStop=function(e){return this._onStopCallback=e,this},e.prototype.update=function(e,t){if(void 0===e&&(e=bs()),void 0===t&&(t=!0),this._isPaused)return!0;var i,n,o=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>o)return!1;t&&this.start(e)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),n=(e-this._startTime)/this._duration,n=0===this._duration||n>1?1:n;var s=this._easingFunction(n);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,s),this._onUpdateCallback&&this._onUpdateCallback(this._object,n),1===n){if(this._repeat>0){for(i in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!==typeof this._valuesEnd[i]||(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,l=this._chainedTweens.length;a<l;a++)this._chainedTweens[a].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(e,t,i,n){for(var o in i)if(void 0!==t[o]){var s=t[o]||0,a=i[o],l=Array.isArray(e[o]),r=Array.isArray(a),d=!l&&r;d?e[o]=this._interpolationFunction(a,n):"object"===typeof a&&a?this._updateProperties(e[o],s,a,n):(a=this._handleRelativeValue(s,a),"number"===typeof a&&(e[o]=s+(a-s)*n))}},e.prototype._handleRelativeValue=function(e,t){return"string"!==typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},e.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];this._valuesStartRepeat[e]="string"===typeof i?this._valuesStartRepeat[e]+parseFloat(i):this._valuesEnd[e],this._valuesEnd[e]=t},e}(),As="18.6.4",Ss=Cs.nextId,Ts=Ls,Ws=Ts.getAll.bind(Ts),Is=Ts.removeAll.bind(Ts),Us=Ts.add.bind(Ts),Es=Ts.remove.bind(Ts),Rs=Ts.update.bind(Ts),Vs={Easing:vs,Group:xs,Interpolation:Ms,now:bs,Sequence:Cs,nextId:Ss,Tween:ks,VERSION:As,getAll:Ws,removeAll:Is,add:Us,remove:Es,update:Rs},Ps=Vs,Fs=i(7627);class Hs{constructor(e){(0,uo.Z)(this,"container",void 0),(0,uo.Z)(this,"camera",void 0),(0,uo.Z)(this,"scene",void 0),(0,uo.Z)(this,"renderer",void 0),(0,uo.Z)(this,"controls",void 0),(0,uo.Z)(this,"model",void 0),(0,uo.Z)(this,"geometryGroup",void 0),(0,uo.Z)(this,"geometryModel",void 0),(0,uo.Z)(this,"loadingManager",void 0),(0,uo.Z)(this,"fileLoaderMap",void 0),(0,uo.Z)(this,"modelAnimation",void 0),(0,uo.Z)(this,"animationMixer",void 0),(0,uo.Z)(this,"animationColock",void 0),(0,uo.Z)(this,"animationFrame",void 0),(0,uo.Z)(this,"rotationAnimationFrame",void 0),(0,uo.Z)(this,"animateClipAction",void 0),(0,uo.Z)(this,"loopMap",void 0),(0,uo.Z)(this,"skeletonHelper",void 0),(0,uo.Z)(this,"gridHelper",void 0),(0,uo.Z)(this,"axesHelper",void 0),(0,uo.Z)(this,"ambientLight",void 0),(0,uo.Z)(this,"directionalLight",void 0),(0,uo.Z)(this,"directionalLightHelper",void 0),(0,uo.Z)(this,"pointLight",void 0),(0,uo.Z)(this,"pointLightHelper",void 0),(0,uo.Z)(this,"spotLight",void 0),(0,uo.Z)(this,"spotLightHelper",void 0),(0,uo.Z)(this,"planeGeometry",void 0),(0,uo.Z)(this,"modelMaterialList",void 0),(0,uo.Z)(this,"effectComposer",void 0),(0,uo.Z)(this,"outlinePass",void 0),(0,uo.Z)(this,"renderAnimation",void 0),(0,uo.Z)(this,"raycaster",void 0),(0,uo.Z)(this,"mouse",void 0),(0,uo.Z)(this,"modelTextureMap",void 0),(0,uo.Z)(this,"glowComposer",void 0),(0,uo.Z)(this,"unrealBloomPass",void 0),(0,uo.Z)(this,"shaderPass",void 0),(0,uo.Z)(this,"glowMaterialList",void 0),(0,uo.Z)(this,"materials",void 0),(0,uo.Z)(this,"dragControls",void 0),(0,uo.Z)(this,"glowUnrealBloomPass",void 0),(0,uo.Z)(this,"onWindowResizesListener",void 0),(0,uo.Z)(this,"onMouseClickListener",void 0),(0,uo.Z)(this,"modelProgressCallback",void 0),(0,uo.Z)(this,"dragGeometryModel",void 0),this.container=document.querySelector(e),this.camera,this.scene,this.renderer,this.controls,this.model,this.geometryGroup=new se.Group,this.geometryModel,this.loadingManager=new se.LoadingManager,this.fileLoaderMap={glb:new ho.E,fbx:new xo.y(this.loadingManager),gltf:new ho.E,obj:new bo.L(this.loadingManager)},this.modelAnimation,this.animationMixer,this.animationColock=new se.Clock,this.animationFrame=null,this.rotationAnimationFrame=null,this.animateClipAction=null,this.loopMap={LoopOnce:se.LoopOnce,LoopRepeat:se.LoopRepeat,LoopPingPong:se.LoopPingPong},this.skeletonHelper,this.gridHelper,this.axesHelper,this.ambientLight,this.directionalLight,this.directionalLightHelper,this.pointLight,this.pointLightHelper,this.spotLight,this.spotLightHelper,this.planeGeometry,this.modelMaterialList,this.effectComposer,this.outlinePass,this.renderAnimation=null,this.raycaster=new se.Raycaster,this.mouse=new se.Vector2,this.modelTextureMap,this.glowComposer,this.shaderPass,this.unrealBloomPass,this.glowMaterialList,this.materials={},this.dragControls,this.glowUnrealBloomPass=!1,this.onWindowResizesListener,this.onMouseClickListener,this.modelProgressCallback=e=>e,this.dragGeometryModel={}}init(){return new Promise((async e=>{this.initRender(),this.initCamera(),this.initScene(),this.initControls(),this.createHelper(),this.createLight(),this.addEvenListMouseLisatener();const t={filePath:"threeFile/glb/glb-9.glb",fileType:"glb",map:null,scale:null,position:null,decomposeName:"transformers_3"},i=await this.setModel(t);this.createEffectComposer(),this.sceneAnimation(),e(i)}))}initScene(){this.scene=new se.Scene;const e=(new se.TextureLoader).load(i(72));e.mapping=se.EquirectangularReflectionMapping,this.scene.background=e,this.scene.environment=e}initCamera(){const{clientHeight:e,clientWidth:t}=this.container;this.camera=new se.PerspectiveCamera(50,t/e,.25,2e3)}initRender(){this.renderer=new se.WebGLRenderer({antialias:!0,alpha:!0,preserveDrawingBuffer:!0}),this.renderer.setPixelRatio(window.devicePixelRatio);const{clientHeight:e,clientWidth:t}=this.container;this.renderer.setSize(t,e),this.renderer.toneMapping=se.ReinhardToneMapping,this.renderer.autoClear=!0,this.renderer.outputColorSpace=se.SRGBColorSpace,this.renderer.toneMappingExposure=2,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=se.PCFSoftShadowMap,this.container.appendChild(this.renderer.domElement)}sceneAnimation(){this.renderAnimation=requestAnimationFrame((()=>this.sceneAnimation())),this.scene.traverse((e=>{e instanceof se.Scene&&(this.materials.scene=e.background,e.background=null),!this.glowMaterialList.includes(e.name)&&e.isMesh&&(this.materials[e.uuid]=e.material,e.material=new se.MeshStandardMaterial({color:"black"}))})),this.glowComposer.render(),this.scene.traverse((e=>{this.materials[e.uuid]&&(e.material=this.materials[e.uuid],delete this.materials[e.uuid]),e instanceof se.Scene&&(e.background=this.materials.scene,delete this.materials.scene)})),this.controls.update(),Ps.update(),this.effectComposer.render()}addEvenListMouseLisatener(){this.onWindowResizesListener=this.onWindowResizes.bind(this),window.addEventListener("resize",this.onWindowResizesListener),this.onMouseClickListener=this.onMouseClickModel.bind(this),this.container.addEventListener("click",this.onMouseClickListener)}initControls(){this.controls=new po.z(this.camera,this.renderer.domElement),this.controls.enablePan=!1}setModel(e){const{filePath:t,fileType:i,scale:n,map:o,position:s,decomposeName:a}=e;return new Promise((e=>{let l;if(["glb","gltf"].includes(i)){const e=new Co;e.setDecoderPath("draco/gltf/"),e.setDecoderConfig({type:"js"}),e.preload(),l=(new ho.E).setDRACOLoader(e)}else l=this.fileLoaderMap[i];l.load(t,(t=>{switch(i){case"glb":this.model=t.scene,this.skeletonHelper=new se.SkeletonHelper(t.scene);break;case"fbx":this.model=t,this.skeletonHelper=new se.SkeletonHelper(t);break;case"gltf":this.model=t.scene,this.skeletonHelper=new se.SkeletonHelper(t.scene);break;case"obj":this.model=t,this.skeletonHelper=new se.SkeletonHelper(t);break;default:break}if(this.modelAnimation=t.animations||[],this.model.decomposeName=a,this.getModelMeaterialList(),this.setModelPositionSize(),n&&this.model.scale.set(n,n,n),this.model.position.set(0,-.5,0),s){const{x:e,y:t,z:i}=s;this.model.position.set(e,t,i)}this.skeletonHelper.visible=!1,this.scene.add(this.skeletonHelper),this.glowMaterialList=this.modelMaterialList.map((e=>e.name)),this.scene.add(this.model),this.getModelMeaterialMaps(o),e(!0)}),(e=>{this.modelProgressCallback(e.loaded)}),(t=>{ae.z8.error("文件错误"),console.log(t),e(!0)}))}))}setGeometryModel(e){return new Promise((t=>{const{clientHeight:i,clientWidth:n,offsetLeft:o,offsetTop:s}=this.container;if(!this.mouse)return!1;this.mouse.x=(e.clientX-o)/n*2-1,this.mouse.y=-(e.clientY-s)/i*2+1,this.raycaster.setFromCamera(this.mouse,this.camera);const a=this.raycaster.intersectObjects(this.scene.children,!0);if(a.length>0){const i=["id","name","modelType","type"],n=Object.keys(e).filter((e=>!i.includes(e))).map((t=>e[t])),{type:o}=e,s=new se[o](...n),l=["#FF4500","#90EE90","#00CED1","#1E90FF","#C71585","#FF4500","#FAD400","#1F93FF","#90F090","#C71585"],r=l[Math.ceil(10*Math.random())],c=new se.MeshStandardMaterial({color:new se.Color(r),side:se.DoubleSide}),u=new se.Mesh(s,c),{x:p,y:h,z:m}=a[0].point;u.position.set(p,h,m),u.name=o+"_"+(0,d.d1)(4,5),u.userData.geometry=!0,this.geometryGroup.add(u),this.model=this.geometryGroup,this.onSetGeometryMeshList(u),this.skeletonHelper.visible=!1,this.skeletonHelper.dispose(),this.glowMaterialList=this.modelMaterialList.map((e=>e.name)),this.setModelMeshDrag({modelDrag:!0}),this.scene.add(this.model);const g=(new se.Box3).setFromObject(this.model),f=g.getSize(new se.Vector3);this.controls.maxDistance=10*f.length(),t(!0)}else ae.z8.warning("当前角度无法获取鼠标位置请调整“相机角度”在添加")}))}onProgress(e){"function"==typeof e&&(this.modelProgressCallback=e)}createHelper(){this.gridHelper=new se.GridHelper(4,10,"rgb(193,193,193)","rgb(193,193,193)"),this.gridHelper.position.set(0,-.59,-.1),this.gridHelper.visible=!1,this.scene.add(this.gridHelper),this.axesHelper=new se.AxesHelper(2),this.axesHelper.visible=!1,this.scene.add(this.axesHelper),this.renderer.shadowMap.enabled=!0}createLight(){this.ambientLight=new se.AmbientLight("#fff",.8),this.scene.add(this.ambientLight),this.directionalLight=new se.DirectionalLight("#fff",5),this.directionalLight.position.set(-1.44,2.2,1),this.directionalLight.castShadow=!0,this.directionalLight.visible=!1,this.scene.add(this.directionalLight),this.directionalLightHelper=new se.DirectionalLightHelper(this.directionalLight,.3),this.directionalLightHelper.visible=!1,this.scene.add(this.directionalLightHelper),this.pointLight=new se.PointLight(16711680,5,100),this.pointLight.visible=!1,this.scene.add(this.pointLight),this.pointLightHelper=new se.PointLightHelper(this.pointLight,.5),this.pointLightHelper.visible=!1,this.scene.add(this.pointLightHelper),this.spotLight=new se.SpotLight("#00BABD",900),this.spotLight.visible=!1,this.spotLight.map=(new se.TextureLoader).load(i(8208)),this.spotLight.decay=2,this.spotLight.shadow.mapSize.width=1920,this.spotLight.shadow.mapSize.height=1080,this.spotLight.shadow.camera.near=1,this.spotLight.shadow.camera.far=10,this.scene.add(this.spotLight),this.spotLightHelper=new se.SpotLightHelper(this.spotLight),this.spotLightHelper.visible=!1,this.scene.add(this.spotLightHelper);const e=new se.PlaneGeometry(4,4);var t=new se.MeshStandardMaterial({color:"#000000"});this.planeGeometry=new se.Mesh(e,t),this.planeGeometry.name="planeGeometry",this.planeGeometry.rotation.x=-Math.PI/2,this.planeGeometry.position.set(0,-.5,0),this.planeGeometry.receiveShadow=!0,this.planeGeometry.visible=!1,this.scene.add(this.planeGeometry)}createEffectComposer(){const{clientHeight:e,clientWidth:t}=this.container;this.effectComposer=new mo.x(this.renderer);const i=new go.C(this.scene,this.camera);this.effectComposer.addPass(i),this.outlinePass=new fo.f(new se.Vector2(t,e),this.scene,this.camera),this.outlinePass.visibleEdgeColor=new se.Color("#FF8C00"),this.outlinePass.hiddenEdgeColor=new se.Color("#8a90f3"),this.outlinePass.edgeGlow=2,this.outlinePass.usePatternTexture=!1,this.outlinePass.edgeThickness=1,this.outlinePass.edgeStrength=4,this.outlinePass.pulsePeriod=100,this.effectComposer.addPass(this.outlinePass);let n=new _o.v;this.effectComposer.addPass(n);let o=new yo.T(wo.C);const s=this.renderer.getPixelRatio();o.uniforms.resolution.value.set(1/(t*s),1/(e*s)),o.renderToScreen=!0,o.needsSwap=!0,this.effectComposer.addPass(o),this.unrealBloomPass=new vo.m(new se.Vector2(t,e),1.5,.4,.85);const a={minFilter:se.LinearFilter,format:se.RGBAFormat,stencilBuffer:!1},l=new se.WebGLRenderTarget(2*t,2*e,a);this.glowComposer=new mo.x(this.renderer,l),this.glowComposer.renderToScreen=!1,this.glowComposer.addPass(new go.C(this.scene,this.camera)),this.glowComposer.addPass(this.unrealBloomPass),this.shaderPass=new yo.T(new se.ShaderMaterial({uniforms:{baseTexture:{value:null},bloomTexture:{value:this.glowComposer.renderTarget2.texture},tDiffuse:{value:null},glowColor:{value:null}},vertexShader:H.C7,fragmentShader:H.zH,defines:{}}),"baseTexture"),this.shaderPass.material.uniforms.glowColor.value=new se.Color,this.shaderPass.renderToScreen=!0,this.shaderPass.needsSwap=!0,this.effectComposer.addPass(this.shaderPass)}onSwitchModel(e){return new Promise((async(t,i)=>{try{if(e.modelType&&"geometry"==e.modelType){this.modelAnimation=[],this.camera.fov=80,this.camera.updateProjectionMatrix();const i=await this.setGeometryModel(e);t(i)}else{this.clearSceneModel(),this.onResettingLight({ambientLight:!0}),this.camera.fov=50,this.geometryGroup.clear();const i=await this.setModel(e);t({load:i,filePath:e.filePath})}}catch{i()}}))}onWindowResizes(){if(!this.container)return!1;const{clientHeight:e,clientWidth:t}=this.container;this.camera.aspect=t/e,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,e),this.effectComposer.setSize(2*t,2*e),this.glowComposer.setSize(t,e)}onDownloadScenCover(){var e=document.createElement("a"),t=this.renderer.domElement;e.href=t.toDataURL("image/png"),e.download=`${(new Date).toLocaleString()}.png`,e.click(),ae.z8.success("下载成功")}onExporterModel(e){const t=new Uo,i={trs:!0,animations:this.modelAnimation,binary:"glb"==e,embedImages:!0,onlyVisible:!0,includeCustomExtensions:!0};t.parse(this.scene,(function(e){function t(e,t){const i=new Blob([e],{type:"application/octet-stream"}),n=URL.createObjectURL(i),o=document.createElement("a");o.href=n,o.download=t,o.click(),URL.revokeObjectURL(n),ae.z8.success("导出成功")}function i(e,t){const i=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(i),o=document.createElement("a");o.href=n,o.download=t,o.click(),URL.revokeObjectURL(n),ae.z8.success("导出成功")}e instanceof ArrayBuffer?t(e,`${(new Date).toLocaleString()}.glb`):i(JSON.stringify(e),`${(new Date).toLocaleString()}.gltf`)}),(e=>{ae.z8.error(e)}),i)}onClearModelData(){cancelAnimationFrame(this.rotationAnimationFrame),cancelAnimationFrame(this.renderAnimation),cancelAnimationFrame(this.animationFrame),this.container.removeEventListener("click",this.onMouseClickListener),window.removeEventListener("resize",this.onWindowResizesListener),this.scene.traverse((e=>{"Mesh"===e.type&&(e.geometry.dispose(),e.material.dispose())})),this.scene.clear(),this.renderer.dispose(),this.renderer.clear(),this.container=null,this.camera=null,this.scene=null,this.renderer=null,this.controls=null,this.model=null,this.geometryModel=null,this.fileLoaderMap={},this.modelAnimation=null,this.animationMixer=null,this.animationColock=null,this.animationFrame=null,this.rotationAnimationFrame=null,this.animateClipAction=null,this.loopMap={},this.skeletonHelper=null,this.gridHelper=null,this.axesHelper=null,this.ambientLight=null,this.directionalLight=null,this.directionalLightHelper=null,this.pointLight=null,this.pointLightHelper=null,this.spotLight=null,this.spotLightHelper=null,this.planeGeometry=null,this.modelMaterialList=null,this.effectComposer=null,this.outlinePass=null,this.renderAnimation=null,this.raycaster,this.mouse=null,this.modelTextureMap=null,this.glowComposer=null,this.unrealBloomPass=null,this.shaderPass=null,this.glowMaterialList=[],this.materials={},this.dragControls=null,this.dragGeometryModel={}}clearSceneModel(){this.scene.traverse((e=>{"Mesh"===e.type&&(e.geometry.dispose(),e.material.dispose())})),this.dragGeometryModel={},cancelAnimationFrame(this.animationFrame),cancelAnimationFrame(this.rotationAnimationFrame),this.scene.remove(this.model),this.model=null,this.modelTextureMap=[],this.glowMaterialList=[],this.modelMaterialList=[],this.materials={},this.dragControls&&this.dragControls.dispose(),this.renderer.toneMappingExposure=2,Object.assign(this.unrealBloomPass,{threshold:0,strength:0,radius:0}),this.skeletonHelper.visible=!1;const e={gridHelper:!1,x:0,y:-.59,z:-.1,positionX:0,positionY:-.5,positionZ:0,divisions:10,size:4,color:"rgb(193,193,193)",axesHelper:!1,axesSize:1.8};this.onResettingLight({ambientLight:!1}),this.onSetModelGridHelper(e),this.onSetModelGridHelperSize(e),this.onSetModelAxesHelper(e)}setDragGeometryModel(e){this.dragGeometryModel=e}onSetSceneColor(e){this.scene.background=new se.Color(e)}onSetSceneImage(e){this.scene.background=(new se.TextureLoader).load(e)}onSetSceneViewImage(e){const t=(new se.TextureLoader).load(e);t.mapping=se.EquirectangularReflectionMapping,this.scene.background=t,this.scene.environment=t}getModelMeaterialList(){this.modelMaterialList=[],this.model.traverse((e=>{if(e.isMesh&&(e.castShadow=!0,e.frustumCulled=!1,e.material)){const t=e.material.clone();e.material=t,this.modelMaterialList.push(e)}}))}getModelMeaterialMaps(e){this.modelTextureMap=[];const t=new Set;this.model.traverse((e=>{if(e.isMesh){const i=Array.isArray(e.material)?e.material:[e.material];i.forEach((e=>t.add(e)))}}));const i=t.size;if(i>100)return co.T.alert(`当前模型材质数量过大“${i}个”，编辑器页面可能有卡顿`,"提示",{confirmButtonText:"确认",type:"warning"}),this.modelTextureMap=null;const n=!!e;let o=0;this.model.traverse((t=>{const{uuid:i}=t;if(t.isMesh&&t.material){o++;const s=Array.isArray(t.material)?t.material:[t.material],{url:a,mapId:l}=this.getModelMaps(s,i),r={meshName:t.name,material:t.material,url:a,mapId:l+"_"+o};if(t.mapId=l+"_"+o,this.modelTextureMap.push(r),n){const n=(new se.TextureLoader).load(e),s=t.material.clone();t.material=s,t.material.map=n,t.mapId=i+"_"+o,this.modelTextureMap=[{meshName:t.name,material:t.material,url:e,mapId:i+"_"+o}]}}}))}setModelPositionSize(){this.model.updateMatrixWorld();const e=(new se.Box3).setFromObject(this.model),t=e.getSize(new se.Vector3),i=e.getCenter(new se.Vector3),n=Math.max(t.x,t.y,t.z),o=2.5,s=o/(n>1?n:.5);this.model.scale.set(s,s,s),this.controls.maxDistance=10*t.length(),this.camera.position.set(0,2,6),this.camera.lookAt(i),this.camera.updateProjectionMatrix()}getModelMaps(e,t){let i={};return e.forEach((e=>{if(e.map&&e.map.image){const t=document.createElement("canvas");t.width=75,t.height=75;const n=t.getContext("2d");n.drawImage(e.map.image,0,0),i={url:t.toDataURL("image/png",.5)},t.remove()}})),i}onSetModelMaterial(e){const{color:t,wireframe:i,depthWrite:n,opacity:o}=JSON.parse(JSON.stringify(e)),s=Fs.Z.state.selectMesh.uuid,a=this.scene.getObjectByProperty("uuid",s);if(a&&a.material){const{name:e,map:s}=a.material;Object.assign(a.material,{map:s,name:e,transparent:!0,color:new se.Color(t),wireframe:i,depthWrite:n,opacity:o})}}onSetModelMap(e){const{material:t,mapId:i,meshName:n}=e,o=Fs.Z.state.selectMesh.uuid,s=this.scene.getObjectByProperty("uuid",o);s.material=t.clone(),s.mapId=i,s.meshFrom=n}onSetSystemModelMap(e){const{id:t,url:i}=e,n=Fs.Z.state.selectMesh.uuid,o=this.scene.getObjectByProperty("uuid",n),s=(new se.TextureLoader).load(i),a=o.material.clone();a.map=s,o.material=a,o.mapId=t,o.meshFrom=t}onChangeModelMeaterial(e){const t=this.model.getObjectByName(e);return this.outlinePass.selectedObjects=[t],Fs.Z.commit("SELECT_MESH",t),t}onMouseClickModel(e){const{clientHeight:t,clientWidth:i,offsetLeft:n,offsetTop:o}=this.container;if(!this.mouse)return!1;this.mouse.x=(e.clientX-n)/i*2-1,this.mouse.y=-(e.clientY-o)/t*2+1,this.raycaster.setFromCamera(this.mouse,this.camera);const s=this.raycaster.intersectObjects(this.scene.children).filter((e=>"Mesh"==e.object.type));if(s.length>0){const e=s[0].object;this.outlinePass.selectedObjects=[e],Fs.Z.commit("SELECT_MESH",e)}else this.outlinePass.selectedObjects=[],Fs.Z.commit("SELECT_MESH",{})}onGetEditMeshList(){const e=[];return this.model.traverse((t=>{if(t.isMesh&&t.material){const{color:i,opacity:n,depthWrite:o,wireframe:s}=t.material,a={meshName:t.name,meshFrom:t.meshFrom,color:i.getStyle(),opacity:n,depthWrite:o,wireframe:s,visible:t.visible,type:t.material.type};e.push(a)}})),e}onChangeModelMeshType(e){this.model.traverse((t=>{if(t.isMesh&&t.material){const{name:i,color:n,map:o,wireframe:s,depthWrite:a,opacity:l}=t.material;t.material=new se[e.type]({map:o,transparent:!0,color:n,name:i}),a&&(t.material.depthWrite=a),l&&(t.material.opacity=l),s&&(t.material.wireframe=s)}}))}onSetGeometryMeshList(e){this.modelMaterialList=[],this.modelTextureMap=[],this.model.traverse((e=>{const{uuid:t,name:i}=e;if(e.castShadow=!0,e.frustumCulled=!1,e.isMesh&&e.material){const n=Array.isArray(e.material)?e.material:[e.material];this.modelMaterialList.push(e);const{url:o}=this.getModelMaps(n,t),s={meshName:e.name,material:e.material,url:o,mapId:i};e.mapId=i,this.modelTextureMap.push(s)}}))}onSetUnrealBloomPass(e){const{glow:t,threshold:i,strength:n,radius:o,toneMappingExposure:s,color:a}=e;this.glowUnrealBloomPass=t,t?(this.unrealBloomPass.threshold=i,this.unrealBloomPass.strength=n,this.unrealBloomPass.radius=o,this.renderer.toneMappingExposure=s,this.shaderPass.material.uniforms.glowColor.value=new se.Color(a)):(this.unrealBloomPass.threshold=0,this.unrealBloomPass.strength=0,this.unrealBloomPass.radius=0,this.renderer.toneMappingExposure=s,this.shaderPass.material.uniforms.glowColor.value=new se.Color)}setModelMeshDecompose(e){const{decompose:t}=e;if(this.glowMaterialList.length<=1)return!1;const i=(e,t)=>{const i=new Ps.Tween(e.position);i.to(t,500),i.onUpdate((function(t){e.position.set(t.x||0,t.y||0,t.z||0)})),i.start()},n=this.glowMaterialList.length,o=2*Math.PI/n;this.glowMaterialList.forEach(((e,n)=>{const s=this.model.getObjectByName(e),{decomposeName:a}=this.model;if("Mesh"==s.type)if(H.lY[a]&&H.lY[a][e]){const n={x:0,y:0,z:0},{x:o,y:l,z:r}=H.lY[a][e];"straight"==o?n.x+=t:"burden"==o&&(n.x-=t),"straight"==l?n.y+=t:"burden"==l&&(n.y-=t),"straight"==r?n.z+=t:"burden"==r&&(n.z-=t),i(s,n)}else{const e=n*o,a=t*Math.cos(e),l=t*Math.sin(e),r={x:a,y:l,z:0};i(s,r)}}))}setModelMeshDrag(e){const{modelDrag:t}=e;this.dragControls&&this.dragControls.dispose(),t&&(this.dragControls=new ys(this.modelMaterialList,this.camera,this.renderer.domElement),this.dragControls.addEventListener("dragstart",(()=>{this.controls.enabled=!1})),this.dragControls.addEventListener("dragend",(()=>{this.controls.enabled=!0})))}getMeshDragPosition(){const e=[];return this.modelMaterialList.forEach((t=>{const i=this.model.getObjectByProperty("name",t.name),n={name:t.name,...i.position};e.push(n)})),e}onSetFlowColor(e){this.shaderPass.material.uniforms.glowColor.value=new se.Color(e)}onSetModelAmbientLight(e){const{ambientLight:t,ambientLightIntensity:i,ambientLightColor:n}=e;this.ambientLight.visible=t,this.ambientLight.intensity=i,this.ambientLight.color.set(n)}onSetModelDirectionalLight(e){const{directionaShadow:t,directionalHorizontal:i,directionalVertical:n,directionalSistance:o,directionalLight:s,directionalLightColor:a,directionalLightIntensity:l,directionalLightHelper:r}=e;this.directionalLight.visible=s,this.directionalLightHelper.visible=r&&s,this.directionalLight.intensity=l,this.directionalLight.castShadow=t,this.directionalLight.color.set(a);const{x:c,y:u,z:p}=(0,d.E3)(i,n,o);this.directionalLight.position.set(c,u,p),this.directionalLightHelper.update()}onSetModelPointLight(e){const{pointHorizontal:t,pointVertical:i,pointSistance:n,pointLight:o,pointLightColor:s,pointLightIntensity:a,pointLightHelper:l}=e;this.pointLight.visible=o,this.pointLightHelper.visible=o&&l,this.pointLight.intensity=a,this.pointLight.color.set(s);const{x:r,y:c,z:u}=(0,d.E3)(t,i,n);this.pointLight.position.set(r,c,u),this.pointLightHelper.update()}onSetModelSpotLight(e){const{spotDistance:t,spotCastShadow:i,spotLightHelper:n,spotFocus:o,spotPenumbra:s,spotAngle:a,spotLight:l,spotLightColor:r,spotLightIntensity:c,spotHorizontal:u,spotVertical:p,spotSistance:h}=e;this.spotLight.visible=l,this.spotLightHelper.visible=l&&n,this.spotLight.intensity=c,this.spotLight.angle=a,this.spotLight.penumbra=s,this.spotLight.shadow.focus=o,this.spotLight.castShadow=i,this.spotLight.distance=t,this.spotLight.color.set(r);const{x:m,y:g,z:f}=(0,d.E3)(u,p,h);this.spotLight.position.set(m,g,f),this.spotLightHelper.update()}onSetModelPlaneGeometry(e){const{planeGeometry:t,planeColor:i,planeWidth:n,planeHeight:o}=e;this.planeGeometry.visible=t,this.planeGeometry.geometry=new se.PlaneGeometry(n,o),this.planeGeometry.material.color.set(i),this.planeGeometry.geometry.verticesNeedUpdate=!0}onResettingLight(e){const{ambientLight:t}=e,i={planeGeometry:!1,planeColor:"#939393",planeWidth:7,planeHeight:7,ambientLight:t,ambientLightColor:"#fff",ambientLightIntensity:.8,directionalLight:!1,directionalLightHelper:!0,directionalLightColor:"#1E90FF",directionalLightIntensity:1,directionalHorizontal:-1.26,directionalVertical:-3.85,directionalSistance:2.98,directionaShadow:!0,pointLight:!1,pointLightHelper:!0,pointLightColor:"#1E90FF",pointLightIntensity:1,pointHorizontal:-4.21,pointVertical:-4.1,pointSistance:2.53,spotLight:!1,spotLightColor:"#323636",spotLightIntensity:400,spotHorizontal:-3.49,spotVertical:-4.37,spotSistance:4.09,spotAngle:.5,spotPenumbra:1,spotFocus:1,spotCastShadow:!0,spotLightHelper:!0,spotDistance:20};this.onSetModelAmbientLight(i),this.onSetModelDirectionalLight(i),this.onSetModelPointLight(i),this.onSetModelSpotLight(i),this.onSetModelPlaneGeometry(i)}onStartModelAnimaion(e){this.onSetModelAnimaion(e),cancelAnimationFrame(this.animationFrame),this.animationFrameFun()}onSetModelAnimaion(e){const{animationName:t,loop:i,timeScale:n,weight:o}=e;this.animationMixer=new se.AnimationMixer(this.model);const s=se.AnimationClip.findByName(this.modelAnimation,t);s&&(this.animateClipAction=this.animationMixer.clipAction(s),this.animateClipAction&&(this.animateClipAction.setEffectiveTimeScale(n),this.animateClipAction.setEffectiveWeight(o),this.animateClipAction.setLoop(this.loopMap[i]),this.animateClipAction.play()))}animationFrameFun(){this.animationFrame=requestAnimationFrame((()=>this.animationFrameFun())),this.animationMixer&&this.animationColock&&this.animationMixer.update(this.animationColock.getDelta())}onClearAnimation(){this.animateClipAction&&(this.animationMixer.stopAllAction(),this.animationMixer.update(0),cancelAnimationFrame(this.animationFrame))}onSetRotation(e){const{rotationVisible:t,rotationType:i,rotationSpeed:n}=e;t?(cancelAnimationFrame(this.rotationAnimationFrame),this.rotationAnimationFun(i,n)):(cancelAnimationFrame(this.rotationAnimationFrame),this.model.rotation.set(0,0,0))}onSetRotationType(e){const{rotationType:t,rotationSpeed:i}=e;this.model.rotation.set(0,0,0),cancelAnimationFrame(this.rotationAnimationFrame),this.rotationAnimationFun(t,i)}rotationAnimationFun(e,t){this.rotationAnimationFrame=requestAnimationFrame((()=>this.rotationAnimationFun(e,t))),this.model.rotation[e]+=t/50}onSetModelHelper(e){this.skeletonHelper.visible=e}onSetModelRotateOnAxis(e,t){const i=Math.PI/2,{x:n,y:o,z:s}=this.model.rotation,a={x:n,y:o,z:s};a[e]+=t?i:-i;const l=new Ps.Tween({x:n,y:o,z:s});l.to(a,500),l.onUpdate((t=>{this.model.rotation[e]=t[e]})),l.start()}onResultModelRotateOnAxis(){this.model.rotation.x=0,this.model.rotation.y=0,this.model.rotation.z=0}onSetModelPosition(e){const{positionX:t,positionY:i,positionZ:n}=e,o=new Ps.Tween(this.model.position),s={x:t,y:i,z:n};o.to(s,500),o.onUpdate((e=>{this.model.position.set(e.x||0,e.y||0,e.z||0)})),o.start()}onResultModelPosition(e){const{positionX:t,positionY:i,positionZ:n}=e;this.model.position.set(t,i,n)}onResetModelCamera(){this.camera.position.set(0,2,6),this.camera.lookAt(0,0,0)}onGetModelCamera(){return this.camera.position}onSetModelGridHelper(e){const{x:t,y:i,z:n,gridHelper:o,color:s}=e;this.gridHelper.visible=o,this.gridHelper.material.color.set(s);const a=new Ps.Tween(this.gridHelper.position),l={x:t,y:i,z:n};a.to(l,500),a.onUpdate((e=>{this.gridHelper.position.set(e.x||0,e.y||0,e.z||0)})),a.start()}onSetModelGridHelperSize(e){const{x:t,y:i,z:n,size:o,divisions:s,color:a,gridHelper:l}=e;this.scene.remove(this.gridHelper),this.gridHelper.geometry.dispose(),this.gridHelper.material.dispose(),this.gridHelper=new se.GridHelper(o,s,a,a),this.gridHelper.position.set(t,i,n),this.gridHelper.material.linewidth=.1,this.gridHelper.material.color.set(a),this.gridHelper.visible=l,this.scene.add(this.gridHelper)}onSetModelAxesHelper(e){const{axesHelper:t,axesSize:i}=e;this.scene.remove(this.axesHelper),this.axesHelper.geometry.dispose(),this.axesHelper.material.dispose(),this.axesHelper=new se.AxesHelper(i),this.axesHelper.position.set(0,-.5,0),this.axesHelper.visible=t,this.scene.add(this.axesHelper)}onDeleteGeometryMesh(e){const t=this.scene.getObjectByProperty("uuid",e);this.modelMaterialList=this.modelMaterialList.filter((t=>t.uuid!=e)),this.glowMaterialList=this.modelMaterialList.map((e=>e.name)),t.clear(),this.geometryGroup.remove(t),this.dragControls.dispose(),0==this.modelMaterialList.length?this.setModelMeshDrag({modelDrag:!1}):this.setModelMeshDrag({modelDrag:!0})}onSetGeometryMesh(e,t){const i=Fs.Z.state.selectMesh.uuid,n=this.scene.getObjectByProperty("uuid",i),o=Object.keys(e).map((t=>e[t])),s=new se[t](...o);n.geometry=s}}var Ds=Hs,zs=i(2638);const Ns=e=>((0,n.dD)("data-v-17ffefe8"),e=e(),(0,n.Cn)(),e),Os={key:0,id:"loading-mark"},js={class:"loading-box"},Gs={class:"loading"},Bs=["src"],Zs={class:"progress-txt"},Ys=Ns((()=>(0,n._)("div",{class:"loading-txt"},"模型文件首次加载时间较长请耐心等待.....",-1)));var qs=(0,n.aZ)({__name:"PageLoading",props:{percentage:{type:Number,default:0},loading:{type:Boolean,default:!1}},setup(e){const t=e;return(e,o)=>t.loading?((0,n.wg)(),(0,n.iD)("div",Os,[(0,n._)("div",js,[(0,n._)("div",Gs,[(0,n._)("img",{src:i(7622)},null,8,Bs),(0,n._)("div",Zs,[(0,n.Uk)(" 当前模型已加载 "),(0,n._)("b",null,(0,a.zw)(t.percentage),1),(0,n.Uk)(" M ")]),Ys])])])):(0,n.kq)("",!0)}});const Xs=(0,ie.Z)(qs,[["__scopeId","data-v-17ffefe8"]]);var Ks=Xs;const $s=e=>((0,n.dD)("data-v-5f5a5628"),e=e(),(0,n.Cn)(),e),Js={class:"model-page"},Qs={class:"model-header"},ea=$s((()=>(0,n._)("div",{class:"header-lf"},[(0,n._)("span",null," 基于Three.js+Vue3+Element-Plus开发的3d模型可视化编辑系统 "),(0,n._)("span",null,"作者:answer")],-1))),ta={class:"header-lr"},ia={class:"model-container"},na={class:"camera-icon"},oa=$s((()=>(0,n._)("div",{id:"mesh-txt"},null,-1))),sa={class:"edit-panel",style:{minWidth:"380px"}};var aa=(0,n.aZ)({__name:"index",setup(e){const t=(0,r.oR)(),i=(0,ro.tv)(),{$bus:a,$local:d}=(0,n.FN)().proxy,c=(0,o.qj)({modelApi:(0,n.Fl)((()=>t.state.modelApi))}),u=(0,o.iH)(!1),p=(0,o.iH)(0),h=(0,o.iH)(null),m=(0,o.iH)(null),g=()=>{c.modelApi.onResetModelCamera()},f=()=>{const e=d.get(H.Aw);if(!Array.isArray(e)){let e=[];l.H1.forEach((t=>{e.push({...H.f1,fileInfo:{...t}})})),d.set(H.Aw,e)}},_=e=>{const t=c.modelApi.dragGeometryModel;t.id&&(t.clientX=e.clientX,t.clientY=e.clientY,c.modelApi.onSwitchModel(t))},y=()=>{const e=h.value.getPanelConfig();if(e.camera=c.modelApi.onGetModelCamera(),e.fileInfo=m.value.activeModel,e.fileInfo.filePath){d.set(H.AQ,e);const{href:t}=i.resolve({path:zs.N.MODEL_PREIVEW});window.open(t,"_blank")}else ae.z8.warning("当前模型暂不支持“效果预览”")},w=()=>{co.T.confirm(" 确认要更新当前模型数据至“模板库”?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"success"}).then((()=>{const e=h.value.getPanelConfig();if(e.camera=c.modelApi.onGetModelCamera(),e.fileInfo=m.value.activeModel,e.fileInfo.filePath){const t=d.get(H.Aw)||[],{id:i}=e.fileInfo;Object.assign(t.filter((e=>i===e.fileInfo.id))[0],e),d.set(H.Aw,t),ae.z8.success("更新成功")}else ae.z8.warning("当前模型暂不支持“数据保存”")})).catch((()=>{}))},v=()=>{c.modelApi.onDownloadScenCover()},b=e=>{c.modelApi.onExporterModel(e)};return(0,n.bv)((async()=>{u.value=!0;const e=new Ds("#model");t.commit("SET_MODEL_API",e),a.on("page-loading",(e=>{u.value=e})),c.modelApi.onProgress((e=>{p.value=Number((e/1024/1024).toFixed(2))}));const i=await e.init();i&&(u.value=!1,p.value=0),f()})),(0,n.Jd)((()=>{c.modelApi.onClearModelData()})),(e,t)=>{const i=(0,n.up)("el-button"),a=(0,n.up)("arrow-down"),l=(0,n.up)("el-icon"),r=(0,n.up)("el-dropdown-item"),d=(0,n.up)("el-dropdown-menu"),f=(0,n.up)("el-dropdown"),x=(0,n.up)("el-space"),M=(0,n.up)("Aim"),C=(0,n.up)("el-tooltip");return(0,n.wg)(),(0,n.iD)("div",Js,[(0,n._)("header",Qs,[ea,(0,n._)("div",ta,[(0,n.Wm)(x,null,{default:(0,n.w5)((()=>[(0,n.Wm)(i,{type:"primary",icon:"Film",onClick:t[0]||(t[0]=t=>e.$router.push({path:(0,o.SU)(zs.N).MODEL_BASE}))},{default:(0,n.w5)((()=>[(0,n.Uk)(" 模型库 ")])),_:1}),(0,n.Wm)(i,{type:"primary",icon:"Document",onClick:w},{default:(0,n.w5)((()=>[(0,n.Uk)("保存数据")])),_:1}),(0,n.Wm)(f,{trigger:"click"},{dropdown:(0,n.w5)((()=>[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(r,{onClick:v},{default:(0,n.w5)((()=>[(0,n.Uk)("下载封面")])),_:1}),(0,n.Wm)(r,{onClick:t[1]||(t[1]=e=>b("glb"))},{default:(0,n.w5)((()=>[(0,n.Uk)("导出模型(.glb)格式")])),_:1}),(0,n.Wm)(r,{onClick:t[2]||(t[2]=e=>b("gltf"))},{default:(0,n.w5)((()=>[(0,n.Uk)("导出模型(.gltf)格式")])),_:1})])),_:1})])),default:(0,n.w5)((()=>[(0,n.Wm)(i,{type:"primary",icon:"Download"},{default:(0,n.w5)((()=>[(0,n.Uk)(" 下载/导出"),(0,n.Wm)(l,{class:"el-icon--right"},{default:(0,n.w5)((()=>[(0,n.Wm)(a)])),_:1})])),_:1})])),_:1}),(0,n.Wm)(i,{type:"primary",icon:"View",onClick:y},{default:(0,n.w5)((()=>[(0,n.Uk)("效果预览")])),_:1})])),_:1})])]),(0,n._)("div",ia,[(0,n.Wm)((0,o.SU)(F),{ref_key:"choosePanel",ref:m},null,512),(0,n._)("div",{id:"model",onDrop:_,ref:"model",onDragover:t[3]||(t[3]=(0,s.iM)((()=>{}),["prevent"]))},[(0,n._)("div",na,[(0,n.Wm)(C,{effect:"dark",content:"居中",placement:"top"},{default:(0,n.w5)((()=>[(0,n.Wm)(l,{size:18,color:"#fff",onClick:g},{default:(0,n.w5)((()=>[(0,n.Wm)(M)])),_:1})])),_:1})]),oa],544),(0,n._)("div",sa,[c.modelApi.model?((0,n.wg)(),(0,n.j4)((0,o.SU)(lo),{key:0,ref_key:"editPanel",ref:h},null,512)):(0,n.kq)("",!0)])]),(0,n.Wm)(Ks,{loading:u.value,percentage:p.value},null,8,["loading","percentage"])])}}});const la=(0,ie.Z)(aa,[["__scopeId","data-v-5f5a5628"]]);var ra=la},926:function(e,t,i){var n=i(3043),o=i(9985),s=i(6648),a=i(4201),l=a("toStringTag"),r=Object,d="Arguments"===s(function(){return arguments}()),c=function(e,t){try{return e[t]}catch(i){}};e.exports=n?s:function(e){var t,i,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=c(t=r(e),l))?i:d?s(t):"Object"===(n=s(t))&&o(t.callee)?"Arguments":n}},2148:function(e,t,i){var n=i(8702),o=i(2560);e.exports=function(e,t,i){return i.get&&n(i.get,t,{getter:!0}),i.set&&n(i.set,t,{setter:!0}),o.f(e,t,i)}},3043:function(e,t,i){var n=i(4201),o=n("toStringTag"),s={};s[o]="z",e.exports="[object z]"===String(s)},4327:function(e,t,i){var n=i(926),o=String;e.exports=function(e){if("Symbol"===n(e))throw new TypeError("Cannot convert a Symbol value to a string");return o(e)}},1500:function(e){var t=TypeError;e.exports=function(e,i){if(e<i)throw new t("Not enough arguments");return e}},8858:function(e,t,i){var n=i(1880),o=i(8844),s=i(4327),a=i(1500),l=URLSearchParams,r=l.prototype,d=o(r.append),c=o(r["delete"]),u=o(r.forEach),p=o([].push),h=new l("a=1&a=2&b=3");h["delete"]("a",1),h["delete"]("b",void 0),h+""!=="a=2"&&n(r,"delete",(function(e){var t=arguments.length,i=t<2?void 0:arguments[1];if(t&&void 0===i)return c(this,e);var n=[];u(this,(function(e,t){p(n,{key:t,value:e})})),a(t,1);var o,l=s(e),r=s(i),h=0,m=0,g=!1,f=n.length;while(h<f)o=n[h++],g||o.key===l?(g=!0,c(this,o.key)):m++;while(m<f)o=n[m++],o.key===l&&o.value===r||d(this,o.key,o.value)}),{enumerable:!0,unsafe:!0})},1318:function(e,t,i){var n=i(1880),o=i(8844),s=i(4327),a=i(1500),l=URLSearchParams,r=l.prototype,d=o(r.getAll),c=o(r.has),u=new l("a=1");!u.has("a",2)&&u.has("a",void 0)||n(r,"has",(function(e){var t=arguments.length,i=t<2?void 0:arguments[1];if(t&&void 0===i)return c(this,e);var n=d(this,e);a(t,1);var o=s(i),l=0;while(l<n.length)if(n[l++]===o)return!0;return!1}),{enumerable:!0,unsafe:!0})},3228:function(e,t,i){var n=i(7697),o=i(8844),s=i(2148),a=URLSearchParams.prototype,l=o(a.forEach);n&&!("size"in a)&&s(a,"size",{get:function(){var e=0;return l(this,(function(){e++})),e},configurable:!0,enumerable:!0})}}]);
//# sourceMappingURL=10.dcd3e8a3.js.map